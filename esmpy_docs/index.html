
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>ESMPy 8.1.0 beta snapshot documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="#">ESMPy 8.1.0 beta snapshot documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="table-of-contents">
<h1>Table of Contents<a class="headerlink" href="#table-of-contents" title="Permalink to this headline">¶</a></h1>
<p>Welcome to ESMPy - The ESMF Python Interface!</p>
<div class="toctree-wrapper compound">
<span id="document-intro"></span><div class="section" id="module-ESMF">
<span id="overview"></span><h2>Overview<a class="headerlink" href="#module-ESMF" title="Permalink to this headline">¶</a></h2>
<p>ESMPy is a Python interface to the Earth System Modeling Framework (ESMF) 
regridding utility. ESMF is software for
building and coupling weather, climate, and related models. ESMF has a robust,
parallel and scalable remapping package, used to generate remapping weights.
It can handle a wide variety of grids and options: logically rectangular grids,
unstructured meshes and sets of unconnected points; regional or global grids;
2D or 3D; and pole and masking options. ESMF also has capabilities to read grid
information from NetCDF files in a variety of formats, including the
<a class="reference external" href="http://cfconventions.org/cf-conventions/v1.6.0/cf-conventions.html">Climate and Forecast (CF) V1.6 (a.k.a GridSpec)</a>,
<a class="reference external" href="https://github.com/ugrid-conventions/ugrid-conventions">UGRID</a>,
<a class="reference external" href="http://www.earthsystemmodeling.org/esmf_releases/public/ESMF_8_0_1/ESMF_refdoc/node3.html#SECTION03028200000000000000">ESMF Unstructured</a>
and
<a class="reference external" href="http://www.earthsystemmodeling.org/esmf_releases/public/ESMF_8_0_1/ESMF_refdoc/node3.html#SECTION03028100000000000000">SCRIP</a>
conventions.</p>
<p>ESMPy provides a <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> to represent single-tile logically
rectangular coordinate data, a <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> for unstructured 
coordinates, and a <a class="reference internal" href="index.html#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStream</span></code></a> for collections of
unconnected points like observational data streams.
ESMPy supports bilinear, nearest neighbor, higher order patch recovery, 
first-order conservative and second-order conservative regridding. There is 
also an option to ignore unmapped destination points, mask out points on either
the source or destination, choose straight line or great circle paths when using
spherical coordinates and extrapolate data to points outside of the destination
domain. Regridding on the sphere takes place in 3D Cartesian space, so the pole
problem is not an issue as it commonly is with many Earth system grid remapping
softwares. <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> and <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> 
objects can be created in 2D or 3D space, and 3D conservative regridding is 
fully supported.</p>
<p>Regridding, also called remapping or interpolation, is the process of changing
the grid underneath field data values while preserving the qualities of the
original data. Different kinds of transformations are appropriate for
different problems. Regridding may be needed when communicating data between
Earth system modeling components such as land and atmosphere, or between
different data sets to support analysis or visualization.</p>
<p>Regridding can be broken into two stages. The first stage is generation of an
interpolation weight matrix that describes how points in the source grid
contribute to points in the destination grid. The second stage is the
multiplication of values on the source grid by the interpolation weight matrix
to produce the appropriate values on the destination grid. ESMPy provides
access to both stages through two separate interfaces.</p>
<p>There are many different interpolation methods, suitable for different problems.
In ESMPy, the basic bilinear option is a two dimensional variant of linear 
interpolation. The higher order patch recovery is a second degree polynomial 
regridding method, which uses a least squares algorithm to calculate the 
polynomial. This method gives better derivatives in the resulting destination 
field than the bilinear. There are two nearest-neighbor methods which map the 
points from one grid to the nearest corresponding point on the other grid, from
either source to destination or vice versa. These are useful for extrapolation 
or categorical fields.</p>
<p>The first-order conservative regridding is a method designed to preserve the 
integral of the field across the interpolation from source to destination.  It 
uses the proportion of the area of the overlapping source and destination cells
to determine appropriate weights. The second-order conservative method also 
preserves the integral, but uses the source gradient to give a smoother result 
than the first-order conservative. All of these methods can be broken down to a
simple sparse matrix multiplication operation between interpolation weights and
data values.</p>
</div>
<div class="section" id="important-links">
<h2>Important Links<a class="headerlink" href="#important-links" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="http://www.earthsystemcog.org/projects/esmpy/">ESMPy home page</a> has all of the
latest information on the ESMPy project including release notes, known
bugs, supported platforms, and download information.</p>
<p>Please see the <a class="reference external" href="http://www.earthsystemmodeling.org">ESMF home page</a>
for more information on ESMF in general.</p>
<p><a class="reference external" href="http://earthsystemcog.org/site_media/projects/esmf/pres_1105_goessp_oehmke.ppt">Fast Parallel Grid Remapping for Unstructured and Structured Grids</a>
gives a nice overview of the ESMF remapping functionality.</p>
<p>The <a class="reference external" href="https://www.earthsystemcog.org/projects/esmf/regridding_8_0_0">ESMF Regridding Status</a>
page gives a good overview of the functionality that is available through
various interfaces to ESMF regridding.</p>
<p>The <a class="reference external" href="http://www.earthsystemmodeling.org/esmf_releases/public/ESMF_8_0_1/ESMF_refdoc/node3.html#SECTION03020000000000000000">ESMF_RegridWeightGen application</a>
is a command-line version of the functionality that is available through ESMPy.</p>
<p>Please contact <a class="reference external" href="mailto:esmf_support&#37;&#52;&#48;ucar&#46;edu">esmf_support<span>&#64;</span>ucar<span>&#46;</span>edu</a> with any questions or problems.</p>
</div>
<span id="document-install"></span><div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="requirements">
<h3>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h3>
<p>The following packages are <em>required</em> to work with ESMPy:</p>
<ul class="simple">
<li><p><a class="reference external" href="http://www.earthsystemmodeling.org/esmf_releases/public/ESMF_8_0_1/ESMF_usrdoc/node9.html">ESMF installation</a></p></li>
<li><p><a class="reference external" href="http://python.org/">python</a></p></li>
<li><p><a class="reference external" href="http://www.numpy.org/">numpy</a></p></li>
</ul>
<p>The following packages are <em>optional</em>:</p>
<ul class="simple">
<li><dl class="simple">
<dt>ESMF installation with NetCDF - required to create <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></a> and <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Meshes</span></code></a> from file</dt><dd><ul>
<li><p>NetCDF must be built as a shared library for ESMPy installation to succeed</p></li>
</ul>
</dd>
</dl>
</li>
<li><p><a class="reference external" href="http://mpi4py.scipy.org/">mpi4py</a>- python bindings to MPI, needed to run some of the parallel regridding examples</p></li>
<li><p><a class="reference external" href="https://nose.readthedocs.org/en/latest/">nose</a> - for nose testing</p></li>
</ul>
</div>
<div class="section" id="getting-the-code">
<h3>Getting the code<a class="headerlink" href="#getting-the-code" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference external" href="http://www.earthsystemmodeling.org/esmf_releases/public/ESMF_8_0_1/ESMF_usrdoc/">ESMF User’s Guide</a>
contains information on building and installing ESMF.
The <a class="reference external" href="http://www.earthsystemmodeling.org/esmf_releases/public/ESMF_8_0_1/ESMF_refdoc/">ESMF Reference Manual</a>
contains information on the architecture of ESMF, example code, and details of the API (Application Programming
Interface).</p>
<p>Instructions on how to download the ESMPy code can be found at the <a class="reference external" href="http://www.earthsystemcog.org/projects/esmpy/releases">ESMPy Download page</a>.</p>
<div class="section" id="anaconda-packages">
<h4>Anaconda Packages<a class="headerlink" href="#anaconda-packages" title="Permalink to this headline">¶</a></h4>
<p>ESMPy conda packages are available through the conda-forge channel:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">create</span> <span class="o">-</span><span class="n">n</span> <span class="n">esmpy</span> <span class="o">-</span><span class="n">c</span> <span class="n">conda</span><span class="o">-</span><span class="n">forge</span> <span class="n">esmpy</span>
</pre></div>
</div>
<p>Specific versions of the conda package can be installed like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">create</span> <span class="o">-</span><span class="n">n</span> <span class="n">esmpy</span> <span class="o">-</span><span class="n">c</span> <span class="n">conda</span><span class="o">-</span><span class="n">forge</span> <span class="n">esmpy</span><span class="o">=</span><span class="mf">8.0</span><span class="o">.</span><span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="installing-esmpy-from-source">
<h3>Installing ESMPy from Source<a class="headerlink" href="#installing-esmpy-from-source" title="Permalink to this headline">¶</a></h3>
<p>When installing from source, ESMPy requires a pointer to a file named esmf.mk
that is generated during an ESMF installation.  The path of this file is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">ESMF_INSTALL_DIR</span><span class="o">&gt;/</span><span class="n">lib</span><span class="o">/</span><span class="n">lib</span><span class="o">&lt;</span><span class="n">g</span><span class="o">&lt;</span><span class="ow">or</span><span class="o">&gt;</span><span class="n">O</span><span class="o">&gt;/&lt;</span><span class="n">platform</span><span class="o">&gt;/</span><span class="n">esmf</span><span class="o">.</span><span class="n">mk</span>
</pre></div>
</div>
<p>If the <code class="docutils literal notranslate"><span class="pre">ESMFMKFILE</span></code> flag is set when building ESMPy then it will not need to be
referenced again.  If not, an environment variable of the same name must be set
with the path to the esmf.mk file every time a new shell is initiated.</p>
<p>ESMPy can be installed in a custom location using the
<code class="docutils literal notranslate"><span class="pre">--prefix</span></code>, <code class="docutils literal notranslate"><span class="pre">--home</span></code>, or <code class="docutils literal notranslate"><span class="pre">--install-base</span></code> flags to the install command.  If this
is done, then this location needs to be added to the <code class="docutils literal notranslate"><span class="pre">PYTHONPATH</span></code> environment
variable every time a new shell is initiated.  If a
custom install location is not specified, ESMPy will be installed in the
standard Python package installation directory on that particular machine.</p>
<p>An installation of ESMPy in the default location for Python packages can be done
with the following command issued from the top level ESMPy directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">build</span> <span class="o">--</span><span class="n">ESMFMKFILE</span><span class="o">=&lt;</span><span class="n">DIR_TO_esmf</span><span class="o">.</span><span class="n">mk</span><span class="o">&gt;/</span><span class="n">esmf</span><span class="o">.</span><span class="n">mk</span> <span class="n">install</span>
</pre></div>
</div>
<ul class="simple">
<li><p>custom install location:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">build</span> <span class="o">--</span><span class="n">ESMFMKFILE</span><span class="o">=&lt;</span><span class="n">DIR_TO_esmf</span><span class="o">.</span><span class="n">mk</span><span class="o">&gt;/</span><span class="n">esmf</span><span class="o">.</span><span class="n">mk</span>

<span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">install</span> <span class="o">--</span><span class="n">prefix</span><span class="o">=&lt;</span><span class="n">custom_install_location</span><span class="o">&gt;</span>

<span class="n">setenv</span> <span class="n">PYTHONPATH</span> <span class="o">&lt;</span><span class="n">custom_install_location</span><span class="o">&gt;/</span><span class="n">lib</span><span class="o">/</span>\<span class="o">*/</span><span class="n">site_packages</span>
</pre></div>
</div>
<p>Please contact <a class="reference external" href="mailto:esmf_support&#37;&#52;&#48;ucar&#46;edu">esmf_support<span>&#64;</span>ucar<span>&#46;</span>edu</a> with any questions.</p>
</div>
<div class="section" id="importing-esmpy">
<h3>Importing ESMPy<a class="headerlink" href="#importing-esmpy" title="Permalink to this headline">¶</a></h3>
<p>To use ESMPy in an external program, import it with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ESMF</span>
</pre></div>
</div>
</div>
<div class="section" id="validation">
<h3>Validation<a class="headerlink" href="#validation" title="Permalink to this headline">¶</a></h3>
<p>The ESMPy testing is done with the nose package, both in serial and
parallel.  The nose commands are wrapped in the following ESMPy targets:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">test</span>

<span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">test_examples</span>

<span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">test_regrid_from_file</span>

<span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">test_parallel</span>

<span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">test_examples_parallel</span>

<span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">test_regrid_from_file_parallel</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">regrid_from_file</span></code> tests can take up a lot of memory and bandwidth.
The <code class="docutils literal notranslate"><span class="pre">test_regrid_from_file_dryrun</span></code> command will simply download the test
files without actually running them (allowing the stress on the machine to
be applied to bandwidth first, and then memory).</p>
</div>
<p>Alternatively, individual tests can be run with nose using the following format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nosetests</span> <span class="o">&lt;</span><span class="n">file</span><span class="o">&gt;</span><span class="p">:</span><span class="o">&lt;</span><span class="n">test</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>e.g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nosetests</span> <span class="n">src</span><span class="o">/</span><span class="n">ESMF</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">test_api</span><span class="o">/</span><span class="n">test_regrid</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="n">TestRegrid</span><span class="o">.</span><span class="n">test_field_regrid</span>
</pre></div>
</div>
</div>
<div class="section" id="limitations">
<h3>Limitations<a class="headerlink" href="#limitations" title="Permalink to this headline">¶</a></h3>
<p>ESMPy doesn’t include many aspects of ESMF, including components, field bundles,
time management, etc.  The limitations listed here are relative
to ESMF offline and integrated regridding capabilities.</p>
<ul class="simple">
<li><p>ESMPy cannot use an ESMF installation that is built with external LAPACK
support.</p></li>
<li><p>Coordinates cannot be retrieved from the elements of a
<a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>. This can affect the ability to set
<a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> values on a source <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>
created from file when using conservative regridding.</p></li>
<li><p>Multi-tile <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> support is limited to cubed-sphere
grids created on 6 processors. A cubed-sphere grid can be created on any
number of processors, but only when it is created on 6 processors will the
coordinates be retrievable for the entire object. A
<a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> created from a cubed-sphere
<a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> cannot be written to file in parallel.</p></li>
<li><p>There is no <code class="docutils literal notranslate"><span class="pre">FieldBundle</span></code> class, only single <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Fields</span></code></a>.</p></li>
</ul>
<p>Testing related:</p>
<ul class="simple">
<li><p>Nightly regression testing is limited to a small subset of the ESMF test platforms,
including Darwin and Linux running gfortran with openMPI.</p></li>
</ul>
</div>
</div>
<span id="document-examples"></span><div class="section" id="tutorials">
<h2>Tutorials<a class="headerlink" href="#tutorials" title="Permalink to this headline">¶</a></h2>
<div class="section" id="hello-world">
<h3>Hello World<a class="headerlink" href="#hello-world" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ESMF</span>

<span class="c1"># This call enables debug logging</span>
<span class="c1"># esmpy = ESMF.Manager(debug=True)</span>

<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Hello ESMPy World from PET (processor) </span><span class="si">{0}</span><span class="s2">!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ESMF</span><span class="o">.</span><span class="n">local_pet</span><span class="p">()))</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="regridding-helper-functions">
<h3>Regridding Helper Functions<a class="headerlink" href="#regridding-helper-functions" title="Permalink to this headline">¶</a></h3>
<p>The following code snippets demonstrate how to build all of the pieces
necessary to regrid data between <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Fields</span></code></a> built on
<a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></a>, <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Meshes</span></code></a>
and <a class="reference internal" href="index.html#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStreams</span></code></a>.</p>
<div class="section" id="locstream-create">
<h4>LocStream Create<a class="headerlink" href="#locstream-create" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">create_locstream_spherical_16</span><span class="p">(</span><span class="n">coord_sys</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">CoordSys</span><span class="o">.</span><span class="n">SPH_DEG</span><span class="p">,</span> <span class="n">domask</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    :param coord_sys: the coordinate system of the LocStream</span>
<span class="sd">    :param domask: a boolean to tell whether or not to add a mask</span>
<span class="sd">    :return: LocStream</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">pet_count</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;processor count must be 1 to use this function&quot;</span><span class="p">)</span>

    <span class="n">locstream</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">LocStream</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">coord_sys</span><span class="o">=</span><span class="n">coord_sys</span><span class="p">)</span>

    <span class="n">deg_rad</span> <span class="o">=</span> <span class="n">pi</span>
    <span class="k">if</span> <span class="n">coord_sys</span> <span class="o">==</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">CoordSys</span><span class="o">.</span><span class="n">SPH_DEG</span><span class="p">:</span>
        <span class="n">deg_rad</span> <span class="o">=</span> <span class="mi">180</span>

    <span class="n">locstream</span><span class="p">[</span><span class="s2">&quot;ESMF:Lon&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">]</span>
    <span class="n">locstream</span><span class="p">[</span><span class="s2">&quot;ESMF:Lat&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">deg_rad</span><span class="o">/-</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">deg_rad</span><span class="o">/-</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">deg_rad</span><span class="o">/-</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">deg_rad</span><span class="o">/-</span><span class="mf">2.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="mf">0.25</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="mf">0.25</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="mf">0.25</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="mf">0.25</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="n">deg_rad</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">deg_rad</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">deg_rad</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">deg_rad</span><span class="o">/</span><span class="mf">2.0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">domask</span><span class="p">:</span>
        <span class="n">locstream</span><span class="p">[</span><span class="s2">&quot;ESMF:Mask&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">locstream</span>
</pre></div>
</div>
</div>
<div class="section" id="locstream-create-parallel">
<h4>LocStream Create Parallel<a class="headerlink" href="#locstream-create-parallel" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">create_locstream_spherical_16_parallel</span><span class="p">(</span><span class="n">coord_sys</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">CoordSys</span><span class="o">.</span><span class="n">SPH_DEG</span><span class="p">,</span> <span class="n">domask</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    :param coord_sys: the coordinate system of the LocStream</span>
<span class="sd">    :param domask: a boolean to tell whether or not to add a mask</span>
<span class="sd">    :return: LocStream</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">pet_count</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;processor count must be 4 to use this function&quot;</span><span class="p">)</span>

    <span class="n">deg_rad</span> <span class="o">=</span> <span class="n">pi</span>
    <span class="k">if</span> <span class="n">coord_sys</span> <span class="o">==</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">CoordSys</span><span class="o">.</span><span class="n">SPH_DEG</span><span class="p">:</span>
        <span class="n">deg_rad</span> <span class="o">=</span> <span class="mf">180.0</span>

    <span class="n">locstream</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">local_pet</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">locstream</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">LocStream</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">coord_sys</span><span class="o">=</span><span class="n">coord_sys</span><span class="p">)</span>
        <span class="n">locstream</span><span class="p">[</span><span class="s2">&quot;ESMF:Lon&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">]</span>
        <span class="n">locstream</span><span class="p">[</span><span class="s2">&quot;ESMF:Lat&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">deg_rad</span><span class="o">/-</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">deg_rad</span><span class="o">/-</span><span class="mf">2.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">domask</span><span class="p">:</span>
            <span class="n">locstream</span><span class="p">[</span><span class="s2">&quot;ESMF:Mask&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">local_pet</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">locstream</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">LocStream</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">coord_sys</span><span class="o">=</span><span class="n">coord_sys</span><span class="p">)</span>
        <span class="n">locstream</span><span class="p">[</span><span class="s2">&quot;ESMF:Lon&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.5</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">]</span>
        <span class="n">locstream</span><span class="p">[</span><span class="s2">&quot;ESMF:Lat&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">deg_rad</span><span class="o">/-</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">deg_rad</span><span class="o">/-</span><span class="mf">2.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">domask</span><span class="p">:</span>
            <span class="n">locstream</span><span class="p">[</span><span class="s2">&quot;ESMF:Mask&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">local_pet</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">locstream</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">LocStream</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">coord_sys</span><span class="o">=</span><span class="n">coord_sys</span><span class="p">)</span>
        <span class="n">locstream</span><span class="p">[</span><span class="s2">&quot;ESMF:Lon&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">]</span>
        <span class="n">locstream</span><span class="p">[</span><span class="s2">&quot;ESMF:Lat&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.25</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="mf">0.25</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="n">deg_rad</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">deg_rad</span><span class="o">/</span><span class="mf">2.0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">domask</span><span class="p">:</span>
            <span class="n">locstream</span><span class="p">[</span><span class="s2">&quot;ESMF:Mask&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">local_pet</span><span class="p">()</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">locstream</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">LocStream</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">coord_sys</span><span class="o">=</span><span class="n">coord_sys</span><span class="p">)</span>
        <span class="n">locstream</span><span class="p">[</span><span class="s2">&quot;ESMF:Lon&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.5</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">]</span>
        <span class="n">locstream</span><span class="p">[</span><span class="s2">&quot;ESMF:Lat&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.25</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="mf">0.25</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="n">deg_rad</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">deg_rad</span><span class="o">/</span><span class="mf">2.0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">domask</span><span class="p">:</span>
            <span class="n">locstream</span><span class="p">[</span><span class="s2">&quot;ESMF:Mask&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">locstream</span>
</pre></div>
</div>
</div>
<div class="section" id="create-a-2d-grid">
<h4>Create a 2D Grid<a class="headerlink" href="#create-a-2d-grid" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">grid_create_from_coordinates</span><span class="p">(</span><span class="n">xcoords</span><span class="p">,</span> <span class="n">ycoords</span><span class="p">,</span> <span class="n">xcorners</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ycorners</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">corners</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">domask</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">doarea</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ctk</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">TypeKind</span><span class="o">.</span><span class="n">R8</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a 2 dimensional Grid using the bounds of the x and y coordiantes.</span>
<span class="sd">    :param xcoords: The 1st dimension or &#39;x&#39; coordinates at cell centers, as a Python list or numpy Array</span>
<span class="sd">    :param ycoords: The 2nd dimension or &#39;y&#39; coordinates at cell centers, as a Python list or numpy Array</span>
<span class="sd">    :param xcorners: The 1st dimension or &#39;x&#39; coordinates at cell corners, as a Python list or numpy Array</span>
<span class="sd">    :param ycorners: The 2nd dimension or &#39;y&#39; coordinates at cell corners, as a Python list or numpy Array</span>
<span class="sd">    :param domask: boolean to determine whether to set an arbitrary mask or not</span>
<span class="sd">    :param doarea: boolean to determine whether to set an arbitrary area values or not</span>
<span class="sd">    :param ctk: the coordinate typekind</span>
<span class="sd">    :return: grid</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

    <span class="c1"># create a grid given the number of grid cells in each dimension, the center stagger location is allocated, the</span>
    <span class="c1"># Cartesian coordinate system and type of the coordinates are specified</span>
    <span class="n">max_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">xcoords</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">ycoords</span><span class="p">)])</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Grid</span><span class="p">(</span><span class="n">max_index</span><span class="p">,</span> <span class="n">staggerloc</span><span class="o">=</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">],</span> <span class="n">coord_sys</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">CoordSys</span><span class="o">.</span><span class="n">CART</span><span class="p">,</span> <span class="n">coord_typekind</span><span class="o">=</span><span class="n">ctk</span><span class="p">)</span>

    <span class="c1"># set the grid coordinates using numpy arrays, parallel case is handled using grid bounds</span>
    <span class="n">gridXCenter</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">get_coords</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x_par</span> <span class="o">=</span> <span class="n">xcoords</span><span class="p">[</span><span class="n">grid</span><span class="o">.</span><span class="n">lower_bounds</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">][</span><span class="n">x</span><span class="p">]:</span><span class="n">grid</span><span class="o">.</span><span class="n">upper_bounds</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">][</span><span class="n">x</span><span class="p">]]</span>
    <span class="n">gridXCenter</span><span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_par</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">x_par</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="n">gridYCenter</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">get_coords</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">y_par</span> <span class="o">=</span> <span class="n">ycoords</span><span class="p">[</span><span class="n">grid</span><span class="o">.</span><span class="n">lower_bounds</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">][</span><span class="n">y</span><span class="p">]:</span><span class="n">grid</span><span class="o">.</span><span class="n">upper_bounds</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">][</span><span class="n">y</span><span class="p">]]</span>
    <span class="n">gridYCenter</span><span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_par</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">y_par</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>

    <span class="c1"># create grid corners in a slightly different manner to account for the bounds format common in CF-like files</span>
    <span class="k">if</span> <span class="n">corners</span><span class="p">:</span>
        <span class="n">grid</span><span class="o">.</span><span class="n">add_coords</span><span class="p">([</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CORNER</span><span class="p">])</span>
        <span class="n">lbx</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">lower_bounds</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CORNER</span><span class="p">][</span><span class="n">x</span><span class="p">]</span>
        <span class="n">ubx</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">upper_bounds</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CORNER</span><span class="p">][</span><span class="n">x</span><span class="p">]</span>
        <span class="n">lby</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">lower_bounds</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CORNER</span><span class="p">][</span><span class="n">y</span><span class="p">]</span>
        <span class="n">uby</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">upper_bounds</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CORNER</span><span class="p">][</span><span class="n">y</span><span class="p">]</span>

        <span class="n">gridXCorner</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">get_coords</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">staggerloc</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CORNER</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i0</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ubx</span> <span class="o">-</span> <span class="n">lbx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">gridXCorner</span><span class="p">[</span><span class="n">i0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">xcorners</span><span class="p">[</span><span class="n">i0</span><span class="o">+</span><span class="n">lbx</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">gridXCorner</span><span class="p">[</span><span class="n">i0</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">xcorners</span><span class="p">[</span><span class="n">i0</span><span class="o">+</span><span class="n">lbx</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

        <span class="n">gridYCorner</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">get_coords</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">staggerloc</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CORNER</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">uby</span> <span class="o">-</span> <span class="n">lby</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">gridYCorner</span><span class="p">[:,</span> <span class="n">i1</span><span class="p">]</span> <span class="o">=</span> <span class="n">ycorners</span><span class="p">[</span><span class="n">i1</span><span class="o">+</span><span class="n">lby</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">gridYCorner</span><span class="p">[:,</span> <span class="n">i1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">ycorners</span><span class="p">[</span><span class="n">i1</span><span class="o">+</span><span class="n">lby</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

    <span class="c1"># add an arbitrary mask</span>
    <span class="k">if</span> <span class="n">domask</span><span class="p">:</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="n">ESMF</span><span class="o">.</span><span class="n">GridItem</span><span class="o">.</span><span class="n">MASK</span><span class="p">)</span>
        <span class="n">mask</span><span class="p">[:]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">mask</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="mf">1.75</span> <span class="o">&lt;=</span> <span class="n">gridXCenter</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">2.25</span><span class="p">)</span> <span class="o">&amp;</span>
                      <span class="p">(</span><span class="mf">1.75</span> <span class="o">&lt;=</span> <span class="n">gridYCenter</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">2.25</span><span class="p">))]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># add arbitrary areas values</span>
    <span class="k">if</span> <span class="n">doarea</span><span class="p">:</span>
        <span class="n">area</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="n">ESMF</span><span class="o">.</span><span class="n">GridItem</span><span class="o">.</span><span class="n">AREA</span><span class="p">)</span>
        <span class="n">area</span><span class="p">[:]</span> <span class="o">=</span> <span class="mf">5.0</span>

    <span class="k">return</span> <span class="n">grid</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="create-a-3d-grid">
<h4>Create a 3D Grid<a class="headerlink" href="#create-a-3d-grid" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">grid_create_from_coordinates_3d</span><span class="p">(</span><span class="n">xcoords</span><span class="p">,</span> <span class="n">ycoords</span><span class="p">,</span> <span class="n">zcoords</span><span class="p">,</span> <span class="n">xcorners</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ycorners</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">zcorners</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">corners</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">domask</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">doarea</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a 3 dimensional Grid using the xcoordinates, ycoordinates and zcoordinates.</span>
<span class="sd">    :param xcoords: The 1st dimension or &#39;x&#39; coordinates at cell centers, as a Python list or numpy Array</span>
<span class="sd">    :param ycoords: The 2nd dimension or &#39;y&#39; coordinates at cell centers, as a Python list or numpy Array</span>
<span class="sd">    :param zcoords: The 3rd dimension or &#39;z&#39; coordinates at cell centers, as a Python list or numpy Array</span>
<span class="sd">    :param xcorners: The 1st dimension or &#39;x&#39; coordinates at cell corners, as a Python list or numpy Array</span>
<span class="sd">    :param ycorners: The 2nd dimension or &#39;y&#39; coordinates at cell corners, as a Python list or numpy Array</span>
<span class="sd">    :param zcorners: The 3rd dimension or &#39;z&#39; coordinates at cell corners, as a Python list or numpy Array</span>
<span class="sd">    :param corners: boolean to determine whether or not to add corner coordinates to this grid</span>
<span class="sd">    :param domask: boolean to determine whether to set an arbitrary mask or not</span>
<span class="sd">    :param doarea: boolean to determine whether to set an arbitrary area values or not</span>
<span class="sd">    :return: grid</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>

    <span class="c1"># create a grid given the number of grid cells in each dimension, the center stagger location is allocated and the</span>
    <span class="c1"># Cartesian coordinate system is specified</span>
    <span class="n">max_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">xcoords</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">ycoords</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">zcoords</span><span class="p">)])</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Grid</span><span class="p">(</span><span class="n">max_index</span><span class="p">,</span> <span class="n">staggerloc</span><span class="o">=</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER_VCENTER</span><span class="p">],</span> <span class="n">coord_sys</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">CoordSys</span><span class="o">.</span><span class="n">CART</span><span class="p">)</span>

    <span class="c1"># set the grid coordinates using numpy arrays, parallel case is handled using grid bounds</span>
    <span class="n">gridXCenter</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">get_coords</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x_par</span> <span class="o">=</span> <span class="n">xcoords</span><span class="p">[</span><span class="n">grid</span><span class="o">.</span><span class="n">lower_bounds</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER_VCENTER</span><span class="p">][</span><span class="n">x</span><span class="p">]:</span><span class="n">grid</span><span class="o">.</span><span class="n">upper_bounds</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER_VCENTER</span><span class="p">][</span><span class="n">x</span><span class="p">]]</span>
    <span class="n">gridXCenter</span><span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_par</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x_par</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">gridYCenter</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">get_coords</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">y_par</span> <span class="o">=</span> <span class="n">ycoords</span><span class="p">[</span><span class="n">grid</span><span class="o">.</span><span class="n">lower_bounds</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER_VCENTER</span><span class="p">][</span><span class="n">y</span><span class="p">]:</span><span class="n">grid</span><span class="o">.</span><span class="n">upper_bounds</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER_VCENTER</span><span class="p">][</span><span class="n">y</span><span class="p">]]</span>
    <span class="n">gridYCenter</span><span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_par</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">y_par</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">gridZCenter</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">get_coords</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    <span class="n">z_par</span> <span class="o">=</span> <span class="n">zcoords</span><span class="p">[</span><span class="n">grid</span><span class="o">.</span><span class="n">lower_bounds</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER_VCENTER</span><span class="p">][</span><span class="n">z</span><span class="p">]:</span><span class="n">grid</span><span class="o">.</span><span class="n">upper_bounds</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER_VCENTER</span><span class="p">][</span><span class="n">z</span><span class="p">]]</span>
    <span class="n">gridZCenter</span><span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="n">z_par</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">z_par</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

    <span class="c1"># create grid corners in a slightly different manner to account for the bounds format common in CF-like files</span>
    <span class="k">if</span> <span class="n">corners</span><span class="p">:</span>
        <span class="n">grid</span><span class="o">.</span><span class="n">add_coords</span><span class="p">([</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CORNER_VFACE</span><span class="p">])</span>
        <span class="n">lbx</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">lower_bounds</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CORNER_VFACE</span><span class="p">][</span><span class="n">x</span><span class="p">]</span>
        <span class="n">ubx</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">upper_bounds</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CORNER_VFACE</span><span class="p">][</span><span class="n">x</span><span class="p">]</span>
        <span class="n">lby</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">lower_bounds</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CORNER_VFACE</span><span class="p">][</span><span class="n">y</span><span class="p">]</span>
        <span class="n">uby</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">upper_bounds</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CORNER_VFACE</span><span class="p">][</span><span class="n">y</span><span class="p">]</span>
        <span class="n">lbz</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">lower_bounds</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CORNER_VFACE</span><span class="p">][</span><span class="n">z</span><span class="p">]</span>
        <span class="n">ubz</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">upper_bounds</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CORNER_VFACE</span><span class="p">][</span><span class="n">z</span><span class="p">]</span>

        <span class="n">gridXCorner</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">get_coords</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">staggerloc</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CORNER_VFACE</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i0</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ubx</span> <span class="o">-</span> <span class="n">lbx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">gridXCorner</span><span class="p">[</span><span class="n">i0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">xcorners</span><span class="p">[</span><span class="n">i0</span><span class="o">+</span><span class="n">lbx</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">gridXCorner</span><span class="p">[</span><span class="n">i0</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">xcorners</span><span class="p">[</span><span class="n">i0</span><span class="o">+</span><span class="n">lbx</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

        <span class="n">gridYCorner</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">get_coords</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">staggerloc</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CORNER_VFACE</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">uby</span> <span class="o">-</span> <span class="n">lby</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">gridYCorner</span><span class="p">[:,</span> <span class="n">i1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">ycorners</span><span class="p">[</span><span class="n">i1</span><span class="o">+</span><span class="n">lby</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">gridYCorner</span><span class="p">[:,</span> <span class="n">i1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">ycorners</span><span class="p">[</span><span class="n">i1</span><span class="o">+</span><span class="n">lby</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

        <span class="n">gridZCorner</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">get_coords</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">staggerloc</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CORNER_VFACE</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ubz</span> <span class="o">-</span> <span class="n">lbz</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">gridZCorner</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i2</span><span class="p">]</span> <span class="o">=</span> <span class="n">zcorners</span><span class="p">[</span><span class="n">i2</span><span class="o">+</span><span class="n">lbz</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">gridZCorner</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">zcorners</span><span class="p">[</span><span class="n">i2</span><span class="o">+</span><span class="n">lbz</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

    <span class="c1"># add an arbitrary mask</span>
    <span class="k">if</span> <span class="n">domask</span><span class="p">:</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="n">ESMF</span><span class="o">.</span><span class="n">GridItem</span><span class="o">.</span><span class="n">MASK</span><span class="p">)</span>
        <span class="n">mask</span><span class="p">[:]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">mask</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="mf">1.75</span> <span class="o">&lt;</span> <span class="n">gridXCenter</span><span class="o">.</span><span class="n">data</span> <span class="o">&lt;</span> <span class="mf">2.25</span><span class="p">)</span> <span class="o">&amp;</span>
                      <span class="p">(</span><span class="mf">1.75</span> <span class="o">&lt;</span> <span class="n">gridYCenter</span><span class="o">.</span><span class="n">data</span> <span class="o">&lt;</span> <span class="mf">2.25</span><span class="p">)</span> <span class="o">&amp;</span>
                      <span class="p">(</span><span class="mf">1.75</span> <span class="o">&lt;</span> <span class="n">gridZCenter</span><span class="o">.</span><span class="n">data</span> <span class="o">&lt;</span> <span class="mf">2.25</span><span class="p">))]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># add arbitrary areas values</span>
    <span class="k">if</span> <span class="n">doarea</span><span class="p">:</span>
        <span class="n">area</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="n">ESMF</span><span class="o">.</span><span class="n">GridItem</span><span class="o">.</span><span class="n">AREA</span><span class="p">)</span>
        <span class="n">area</span><span class="p">[:]</span> <span class="o">=</span> <span class="mf">5.0</span>

    <span class="k">return</span> <span class="n">grid</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="create-a-periodic-grid">
<h4>Create a Periodic Grid<a class="headerlink" href="#create-a-periodic-grid" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">grid_create_from_coordinates_periodic</span><span class="p">(</span><span class="n">longitudes</span><span class="p">,</span> <span class="n">latitudes</span><span class="p">,</span> <span class="n">lon_corners</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">lat_corners</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">corners</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">domask</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a 2 dimensional periodic Grid using the &#39;longitudes&#39; and &#39;latitudes&#39;.</span>
<span class="sd">    :param longitudes: longitude coordinate values at cell centers</span>
<span class="sd">    :param latitudes: latitude coordinate values at cell centers</span>
<span class="sd">    :param lon_corners: longitude coordinate values at cell corners</span>
<span class="sd">    :param lat_corners: latitude coordinate values at cell corners</span>
<span class="sd">    :param corners: boolean to determine whether or not to add corner coordinates to this grid</span>
<span class="sd">    :param domask: boolean to determine whether to set an arbitrary mask or not</span>
<span class="sd">    :return: grid</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="p">[</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

    <span class="c1"># create a grid given the number of grid cells in each dimension the center stagger location is allocated</span>
    <span class="n">max_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">longitudes</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">latitudes</span><span class="p">)])</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Grid</span><span class="p">(</span><span class="n">max_index</span><span class="p">,</span> <span class="n">num_peri_dims</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">staggerloc</span><span class="o">=</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">])</span>

    <span class="c1"># set the grid coordinates using numpy arrays, parallel case is handled using grid bounds</span>
    <span class="n">gridXCenter</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">get_coords</span><span class="p">(</span><span class="n">lon</span><span class="p">)</span>
    <span class="n">lon_par</span> <span class="o">=</span> <span class="n">longitudes</span><span class="p">[</span><span class="n">grid</span><span class="o">.</span><span class="n">lower_bounds</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">][</span><span class="n">lon</span><span class="p">]:</span><span class="n">grid</span><span class="o">.</span><span class="n">upper_bounds</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">][</span><span class="n">lon</span><span class="p">]]</span>
    <span class="n">gridXCenter</span><span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="n">lon_par</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">lon_par</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="n">gridYCenter</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">get_coords</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span>
    <span class="n">lat_par</span> <span class="o">=</span> <span class="n">latitudes</span><span class="p">[</span><span class="n">grid</span><span class="o">.</span><span class="n">lower_bounds</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">][</span><span class="n">lat</span><span class="p">]:</span><span class="n">grid</span><span class="o">.</span><span class="n">upper_bounds</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">][</span><span class="n">lat</span><span class="p">]]</span>
    <span class="n">gridYCenter</span><span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="n">lat_par</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">lat_par</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>

    <span class="c1"># create grid corners in a slightly different manner to account for the bounds format common in CF-like files</span>
    <span class="k">if</span> <span class="n">corners</span><span class="p">:</span>
        <span class="n">grid</span><span class="o">.</span><span class="n">add_coords</span><span class="p">([</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CORNER</span><span class="p">])</span>
        <span class="n">lbx</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">lower_bounds</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CORNER</span><span class="p">][</span><span class="n">lon</span><span class="p">]</span>
        <span class="n">ubx</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">upper_bounds</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CORNER</span><span class="p">][</span><span class="n">lon</span><span class="p">]</span>
        <span class="n">lby</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">lower_bounds</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CORNER</span><span class="p">][</span><span class="n">lat</span><span class="p">]</span>
        <span class="n">uby</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">upper_bounds</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CORNER</span><span class="p">][</span><span class="n">lat</span><span class="p">]</span>

        <span class="n">gridXCorner</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">get_coords</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">staggerloc</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CORNER</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i0</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ubx</span> <span class="o">-</span> <span class="n">lbx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">gridXCorner</span><span class="p">[</span><span class="n">i0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">lon_corners</span><span class="p">[</span><span class="n">i0</span><span class="o">+</span><span class="n">lbx</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">gridXCorner</span><span class="p">[</span><span class="n">i0</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">lon_corners</span><span class="p">[</span><span class="n">i0</span><span class="o">+</span><span class="n">lbx</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

        <span class="n">gridYCorner</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">get_coords</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">staggerloc</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CORNER</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">uby</span> <span class="o">-</span> <span class="n">lby</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">gridYCorner</span><span class="p">[:,</span> <span class="n">i1</span><span class="p">]</span> <span class="o">=</span> <span class="n">lat_corners</span><span class="p">[</span><span class="n">i1</span><span class="o">+</span><span class="n">lby</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">gridYCorner</span><span class="p">[:,</span> <span class="n">i1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">lat_corners</span><span class="p">[</span><span class="n">i1</span><span class="o">+</span><span class="n">lby</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

    <span class="c1"># add an arbitrary mask</span>
    <span class="k">if</span> <span class="n">domask</span><span class="p">:</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="n">ESMF</span><span class="o">.</span><span class="n">GridItem</span><span class="o">.</span><span class="n">MASK</span><span class="p">)</span>
        <span class="n">mask</span><span class="p">[:]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">mask</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="mf">1.75</span> <span class="o">&lt;=</span> <span class="n">gridXCenter</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">2.25</span><span class="p">)</span> <span class="o">&amp;</span>
                      <span class="p">(</span><span class="mf">1.75</span> <span class="o">&lt;=</span> <span class="n">gridYCenter</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">2.25</span><span class="p">))]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">return</span> <span class="n">grid</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="create-a-5-element-mesh">
<h4>Create a 5 Element Mesh<a class="headerlink" href="#create-a-5-element-mesh" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mesh_create_5</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    PRECONDITIONS: None</span>
<span class="sd">    POSTCONDITIONS: A 5 element Mesh has been created.    </span>
<span class="sd">    RETURN VALUES: \n Mesh :: mesh \n</span>
<span class="sd">    </span>
<span class="sd">      4.0   31 ------ 32 ------ 33</span>
<span class="sd">            |         |  22  /   |</span>
<span class="sd">            |    21   |     /    |</span>
<span class="sd">            |         |   /  23  |</span>
<span class="sd">      2.0   21 ------ 22 ------ 23</span>
<span class="sd">            |         |          |</span>
<span class="sd">            |    11   |    12    |</span>
<span class="sd">            |         |          |</span>
<span class="sd">      0.0   11 ------ 12 ------ 13</span>
<span class="sd">    </span>
<span class="sd">           0.0       2.0        4.0</span>
<span class="sd">    </span>
<span class="sd">          Node Ids at corners</span>
<span class="sd">          Element Ids in centers</span>
<span class="sd">    </span>
<span class="sd">    Note: This mesh is not parallel, it can only be used in serial</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># Two parametric dimensions, and two spatial dimensions</span>
    <span class="n">mesh</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">parametric_dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">spatial_dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="n">num_node</span> <span class="o">=</span> <span class="mi">9</span>
    <span class="n">num_elem</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">nodeId</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">33</span><span class="p">])</span>
    <span class="n">nodeCoord</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span>  <span class="c1"># node 11</span>
                          <span class="mf">2.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span>  <span class="c1"># node 12</span>
                          <span class="mf">4.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span>  <span class="c1"># node 13</span>
                          <span class="mf">0.0</span><span class="p">,</span><span class="mf">2.0</span><span class="p">,</span>  <span class="c1"># node 21</span>
                          <span class="mf">2.0</span><span class="p">,</span><span class="mf">2.0</span><span class="p">,</span>  <span class="c1"># node 22</span>
                          <span class="mf">4.0</span><span class="p">,</span><span class="mf">2.0</span><span class="p">,</span>  <span class="c1"># node 23</span>
                          <span class="mf">0.0</span><span class="p">,</span><span class="mf">4.0</span><span class="p">,</span>  <span class="c1"># node 31</span>
                          <span class="mf">2.0</span><span class="p">,</span><span class="mf">4.0</span><span class="p">,</span>  <span class="c1"># node 32</span>
                          <span class="mf">4.0</span><span class="p">,</span><span class="mf">4.0</span><span class="p">])</span> <span class="c1"># node 33</span>
    <span class="n">nodeOwner</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_node</span><span class="p">)</span>

    <span class="n">elemId</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">23</span><span class="p">])</span>
    <span class="n">elemType</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ESMF</span><span class="o">.</span><span class="n">MeshElemType</span><span class="o">.</span><span class="n">QUAD</span><span class="p">,</span>
                       <span class="n">ESMF</span><span class="o">.</span><span class="n">MeshElemType</span><span class="o">.</span><span class="n">QUAD</span><span class="p">,</span>
                       <span class="n">ESMF</span><span class="o">.</span><span class="n">MeshElemType</span><span class="o">.</span><span class="n">QUAD</span><span class="p">,</span>
                       <span class="n">ESMF</span><span class="o">.</span><span class="n">MeshElemType</span><span class="o">.</span><span class="n">TRI</span><span class="p">,</span>
                       <span class="n">ESMF</span><span class="o">.</span><span class="n">MeshElemType</span><span class="o">.</span><span class="n">TRI</span><span class="p">])</span>
    <span class="n">elemConn</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="c1"># element 11</span>
                       <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span> <span class="c1"># element 12</span>
                       <span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span> <span class="c1"># element 21</span>
                       <span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span>   <span class="c1"># element 22</span>
                       <span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>  <span class="c1"># element 23</span>
    <span class="n">elemCoord</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span>
                          <span class="mf">3.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span>
                          <span class="mf">1.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span>
                          <span class="mf">2.5</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span>
                          <span class="mf">3.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">])</span>

    <span class="n">mesh</span><span class="o">.</span><span class="n">add_nodes</span><span class="p">(</span><span class="n">num_node</span><span class="p">,</span><span class="n">nodeId</span><span class="p">,</span><span class="n">nodeCoord</span><span class="p">,</span><span class="n">nodeOwner</span><span class="p">)</span>

    <span class="n">mesh</span><span class="o">.</span><span class="n">add_elements</span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="n">elemId</span><span class="p">,</span><span class="n">elemType</span><span class="p">,</span><span class="n">elemConn</span><span class="p">,</span> <span class="n">element_coords</span><span class="o">=</span><span class="n">elemCoord</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">nodeCoord</span><span class="p">,</span> <span class="n">nodeOwner</span><span class="p">,</span> <span class="n">elemType</span><span class="p">,</span> <span class="n">elemConn</span><span class="p">,</span> <span class="n">elemCoord</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="create-a-field">
<h4>Create a Field<a class="headerlink" href="#create-a-field" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">create_field</span><span class="p">(</span><span class="n">gml</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        PRECONDITIONS: An Grid, Mesh or LocStream has been created, and &#39;name&#39; is a string that</span>
<span class="sd">                       will be used to initialize the name of a new Field.\n</span>
<span class="sd">        POSTCONDITIONS: A Field has been created.\n</span>
<span class="sd">        RETURN VALUES: \n Field :: field \n</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">field</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">gml</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">field</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="initialize-an-analytic-field">
<h4>Initialize an Analytic Field<a class="headerlink" href="#initialize-an-analytic-field" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">initialize_field_grid_periodic</span><span class="p">(</span><span class="n">field</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    PRECONDITIONS: A Field has been created as &#39;field&#39; with a &#39;grid&#39;</span>
<span class="sd">                   where coordinates have been set on both </span>
<span class="sd">                   the center and corner stagger locations. \n</span>
<span class="sd">    POSTCONDITIONS: The &#39;field&#39; has been initialized to an analytic </span>
<span class="sd">                    field.\n</span>
<span class="sd">    RETURN VALUES: \n Field :: field \n</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">DEG2RAD</span> <span class="o">=</span> <span class="mf">3.141592653589793</span><span class="o">/</span><span class="mf">180.0</span>

    <span class="c1"># get the coordinate pointers and set the coordinates</span>
    <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">gridXCoord</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">get_coords</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">)</span>
    <span class="n">gridYCoord</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">get_coords</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">)</span>

    <span class="n">field</span><span class="o">.</span><span class="n">data</span><span class="p">[:]</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">DEG2RAD</span><span class="o">*</span><span class="n">gridXCoord</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> \
                          <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">DEG2RAD</span><span class="o">*</span><span class="p">(</span><span class="mf">90.0</span> <span class="o">-</span> <span class="n">gridYCoord</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">field</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="run-esmpy-regridding">
<h4>Run ESMPy Regridding<a class="headerlink" href="#run-esmpy-regridding" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">run_regridding</span><span class="p">(</span><span class="n">srcfield</span><span class="p">,</span> <span class="n">dstfield</span><span class="p">,</span> <span class="n">srcfracfield</span><span class="p">,</span> <span class="n">dstfracfield</span><span class="p">):</span>
        <span class="c1"># This is for documentation. Do not modify.</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        PRECONDITIONS: Two Fields have been created and a regridding</span>
<span class="sd">                       operation is desired from &#39;srcfield&#39; to &#39;dstfield&#39;.</span>
<span class="sd">                       The &#39;srcfracfield&#39; and &#39;dstfractfield&#39; are Fields</span>
<span class="sd">                       created to hold the fractions of the source and</span>
<span class="sd">                       destination fields which contribute to conservative</span>
<span class="sd">                       regridding.\n</span>
<span class="sd">        POSTCONDITIONS: A regridding operation has set the data on</span>
<span class="sd">                        &#39;dstfield&#39;, &#39;srcfracfield&#39;, and &#39;dstfracfield&#39;.\n</span>
<span class="sd">        RETURN VALUES: \n Field :: dstfield \n</span>
<span class="sd">                          Field :: srcfracfield \n</span>
<span class="sd">                          Field :: dstfracfield \n</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># call the regridding functions</span>
        <span class="n">regridSrc2Dst</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Regrid</span><span class="p">(</span><span class="n">srcfield</span><span class="p">,</span> <span class="n">dstfield</span><span class="p">,</span>
                                    <span class="n">regrid_method</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">RegridMethod</span><span class="o">.</span><span class="n">CONSERVE</span><span class="p">,</span>
                                    <span class="n">unmapped_action</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">UnmappedAction</span><span class="o">.</span><span class="n">ERROR</span><span class="p">,</span>
                                    <span class="n">src_frac_field</span><span class="o">=</span><span class="n">srcfracfield</span><span class="p">,</span>
                                    <span class="n">dst_frac_field</span><span class="o">=</span><span class="n">dstfracfield</span><span class="p">)</span>
        <span class="n">dstfield</span> <span class="o">=</span> <span class="n">regridSrc2Dst</span><span class="p">(</span><span class="n">srcfield</span><span class="p">,</span> <span class="n">dstfield</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dstfield</span><span class="p">,</span> <span class="n">srcfracfield</span><span class="p">,</span> <span class="n">dstfracfield</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="compute-field-mass">
<h4>Compute Field Mass<a class="headerlink" href="#compute-field-mass" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_mass_grid</span><span class="p">(</span><span class="n">valuefield</span><span class="p">,</span> <span class="n">dofrac</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fracfield</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">uninitval</span><span class="o">=</span><span class="mf">422397696.</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    PRECONDITIONS: &#39;fracfield&#39; contains the fractions of each cell</span>
<span class="sd">                   which contributed to a regridding operation involving</span>
<span class="sd">                   &#39;valuefield.  &#39;dofrac&#39; is a boolean value that gives </span>
<span class="sd">                   the option to not use the &#39;fracfield&#39;.\n</span>
<span class="sd">    POSTCONDITIONS: The mass of the data field is computed.\n</span>
<span class="sd">    RETURN VALUES: float :: mass \n</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">mass</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">areafield</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">valuefield</span><span class="o">.</span><span class="n">grid</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;areafield&#39;</span><span class="p">)</span>
    <span class="n">areafield</span><span class="o">.</span><span class="n">get_area</span><span class="p">()</span>

    <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">valuefield</span><span class="o">.</span><span class="n">data</span> <span class="o">!=</span> <span class="n">uninitval</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">dofrac</span><span class="p">:</span>
        <span class="n">mass</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">areafield</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">*</span> <span class="n">valuefield</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">*</span> <span class="n">fracfield</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">mass</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">areafield</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">*</span> <span class="n">valuefield</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">mass</span>
</pre></div>
</div>
</div></blockquote>
</div>
</div>
<div class="section" id="regridding">
<h3>Regridding<a class="headerlink" href="#regridding" title="Permalink to this headline">¶</a></h3>
<p>The following stand alone scripts demonstrate how to use regridding between
<a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Fields</span></code></a> built on
<a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></a>, <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Meshes</span></code></a>
and <a class="reference internal" href="index.html#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStreams</span></code></a>. These scripts
can be run in serial or parallel with no modification.</p>
<div class="section" id="grid-mesh-and-field-created-from-file">
<h4>Grid, Mesh and Field Created from File<a class="headerlink" href="#grid-mesh-and-field-created-from-file" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># This example demonstrates how to create ESMPy Grid, Mesh and Field objects </span>
<span class="c1"># from file and use them for regridding.</span>
<span class="c1"># The data files can be retrieved from the ESMF data repository by uncommenting the</span>
<span class="c1"># following block of code:</span>
<span class="c1">#</span>
<span class="c1"># import os</span>
<span class="c1"># DD = os.path.join(os.getcwd(), &quot;examples/data&quot;)</span>
<span class="c1"># if not os.path.isdir(DD):</span>
<span class="c1">#     os.makedirs(DD)</span>
<span class="c1"># from ESMF.util.cache_data import cache_data_file</span>
<span class="c1"># cache_data_file(os.path.join(DD, &quot;so_Omon_GISS-E2.nc&quot;))</span>
<span class="c1"># cache_data_file(os.path.join(DD, &quot;mpas_uniform_10242_dual_counterclockwise.nc&quot;))</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">ESMF</span>

<span class="c1"># This call enables debug logging</span>
<span class="c1"># ESMF.Manager(debug=True)</span>

<span class="c1"># Set up the DATADIR</span>
<span class="n">DATADIR</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s2">&quot;examples/data&quot;</span><span class="p">)</span>

<span class="c1"># Create a  global grid from a GRIDSPEC formatted file</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Grid</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATADIR</span><span class="p">,</span> <span class="s2">&quot;so_Omon_GISS-E2.nc&quot;</span><span class="p">),</span>
                 <span class="n">filetype</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">FileFormat</span><span class="o">.</span><span class="n">GRIDSPEC</span><span class="p">)</span>

<span class="c1"># Create a field on the centers of the grid, with extra dimensions</span>
<span class="n">srcfield</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">staggerloc</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">,</span> <span class="n">ndbounds</span><span class="o">=</span><span class="p">[</span><span class="mi">33</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

<span class="c1"># Read the field data from file</span>
<span class="n">srcfield</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATADIR</span><span class="p">,</span> <span class="s2">&quot;so_Omon_GISS-E2.nc&quot;</span><span class="p">),</span>
           <span class="n">variable</span><span class="o">=</span><span class="s2">&quot;so&quot;</span><span class="p">,</span> <span class="n">timeslice</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Create an ESMF formatted unstructured mesh with clockwise cells removed</span>
<span class="n">mesh</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATADIR</span><span class="p">,</span> <span class="s2">&quot;mpas_uniform_10242_dual_counterclockwise.nc&quot;</span><span class="p">),</span>
                 <span class="n">filetype</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">FileFormat</span><span class="o">.</span><span class="n">ESMFMESH</span><span class="p">)</span>

<span class="c1"># Create a field on the nodes of the mesh</span>
<span class="n">dstfield</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">meshloc</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">MeshLoc</span><span class="o">.</span><span class="n">NODE</span><span class="p">,</span> <span class="n">ndbounds</span><span class="o">=</span><span class="p">[</span><span class="mi">33</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

<span class="n">dstfield</span><span class="o">.</span><span class="n">data</span><span class="p">[:]</span> <span class="o">=</span> <span class="mf">1e20</span>

<span class="c1"># compute the weight matrix for regridding</span>
<span class="n">regrid</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Regrid</span><span class="p">(</span><span class="n">srcfield</span><span class="p">,</span> <span class="n">dstfield</span><span class="p">,</span>
                     <span class="n">regrid_method</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">RegridMethod</span><span class="o">.</span><span class="n">BILINEAR</span><span class="p">,</span>
                     <span class="n">unmapped_action</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">UnmappedAction</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">)</span>

<span class="c1"># calculate the regridding from source to destination field</span>
<span class="n">dstfield</span> <span class="o">=</span> <span class="n">regrid</span><span class="p">(</span><span class="n">srcfield</span><span class="p">,</span> <span class="n">dstfield</span><span class="p">)</span>

<span class="k">if</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">local_pet</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Fields created from file regridded successfully :)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="read-and-write-a-weight-file">
<h4>Read and Write a Weight File<a class="headerlink" href="#read-and-write-a-weight-file" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># This example demonstrates how to regrid between a Grid and a Mesh.</span>
<span class="c1"># The data files can be retrieved from the ESMF data repository by uncommenting the</span>
<span class="c1"># following block of code:</span>
<span class="c1">#</span>
<span class="c1"># import os</span>
<span class="c1"># DD = os.path.join(os.getcwd(), &quot;examples/data&quot;)</span>
<span class="c1"># if not os.path.isdir(DD):</span>
<span class="c1">#     os.makedirs(DD)</span>
<span class="c1"># from ESMF.util.cache_data import cache_data_file</span>
<span class="c1"># cache_data_file(os.path.join(DD, &quot;ll2.5deg_grid.nc&quot;))</span>
<span class="c1"># cache_data_file(os.path.join(DD, &quot;mpas_uniform_10242_dual_counterclockwise.nc&quot;))</span>

<span class="kn">import</span> <span class="nn">ESMF</span>
<span class="kn">import</span> <span class="nn">numpy</span>

<span class="kn">import</span> <span class="nn">ESMF.util.helpers</span> <span class="k">as</span> <span class="nn">helpers</span>
<span class="kn">import</span> <span class="nn">ESMF.api.constants</span> <span class="k">as</span> <span class="nn">constants</span>

<span class="c1"># This call enables debug logging</span>
<span class="n">mg</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Manager</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># ESMPy uses Fortran style dimension ordering (as of November 2017)</span>
<span class="p">[</span><span class="n">lat</span><span class="p">,</span><span class="n">lon</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Create the source grid from memory with periodic dimension specified.</span>
<span class="n">lons</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">350.1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">lats</span>  <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">85</span><span class="p">,</span> <span class="mf">85.1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">srcgrid</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Grid</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">lons</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">lats</span><span class="o">.</span><span class="n">size</span><span class="p">]),</span>
                    <span class="n">coord_sys</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">CoordSys</span><span class="o">.</span><span class="n">SPH_DEG</span><span class="p">,</span>
                    <span class="n">staggerloc</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">,</span>
                    <span class="n">num_peri_dims</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">periodic_dim</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">pole_dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Get and set the source grid coordinates.</span>
<span class="n">srcGridCoordLon</span> <span class="o">=</span> <span class="n">srcgrid</span><span class="o">.</span><span class="n">get_coords</span><span class="p">(</span><span class="n">lon</span><span class="p">)</span>
<span class="n">srcGridCoordLat</span> <span class="o">=</span> <span class="n">srcgrid</span><span class="o">.</span><span class="n">get_coords</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span>

<span class="n">slons_par</span> <span class="o">=</span> <span class="n">lons</span><span class="p">[</span><span class="n">srcgrid</span><span class="o">.</span><span class="n">lower_bounds</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span><span class="n">srcgrid</span><span class="o">.</span><span class="n">upper_bounds</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">slats_par</span> <span class="o">=</span> <span class="n">lats</span><span class="p">[</span><span class="n">srcgrid</span><span class="o">.</span><span class="n">lower_bounds</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span><span class="n">srcgrid</span><span class="o">.</span><span class="n">upper_bounds</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>

<span class="c1"># make sure to use indexing=&#39;ij&#39; as ESMPy backend uses matrix indexing (not Cartesian)</span>
<span class="n">lonm</span><span class="p">,</span> <span class="n">latm</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">slons_par</span><span class="p">,</span> <span class="n">slats_par</span><span class="p">,</span> <span class="n">indexing</span><span class="o">=</span><span class="s1">&#39;ij&#39;</span><span class="p">)</span>

<span class="n">srcGridCoordLon</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">lonm</span>
<span class="n">srcGridCoordLat</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">latm</span>

<span class="c1"># Create the dest grid from memory with periodic dimension specified.</span>
<span class="n">lons</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">357.6</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">lats</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">87.5</span><span class="p">,</span> <span class="mf">87.6</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">dstgrid</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Grid</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">lons</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">lats</span><span class="o">.</span><span class="n">size</span><span class="p">]),</span>
                    <span class="n">coord_sys</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">CoordSys</span><span class="o">.</span><span class="n">SPH_DEG</span><span class="p">,</span>
                    <span class="n">staggerloc</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">,</span>
                    <span class="n">num_peri_dims</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">periodic_dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pole_dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Get and set the source grid coordinates.</span>
<span class="n">dstGridCoordLat</span> <span class="o">=</span> <span class="n">dstgrid</span><span class="o">.</span><span class="n">get_coords</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span>
<span class="n">dstGridCoordLon</span> <span class="o">=</span> <span class="n">dstgrid</span><span class="o">.</span><span class="n">get_coords</span><span class="p">(</span><span class="n">lon</span><span class="p">)</span>

<span class="n">dlons_par</span> <span class="o">=</span> <span class="n">lons</span><span class="p">[</span><span class="n">dstgrid</span><span class="o">.</span><span class="n">lower_bounds</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span><span class="n">dstgrid</span><span class="o">.</span><span class="n">upper_bounds</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">dlats_par</span> <span class="o">=</span> <span class="n">lats</span><span class="p">[</span><span class="n">dstgrid</span><span class="o">.</span><span class="n">lower_bounds</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span><span class="n">dstgrid</span><span class="o">.</span><span class="n">upper_bounds</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>

<span class="c1"># make sure to use indexing=&#39;ij&#39; as ESMPy backend uses matrix indexing (not Cartesian)</span>
<span class="n">lonm</span><span class="p">,</span> <span class="n">latm</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">dlons_par</span><span class="p">,</span> <span class="n">dlats_par</span><span class="p">,</span> <span class="n">indexing</span><span class="o">=</span><span class="s1">&#39;ij&#39;</span><span class="p">)</span>

<span class="n">dstGridCoordLon</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">lonm</span>
<span class="n">dstGridCoordLat</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">latm</span>

<span class="c1"># Create a field on the centers of the source grid with the mask applied.</span>
<span class="n">srcfield</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">srcgrid</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;srcfield&quot;</span><span class="p">,</span> <span class="n">staggerloc</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">)</span>

<span class="c1"># Create a field on the centers of the source grid with the mask applied.</span>
<span class="n">dstfield</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">dstgrid</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;dstfield&quot;</span><span class="p">,</span> <span class="n">staggerloc</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">)</span>
<span class="n">xctfield</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">dstgrid</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;xctfield&quot;</span><span class="p">,</span> <span class="n">staggerloc</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">)</span>

<span class="n">gridLon</span> <span class="o">=</span> <span class="n">srcfield</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">get_coords</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">)</span>
<span class="n">gridLat</span> <span class="o">=</span> <span class="n">srcfield</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">get_coords</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">)</span>

<span class="c1"># wave = lambda x,k:  numpy.sin(x*k*numpy.pi/180.0)</span>
<span class="c1"># srcfield.data[...] = numpy.outer(wave(slons_par,3), wave(slats_par,3)) + 2</span>

<span class="n">srcfield</span><span class="o">.</span><span class="n">data</span><span class="p">[:,:]</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">srcGridCoordLat</span><span class="p">)[</span><span class="o">...</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> \
                           <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">srcGridCoordLon</span><span class="p">)[</span><span class="o">...</span><span class="p">])</span>

<span class="c1"># wave = lambda x,k:  numpy.sin(x*k*numpy.pi/180.0)</span>
<span class="c1"># xctfield.data[...] = numpy.outer(wave(dlons_par,3), wave(dlats_par,3)) + 2</span>

<span class="n">xctfield</span><span class="o">.</span><span class="n">data</span><span class="p">[:,:]</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">dstGridCoordLat</span><span class="p">)[</span><span class="o">...</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> \
                           <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">dstGridCoordLon</span><span class="p">)[</span><span class="o">...</span><span class="p">])</span>

<span class="n">dstfield</span><span class="o">.</span><span class="n">data</span><span class="p">[:]</span> <span class="o">=</span> <span class="mf">1e20</span>

<span class="c1"># write regridding weights to file</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;esmpy_example_weight_file.nc&quot;</span>
<span class="k">if</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">local_pet</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">os</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span>
        <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="n">filename</span><span class="p">)):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="n">filename</span><span class="p">))</span>

<span class="n">mg</span><span class="o">.</span><span class="n">barrier</span><span class="p">()</span>
<span class="n">regrid</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Regrid</span><span class="p">(</span><span class="n">srcfield</span><span class="p">,</span> <span class="n">dstfield</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
                     <span class="n">regrid_method</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">RegridMethod</span><span class="o">.</span><span class="n">BILINEAR</span><span class="p">,</span>
                     <span class="n">unmapped_action</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">UnmappedAction</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">)</span>


<span class="c1"># # create a regrid object from file</span>
<span class="n">regrid</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">RegridFromFile</span><span class="p">(</span><span class="n">srcfield</span><span class="p">,</span> <span class="n">dstfield</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

<span class="c1"># calculate the regridding from source to destination field</span>
<span class="n">dstfield</span> <span class="o">=</span> <span class="n">regrid</span><span class="p">(</span><span class="n">srcfield</span><span class="p">,</span> <span class="n">dstfield</span><span class="p">)</span>

<span class="c1"># compute the mean relative error</span>
<span class="n">num_nodes</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">xctfield</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[:])</span>
<span class="n">relerr</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">meanrelerr</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">if</span> <span class="n">num_nodes</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">relerr</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">dstfield</span><span class="o">.</span><span class="n">data</span> <span class="o">-</span> <span class="n">xctfield</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">/</span>
                       <span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">xctfield</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
    <span class="n">meanrelerr</span> <span class="o">=</span> <span class="n">relerr</span> <span class="o">/</span> <span class="n">num_nodes</span>

<span class="c1"># handle the parallel case</span>
<span class="k">if</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">pet_count</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">relerr</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">reduce_val</span><span class="p">(</span><span class="n">relerr</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="n">constants</span><span class="o">.</span><span class="n">Reduce</span><span class="o">.</span><span class="n">SUM</span><span class="p">)</span>
    <span class="n">num_nodes</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">reduce_val</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="n">constants</span><span class="o">.</span><span class="n">Reduce</span><span class="o">.</span><span class="n">SUM</span><span class="p">)</span>

<span class="c1"># output the results from one processor only</span>
<span class="k">if</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">local_pet</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">meanrelerr</span> <span class="o">=</span> <span class="n">relerr</span> <span class="o">/</span> <span class="n">num_nodes</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;ESMPy Grid Mesh Regridding Example&quot;</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;  interpolation mean relative error = </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">meanrelerr</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="n">filename</span><span class="p">)):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="n">filename</span><span class="p">))</span>

<span class="c1"># set to 1 to output results</span>
<span class="c1"># if ESMF.pet_count() == 0:</span>
<span class="c1">#     import matplotlib.pyplot as plt</span>
<span class="c1">#     fig = plt.figure(1, (15, 6))</span>
<span class="c1">#     fig.suptitle(&#39;ESMPy Periodic Grids&#39;, fontsize=14, fontweight=&#39;bold&#39;)</span>
<span class="c1"># </span>
<span class="c1">#     ax = fig.add_subplot(1, 2, 1)</span>
<span class="c1">#     im = ax.imshow(srcfield.data, vmin=1, vmax=3, cmap=&#39;gist_ncar&#39;, aspect=&#39;auto&#39;,</span>
<span class="c1">#                    extent=[min(slons_par), max(slons_par), min(slats_par), max(slats_par)])</span>
<span class="c1">#     ax.set_xbound(lower=min(slons_par), upper=max(slons_par))</span>
<span class="c1">#     ax.set_ybound(lower=min(slats_par), upper=max(slats_par))</span>
<span class="c1">#     ax.set_xlabel(&quot;Longitude&quot;)</span>
<span class="c1">#     ax.set_ylabel(&quot;Latitude&quot;)</span>
<span class="c1">#     ax.set_title(&quot;Source Data&quot;)</span>
<span class="c1"># </span>
<span class="c1">#     ax = fig.add_subplot(1, 2, 2)</span>
<span class="c1">#     im = ax.imshow(dstfield.data, vmin=1, vmax=3, cmap=&#39;gist_ncar&#39;, aspect=&#39;auto&#39;,</span>
<span class="c1">#                    extent=[min(dlons_par), max(dlons_par), min(dlats_par), max(dlats_par)])</span>
<span class="c1">#     ax.set_xlabel(&quot;Longitude&quot;)</span>
<span class="c1">#     ax.set_ylabel(&quot;Latitude&quot;)</span>
<span class="c1">#     ax.set_title(&quot;Regrid Solution&quot;)</span>
<span class="c1"># </span>
<span class="c1">#     fig.subplots_adjust(right=0.8)</span>
<span class="c1">#     cbar_ax = fig.add_axes([0.9, 0.1, 0.01, 0.8])</span>
<span class="c1">#     fig.colorbar(im, cax=cbar_ax)</span>
<span class="c1"># </span>
<span class="c1">#     plt.show()</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="grid-to-locstream">
<h4>Grid to LocStream<a class="headerlink" href="#grid-to-locstream" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># This example demonstrates how to regrid between a Grid and a LocStream.</span>
<span class="c1"># The data files can be retrieved from the ESMF data repository by uncommenting the</span>
<span class="c1"># following block of code:</span>
<span class="c1">#</span>
<span class="c1"># import os</span>
<span class="c1"># DD = os.path.join(os.getcwd(), &quot;examples/data&quot;)</span>
<span class="c1"># if not os.path.isdir(DD):</span>
<span class="c1">#     os.makedirs(DD)</span>
<span class="c1"># from ESMF.util.cache_data import cache_data_file</span>
<span class="c1"># cache_data_file(os.path.join(DD, &quot;ll1deg_grid.nc&quot;))</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">unittest</span> <span class="kn">import</span> <span class="n">SkipTest</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">nose</span> <span class="kn">import</span> <span class="n">SkipTest</span>

<span class="kn">import</span> <span class="nn">ESMF</span>
<span class="kn">import</span> <span class="nn">numpy</span>

<span class="kn">import</span> <span class="nn">ESMF.util.helpers</span> <span class="k">as</span> <span class="nn">helpers</span>
<span class="kn">import</span> <span class="nn">ESMF.api.constants</span> <span class="k">as</span> <span class="nn">constants</span>

<span class="c1"># This call enables debug logging</span>
<span class="n">ESMF</span><span class="o">.</span><span class="n">Manager</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">ESMF.util.locstream_utilities</span> <span class="kn">import</span> <span class="n">create_locstream_spherical_16</span><span class="p">,</span> <span class="n">create_locstream_spherical_16_parallel</span>
<span class="n">coord_sys</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">CoordSys</span><span class="o">.</span><span class="n">SPH_DEG</span>
<span class="n">domask</span><span class="o">=</span><span class="kc">True</span>
<span class="k">if</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">pet_count</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">locstream</span> <span class="o">=</span> <span class="n">create_locstream_spherical_16</span><span class="p">(</span><span class="n">coord_sys</span><span class="o">=</span><span class="n">coord_sys</span><span class="p">,</span> <span class="n">domask</span><span class="o">=</span><span class="n">domask</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">constants</span><span class="o">.</span><span class="n">_ESMF_MPIRUN_NP</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">SkipTest</span><span class="p">(</span><span class="s1">&#39;processor count must be 4 or 1 for this example&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">locstream</span> <span class="o">=</span> <span class="n">create_locstream_spherical_16_parallel</span><span class="p">(</span><span class="n">coord_sys</span><span class="o">=</span><span class="n">coord_sys</span><span class="p">,</span> <span class="n">domask</span><span class="o">=</span><span class="n">domask</span><span class="p">)</span>

<span class="n">grid1</span> <span class="o">=</span> <span class="s2">&quot;examples/data/ll1deg_grid.nc&quot;</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Grid</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">grid1</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">FileFormat</span><span class="o">.</span><span class="n">SCRIP</span><span class="p">)</span>

<span class="c1"># create a field</span>
<span class="n">srcfield</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;srcfield&#39;</span><span class="p">)</span>

<span class="n">dstfield</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">locstream</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;dstfield&#39;</span><span class="p">)</span>
<span class="n">xctfield</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">locstream</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;xctfield&#39;</span><span class="p">)</span>

<span class="c1"># initialize the fields</span>
<span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">deg2rad</span> <span class="o">=</span> <span class="mf">3.14159</span><span class="o">/</span><span class="mi">180</span>

<span class="n">gridXCoord</span> <span class="o">=</span> <span class="n">srcfield</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">get_coords</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">gridYCoord</span> <span class="o">=</span> <span class="n">srcfield</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">get_coords</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="n">srcfield</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">gridXCoord</span> <span class="o">*</span> <span class="n">deg2rad</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">gridYCoord</span> <span class="o">*</span> <span class="n">deg2rad</span><span class="p">)</span>

<span class="n">gridXCoord</span> <span class="o">=</span> <span class="n">locstream</span><span class="p">[</span><span class="s2">&quot;ESMF:Lon&quot;</span><span class="p">]</span>
<span class="n">gridYCoord</span> <span class="o">=</span> <span class="n">locstream</span><span class="p">[</span><span class="s2">&quot;ESMF:Lat&quot;</span><span class="p">]</span>
<span class="k">if</span> <span class="n">coord_sys</span> <span class="o">==</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">CoordSys</span><span class="o">.</span><span class="n">SPH_DEG</span><span class="p">:</span>
    <span class="n">xctfield</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">gridXCoord</span> <span class="o">*</span> <span class="n">deg2rad</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">gridYCoord</span> <span class="o">*</span> <span class="n">deg2rad</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">coord_sys</span> <span class="o">==</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">CoordSys</span><span class="o">.</span><span class="n">SPH_RAD</span><span class="p">:</span>
    <span class="n">xctfield</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">gridXCoord</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">gridYCoord</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;coordsys value does not work in this example&quot;</span><span class="p">)</span>

<span class="n">dstfield</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1e20</span>

<span class="c1"># create an object to regrid data from the source to the destination field</span>
<span class="n">dst_mask_values</span><span class="o">=</span><span class="kc">None</span>
<span class="k">if</span> <span class="n">domask</span><span class="p">:</span>
    <span class="n">dst_mask_values</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>

<span class="n">regrid</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Regrid</span><span class="p">(</span><span class="n">srcfield</span><span class="p">,</span> <span class="n">dstfield</span><span class="p">,</span>
                     <span class="n">regrid_method</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">RegridMethod</span><span class="o">.</span><span class="n">BILINEAR</span><span class="p">,</span>
                     <span class="n">unmapped_action</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">UnmappedAction</span><span class="o">.</span><span class="n">ERROR</span><span class="p">,</span>
                     <span class="n">dst_mask_values</span><span class="o">=</span><span class="n">dst_mask_values</span><span class="p">)</span>

<span class="c1"># do the regridding from source to destination field</span>
<span class="n">dstfield</span> <span class="o">=</span> <span class="n">regrid</span><span class="p">(</span><span class="n">srcfield</span><span class="p">,</span> <span class="n">dstfield</span><span class="p">,</span> <span class="n">zero_region</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">Region</span><span class="o">.</span><span class="n">SELECT</span><span class="p">)</span>

<span class="c1"># compute the mean relative error</span>
<span class="n">num_nodes</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">xctfield</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[:])</span>
<span class="n">relerr</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">meanrelerr</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">dstfield</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">dstfield</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="n">xctfield</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">xctfield</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

<span class="k">if</span> <span class="n">num_nodes</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">ind</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">dstfield</span> <span class="o">!=</span> <span class="mf">1e20</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">xctfield</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">relerr</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">dstfield</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">-</span> <span class="n">xctfield</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span> <span class="o">/</span> <span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">xctfield</span><span class="p">[</span><span class="n">ind</span><span class="p">]))</span>
    <span class="n">meanrelerr</span> <span class="o">=</span> <span class="n">relerr</span> <span class="o">/</span> <span class="n">num_nodes</span>

<span class="c1"># handle the parallel case</span>
<span class="k">if</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">pet_count</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">relerr</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">reduce_val</span><span class="p">(</span><span class="n">relerr</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="n">constants</span><span class="o">.</span><span class="n">Reduce</span><span class="o">.</span><span class="n">SUM</span><span class="p">)</span>
    <span class="n">num_nodes</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">reduce_val</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="n">constants</span><span class="o">.</span><span class="n">Reduce</span><span class="o">.</span><span class="n">SUM</span><span class="p">)</span>

<span class="c1"># output the results from one processor only</span>
<span class="k">if</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">local_pet</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">meanrelerr</span> <span class="o">=</span> <span class="n">relerr</span> <span class="o">/</span> <span class="n">num_nodes</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;ESMPy Grid LocStream Regridding Example&quot;</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;  interpolation mean relative error = </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">meanrelerr</span><span class="p">))</span>

    <span class="k">assert</span> <span class="p">(</span><span class="n">meanrelerr</span> <span class="o">&lt;</span> <span class="mf">2e-2</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="mesh-to-locstream">
<h4>Mesh to LocStream<a class="headerlink" href="#mesh-to-locstream" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># This example demonstrates how to regrid between a mesh and a locstream.</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">unittest</span> <span class="kn">import</span> <span class="n">SkipTest</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">nose</span> <span class="kn">import</span> <span class="n">SkipTest</span>

<span class="kn">import</span> <span class="nn">ESMF</span>
<span class="kn">import</span> <span class="nn">numpy</span>

<span class="kn">import</span> <span class="nn">ESMF.util.helpers</span> <span class="k">as</span> <span class="nn">helpers</span>
<span class="kn">import</span> <span class="nn">ESMF.api.constants</span> <span class="k">as</span> <span class="nn">constants</span>

<span class="c1"># This call enables debug logging</span>
<span class="c1"># ESMF.Manager(debug=True)</span>

<span class="kn">from</span> <span class="nn">ESMF.util.mesh_utilities</span> <span class="kn">import</span> <span class="n">mesh_create_5</span><span class="p">,</span> <span class="n">mesh_create_5_parallel</span>
<span class="kn">from</span> <span class="nn">ESMF.util.locstream_utilities</span> <span class="kn">import</span> <span class="n">create_locstream_16</span><span class="p">,</span> <span class="n">create_locstream_16_parallel</span>
<span class="k">if</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">pet_count</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">mesh</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">mesh_create_5</span><span class="p">()</span>
    <span class="n">locstream</span> <span class="o">=</span> <span class="n">create_locstream_16</span><span class="p">()</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">constants</span><span class="o">.</span><span class="n">_ESMF_MPIRUN_NP</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">SkipTest</span><span class="p">(</span><span class="s1">&#39;processor count must be 4 or 1 for this example&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">mesh</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">mesh_create_5_parallel</span><span class="p">()</span>
        <span class="n">locstream</span> <span class="o">=</span> <span class="n">create_locstream_16_parallel</span><span class="p">()</span>

<span class="c1"># create a field</span>
<span class="n">srcfield</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;srcfield&#39;</span><span class="p">)</span><span class="c1">#, meshloc=ESMF.MeshLoc.ELEMENT)</span>

<span class="c1"># create a field on the locstream</span>
<span class="n">dstfield</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">locstream</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;dstfield&#39;</span><span class="p">)</span>
<span class="n">xctfield</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">locstream</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;xctfield&#39;</span><span class="p">)</span>

<span class="c1"># initialize the fields</span>
<span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">deg2rad</span> <span class="o">=</span> <span class="mf">3.14159</span><span class="o">/</span><span class="mi">180</span>

<span class="n">gridXCoord</span> <span class="o">=</span> <span class="n">srcfield</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">get_coords</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">gridYCoord</span> <span class="o">=</span> <span class="n">srcfield</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">get_coords</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="n">srcfield</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="o">+</span> <span class="p">(</span><span class="n">gridXCoord</span> <span class="o">*</span> <span class="n">deg2rad</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">gridYCoord</span> <span class="o">*</span> <span class="n">deg2rad</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>

<span class="n">gridXCoord</span> <span class="o">=</span> <span class="n">locstream</span><span class="p">[</span><span class="s2">&quot;ESMF:X&quot;</span><span class="p">]</span>
<span class="n">gridYCoord</span> <span class="o">=</span> <span class="n">locstream</span><span class="p">[</span><span class="s2">&quot;ESMF:Y&quot;</span><span class="p">]</span>
<span class="n">xctfield</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="o">+</span> <span class="p">(</span><span class="n">gridXCoord</span> <span class="o">*</span> <span class="n">deg2rad</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">gridYCoord</span> <span class="o">*</span> <span class="n">deg2rad</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>

<span class="n">dstfield</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1e20</span>

<span class="c1"># create an object to regrid data from the source to the destination field</span>
<span class="c1"># TODO: this example seems to fail occasionally with UnmappedAction.ERROR, probably due to a tolerance issue - ask Bob</span>
<span class="n">regrid</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Regrid</span><span class="p">(</span><span class="n">srcfield</span><span class="o">=</span><span class="n">srcfield</span><span class="p">,</span> <span class="n">dstfield</span><span class="o">=</span><span class="n">dstfield</span><span class="p">,</span> <span class="n">regrid_method</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">RegridMethod</span><span class="o">.</span><span class="n">BILINEAR</span><span class="p">,</span>
                     <span class="n">unmapped_action</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">UnmappedAction</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">)</span>

<span class="c1"># do the regridding from source to destination field</span>
<span class="n">dstfield</span> <span class="o">=</span> <span class="n">regrid</span><span class="p">(</span><span class="n">srcfield</span><span class="p">,</span> <span class="n">dstfield</span><span class="p">)</span>

<span class="c1"># compute the mean relative error</span>
<span class="n">num_nodes</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">xctfield</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[:])</span>
<span class="n">relerr</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">meanrelerr</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">if</span> <span class="n">num_nodes</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">ind</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">dstfield</span><span class="o">.</span><span class="n">data</span> <span class="o">!=</span> <span class="mf">1e20</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">xctfield</span><span class="o">.</span><span class="n">data</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">relerr</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">dstfield</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">-</span> <span class="n">xctfield</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span> <span class="o">/</span> <span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">xctfield</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">ind</span><span class="p">]))</span>
    <span class="n">meanrelerr</span> <span class="o">=</span> <span class="n">relerr</span> <span class="o">/</span> <span class="n">num_nodes</span>

<span class="c1"># handle the parallel case</span>
<span class="k">if</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">pet_count</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">relerr</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">reduce_val</span><span class="p">(</span><span class="n">relerr</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="n">constants</span><span class="o">.</span><span class="n">Reduce</span><span class="o">.</span><span class="n">SUM</span><span class="p">)</span>
    <span class="n">num_nodes</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">reduce_val</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="n">constants</span><span class="o">.</span><span class="n">Reduce</span><span class="o">.</span><span class="n">SUM</span><span class="p">)</span>

<span class="c1"># output the results from one processor only</span>
<span class="k">if</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">local_pet</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">meanrelerr</span> <span class="o">=</span> <span class="n">relerr</span> <span class="o">/</span> <span class="n">num_nodes</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;ESMPy Grid Mesh Regridding Example&quot;</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;  interpolation mean relative error = </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">meanrelerr</span><span class="p">))</span>

    <span class="k">assert</span> <span class="p">(</span><span class="n">meanrelerr</span> <span class="o">&lt;</span> <span class="mf">3e-5</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="locstream-to-grid">
<h4>LocStream to Grid<a class="headerlink" href="#locstream-to-grid" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># This example demonstrates how to regrid between a LocStream and a Grid.</span>
<span class="c1"># The data files can be retrieved from the ESMF data repository by uncommenting the</span>
<span class="c1"># following block of code:</span>
<span class="c1">#</span>
<span class="c1"># import os</span>
<span class="c1"># DD = os.path.join(os.getcwd(), &quot;examples/data&quot;)</span>
<span class="c1"># if not os.path.isdir(DD):</span>
<span class="c1">#     os.makedirs(DD)</span>
<span class="c1"># from ESMF.util.cache_data import cache_data_file</span>
<span class="c1"># cache_data_file(os.path.join(DD, &quot;ll1deg_grid.nc&quot;))</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">unittest</span> <span class="kn">import</span> <span class="n">SkipTest</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">nose</span> <span class="kn">import</span> <span class="n">SkipTest</span>

<span class="kn">import</span> <span class="nn">ESMF</span>
<span class="kn">import</span> <span class="nn">numpy</span>

<span class="kn">import</span> <span class="nn">ESMF.util.helpers</span> <span class="k">as</span> <span class="nn">helpers</span>
<span class="kn">import</span> <span class="nn">ESMF.api.constants</span> <span class="k">as</span> <span class="nn">constants</span>

<span class="c1"># This call enables debug logging</span>
<span class="n">ESMF</span><span class="o">.</span><span class="n">Manager</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">grid1</span> <span class="o">=</span> <span class="s2">&quot;examples/data/ll1deg_grid.nc&quot;</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Grid</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">grid1</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">FileFormat</span><span class="o">.</span><span class="n">SCRIP</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">ESMF.util.locstream_utilities</span> <span class="kn">import</span> <span class="n">create_locstream_spherical_16</span><span class="p">,</span> <span class="n">create_locstream_spherical_16_parallel</span>
<span class="n">coord_sys</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">CoordSys</span><span class="o">.</span><span class="n">SPH_DEG</span>
<span class="n">domask</span><span class="o">=</span><span class="kc">True</span>
<span class="k">if</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">pet_count</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">locstream</span> <span class="o">=</span> <span class="n">create_locstream_spherical_16</span><span class="p">(</span><span class="n">coord_sys</span><span class="o">=</span><span class="n">coord_sys</span><span class="p">,</span> <span class="n">domask</span><span class="o">=</span><span class="n">domask</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">constants</span><span class="o">.</span><span class="n">_ESMF_MPIRUN_NP</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">SkipTest</span><span class="p">(</span><span class="s1">&#39;processor count must be 4 or 1 for this example&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">locstream</span> <span class="o">=</span> <span class="n">create_locstream_spherical_16_parallel</span><span class="p">(</span><span class="n">coord_sys</span><span class="o">=</span><span class="n">coord_sys</span><span class="p">,</span> <span class="n">domask</span><span class="o">=</span><span class="n">domask</span><span class="p">)</span>

<span class="c1"># create a field</span>
<span class="n">srcfield</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">locstream</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;srcfield&#39;</span><span class="p">)</span>

<span class="n">dstfield</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;dstfield&#39;</span><span class="p">)</span>
<span class="n">xctfield</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;xctfield&#39;</span><span class="p">)</span>

<span class="c1"># initialize the fields</span>
<span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">deg2rad</span> <span class="o">=</span> <span class="mf">3.14159</span><span class="o">/</span><span class="mi">180</span>

<span class="n">gridXCoord</span> <span class="o">=</span> <span class="n">locstream</span><span class="p">[</span><span class="s2">&quot;ESMF:Lon&quot;</span><span class="p">]</span>
<span class="n">gridYCoord</span> <span class="o">=</span> <span class="n">locstream</span><span class="p">[</span><span class="s2">&quot;ESMF:Lat&quot;</span><span class="p">]</span>
<span class="k">if</span> <span class="n">coord_sys</span> <span class="o">==</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">CoordSys</span><span class="o">.</span><span class="n">SPH_DEG</span><span class="p">:</span>
    <span class="n">srcfield</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">gridXCoord</span> <span class="o">*</span> <span class="n">deg2rad</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">gridYCoord</span> <span class="o">*</span> <span class="n">deg2rad</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">coord_sys</span> <span class="o">==</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">CoordSys</span><span class="o">.</span><span class="n">SPH_RAD</span><span class="p">:</span>
    <span class="n">srcfield</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">gridXCoord</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">gridYCoord</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;coordsys value does not apply in this example&quot;</span><span class="p">)</span>

<span class="n">gridXCoord</span> <span class="o">=</span> <span class="n">xctfield</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">get_coords</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">gridYCoord</span> <span class="o">=</span> <span class="n">xctfield</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">get_coords</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="n">xctfield</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">gridXCoord</span> <span class="o">*</span> <span class="n">deg2rad</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">gridYCoord</span> <span class="o">*</span> <span class="n">deg2rad</span><span class="p">)</span>


<span class="n">dstfield</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1e20</span>

<span class="c1"># create an object to regrid data from the source to the destination field</span>
<span class="n">mask_values</span><span class="o">=</span><span class="kc">None</span>
<span class="k">if</span> <span class="n">domask</span><span class="p">:</span>
    <span class="n">mask_values</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>

<span class="n">regrid</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Regrid</span><span class="p">(</span><span class="n">srcfield</span><span class="p">,</span> <span class="n">dstfield</span><span class="p">,</span>
                     <span class="n">regrid_method</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">RegridMethod</span><span class="o">.</span><span class="n">NEAREST_DTOS</span><span class="p">,</span>
                     <span class="n">unmapped_action</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">UnmappedAction</span><span class="o">.</span><span class="n">ERROR</span><span class="p">,</span>
                     <span class="n">src_mask_values</span><span class="o">=</span><span class="n">mask_values</span><span class="p">)</span>

<span class="c1"># do the regridding from source to destination field</span>
<span class="n">dstfield</span> <span class="o">=</span> <span class="n">regrid</span><span class="p">(</span><span class="n">srcfield</span><span class="p">,</span> <span class="n">dstfield</span><span class="p">,</span> <span class="n">zero_region</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">Region</span><span class="o">.</span><span class="n">SELECT</span><span class="p">)</span>

<span class="c1"># compute the mean relative error</span>
<span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">mul</span>
<span class="n">num_nodes</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">xctfield</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[:])</span>
<span class="n">relerr</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">meanrelerr</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">dstfield</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">dstfield</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="n">xctfield</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">xctfield</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

<span class="k">if</span> <span class="n">num_nodes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">ind</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">dstfield</span> <span class="o">!=</span> <span class="mf">1e20</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">xctfield</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">relerr</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">dstfield</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">-</span> <span class="n">xctfield</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span> <span class="o">/</span> <span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">xctfield</span><span class="p">[</span><span class="n">ind</span><span class="p">]))</span>
    <span class="n">meanrelerr</span> <span class="o">=</span> <span class="n">relerr</span> <span class="o">/</span> <span class="n">num_nodes</span>

<span class="c1"># handle the parallel case</span>
<span class="k">if</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">pet_count</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">relerr</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">reduce_val</span><span class="p">(</span><span class="n">relerr</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="n">constants</span><span class="o">.</span><span class="n">Reduce</span><span class="o">.</span><span class="n">SUM</span><span class="p">)</span>
    <span class="n">num_nodes</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">reduce_val</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="n">constants</span><span class="o">.</span><span class="n">Reduce</span><span class="o">.</span><span class="n">SUM</span><span class="p">)</span>

<span class="c1"># output the results from one processor only</span>
<span class="k">if</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">local_pet</span><span class="p">()</span> <span class="ow">is</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">meanrelerr</span> <span class="o">=</span> <span class="n">relerr</span> <span class="o">/</span> <span class="n">num_nodes</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;ESMPy LocStream Grid Regridding Example&quot;</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;  interpolation mean relative error = </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">meanrelerr</span><span class="p">))</span>

    <span class="k">assert</span> <span class="p">(</span><span class="n">meanrelerr</span> <span class="o">&lt;</span> <span class="mf">9e-5</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="using-mpi-spawn-from-a-serial-python-driver">
<h4>Using MPI.Spawn() from a Serial Python Driver<a class="headerlink" href="#using-mpi-spawn-from-a-serial-python-driver" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># This example demonstrates how to call ESMPy regridding as a parallel</span>
<span class="c1"># subprocess spawned using mpi4py from a serial Python driver.</span>
<span class="c1">#</span>
<span class="c1"># NOTE: MPI.COMM_WORLD.Spawn does not seem to work for mpi4py installations</span>
<span class="c1">#       installations built with mpich, however openmpi does work (July 2016).</span>
<span class="c1">#</span>
<span class="c1"># The data files can be retrieved from the ESMF data repository by uncommenting the</span>
<span class="c1"># following block of code:</span>
<span class="c1">#</span>
<span class="c1"># import os</span>
<span class="c1"># DD = os.path.join(os.getcwd(), &quot;examples/data&quot;)</span>
<span class="c1"># if not os.path.isdir(DD):</span>
<span class="c1">#     os.makedirs(DD)</span>
<span class="c1"># from ESMF.util.cache_data import cache_data_file</span>
<span class="c1"># cache_data_file(os.path.join(DD, &quot;ll1deg_grid.nc&quot;))</span>
<span class="c1"># cache_data_file(os.path.join(DD, &quot;mpas_uniform_10242_dual_counterclockwise.nc&quot;))</span>

<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">mpi4py</span> <span class="kn">import</span> <span class="n">MPI</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="k">def</span> <span class="nf">regrid</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">ESMF</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s2">&quot;ESMF is not available on this machine&quot;</span><span class="p">)</span>

    <span class="n">grid1</span> <span class="o">=</span> <span class="s2">&quot;examples/data/ll1deg_grid.nc&quot;</span>
    <span class="n">grid2</span> <span class="o">=</span> <span class="s2">&quot;examples/data/mpas_uniform_10242_dual_counterclockwise.nc&quot;</span>

    <span class="c1"># Create a uniform global latlon grid from a SCRIP formatted file</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Grid</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">grid1</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">FileFormat</span><span class="o">.</span><span class="n">SCRIP</span><span class="p">)</span>
    <span class="c1"># NOTE: corners are needed for conservative regridding</span>
    <span class="c1"># grid = ESMF.Grid(filename=grid1, filetype=ESMF.FileFormat.SCRIP,</span>
    <span class="c1">#                  add_corner_stagger=True)</span>

    <span class="c1"># create a field on the center stagger locations of the source grid</span>
    <span class="n">srcfield</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;srcfield&#39;</span><span class="p">,</span>
                          <span class="n">staggerloc</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">)</span>

    <span class="c1"># create an ESMF formatted unstructured mesh with clockwise cells removed</span>
    <span class="n">mesh</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">grid2</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">FileFormat</span><span class="o">.</span><span class="n">ESMFMESH</span><span class="p">)</span>

    <span class="c1"># create a field on the nodes of the destination mesh</span>
    <span class="n">dstfield</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;dstfield&#39;</span><span class="p">,</span> <span class="n">meshloc</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">MeshLoc</span><span class="o">.</span><span class="n">NODE</span><span class="p">)</span>
    <span class="n">xctfield</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;xctfield&#39;</span><span class="p">,</span> <span class="n">meshloc</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">MeshLoc</span><span class="o">.</span><span class="n">NODE</span><span class="p">)</span>
    <span class="c1"># NOTE: Field must be built on elements of Mesh for conservative regridding</span>
    <span class="c1"># dstfield = ESMF.Field(mesh, name=&#39;dstfield&#39;, meshloc=ESMF.MeshLoc.ELEMENT)</span>
    <span class="c1"># xctfield = ESMF.Field(mesh, name=&#39;xctfield&#39;, meshloc=ESMF.MeshLoc.ELEMENT)</span>

    <span class="c1"># initialize the fields</span>
    <span class="p">[</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">deg2rad</span> <span class="o">=</span> <span class="mf">3.14159</span> <span class="o">/</span> <span class="mi">180</span>

    <span class="n">gridXCoord</span> <span class="o">=</span> <span class="n">srcfield</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">get_coords</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">)</span>
    <span class="n">gridYCoord</span> <span class="o">=</span> <span class="n">srcfield</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">get_coords</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">)</span>
    <span class="n">srcfield</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="o">+</span> <span class="p">(</span><span class="n">gridXCoord</span> <span class="o">*</span> <span class="n">deg2rad</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span>
                                                              <span class="n">gridYCoord</span> <span class="o">*</span> <span class="n">deg2rad</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>

    <span class="n">gridXCoord</span> <span class="o">=</span> <span class="n">xctfield</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">get_coords</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">)</span>
    <span class="n">gridYCoord</span> <span class="o">=</span> <span class="n">xctfield</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">get_coords</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">)</span>
    <span class="n">xctfield</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="o">+</span> <span class="p">(</span><span class="n">gridXCoord</span> <span class="o">*</span> <span class="n">deg2rad</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span>
                                                              <span class="n">gridYCoord</span> <span class="o">*</span> <span class="n">deg2rad</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>

    <span class="n">dstfield</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1e20</span>

    <span class="c1"># create an object to regrid data from the source to the destination field</span>
    <span class="n">regrid</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Regrid</span><span class="p">(</span><span class="n">srcfield</span><span class="p">,</span> <span class="n">dstfield</span><span class="p">,</span>
                         <span class="n">regrid_method</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">RegridMethod</span><span class="o">.</span><span class="n">BILINEAR</span><span class="p">,</span>
                         <span class="n">unmapped_action</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">UnmappedAction</span><span class="o">.</span><span class="n">ERROR</span><span class="p">)</span>

    <span class="c1"># do the regridding from source to destination field</span>
    <span class="n">dstfield</span> <span class="o">=</span> <span class="n">regrid</span><span class="p">(</span><span class="n">srcfield</span><span class="p">,</span> <span class="n">dstfield</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">dstfield</span><span class="p">,</span> <span class="n">xctfield</span>

<span class="k">def</span> <span class="nf">compute_error</span><span class="p">(</span><span class="n">dstfield</span><span class="p">,</span> <span class="n">xctfield</span><span class="p">):</span>
    <span class="c1"># compute the mean relative error</span>
    <span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">mul</span>
    <span class="n">num_nodes</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="n">mul</span><span class="p">,</span> <span class="n">xctfield</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">relerr</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">meanrelerr</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">num_nodes</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">dstfield</span> <span class="o">!=</span> <span class="mf">1e20</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">xctfield</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">relerr</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
            <span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">dstfield</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">-</span> <span class="n">xctfield</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span> <span class="o">/</span> <span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span>
                <span class="n">xctfield</span><span class="p">[</span><span class="n">ind</span><span class="p">]))</span>
        <span class="n">meanrelerr</span> <span class="o">=</span> <span class="n">relerr</span> <span class="o">/</span> <span class="n">num_nodes</span>

    <span class="n">meanrelerr</span> <span class="o">=</span> <span class="n">relerr</span> <span class="o">/</span> <span class="n">num_nodes</span>
    <span class="nb">print</span> <span class="s2">&quot;ESMPy regridding as a spawned MPI process:&quot;</span>
    <span class="nb">print</span> <span class="s2">&quot;  interpolation mean relative error = </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">meanrelerr</span><span class="p">)</span>


<span class="c1">########################################### MAIN #############################</span>

<span class="n">start_worker</span> <span class="o">=</span> <span class="s1">&#39;worker&#39;</span>
<span class="n">usage</span> <span class="o">=</span> <span class="s1">&#39;Program should be started without arguments&#39;</span>
<span class="n">pet_count</span> <span class="o">=</span> <span class="mi">4</span>

<span class="c1"># Parent</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>

    <span class="c1"># Spawn workers</span>
    <span class="n">comm</span> <span class="o">=</span> <span class="n">MPI</span><span class="o">.</span><span class="n">COMM_WORLD</span><span class="o">.</span><span class="n">Spawn</span><span class="p">(</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">executable</span><span class="p">,</span>
        <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">start_worker</span><span class="p">],</span>
        <span class="n">maxprocs</span><span class="o">=</span><span class="n">pet_count</span><span class="p">)</span>

    <span class="c1"># gather output fields from workers</span>
    <span class="n">dstfield</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">dstfield</span> <span class="o">=</span> <span class="n">comm</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">dstfield</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="n">MPI</span><span class="o">.</span><span class="n">ROOT</span><span class="p">)</span>
    <span class="n">dstfield</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">dstfield</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pet_count</span><span class="p">)])</span>

    <span class="n">xctfield</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">xctfield</span> <span class="o">=</span> <span class="n">comm</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">xctfield</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="n">MPI</span><span class="o">.</span><span class="n">ROOT</span><span class="p">)</span>
    <span class="n">xctfield</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">xctfield</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pet_count</span><span class="p">)])</span>

    <span class="c1"># plot results</span>
    <span class="n">compute_error</span><span class="p">(</span><span class="n">dstfield</span><span class="p">,</span> <span class="n">xctfield</span><span class="p">)</span>

    <span class="c1"># Shutdown</span>
    <span class="n">comm</span><span class="o">.</span><span class="n">Disconnect</span><span class="p">()</span>

<span class="c1"># Worker</span>
<span class="k">elif</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">start_worker</span><span class="p">:</span>

    <span class="c1"># Connect to parent</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">comm</span> <span class="o">=</span> <span class="n">MPI</span><span class="o">.</span><span class="n">Comm</span><span class="o">.</span><span class="n">Get_parent</span><span class="p">()</span>
        <span class="n">rank</span> <span class="o">=</span> <span class="n">comm</span><span class="o">.</span><span class="n">Get_rank</span><span class="p">()</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Could not connect to parent - &#39;</span> <span class="o">+</span> <span class="n">usage</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># call ESMPy regridding</span>
        <span class="n">dstfield</span><span class="p">,</span> <span class="n">xctfield</span> <span class="o">=</span> <span class="n">regrid</span><span class="p">()</span>

        <span class="c1"># send output to parent</span>
        <span class="n">comm</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">sendobj</span><span class="o">=</span><span class="n">dstfield</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">comm</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">sendobj</span><span class="o">=</span><span class="n">xctfield</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">comm</span><span class="o">.</span><span class="n">Disconnect</span><span class="p">()</span>

    <span class="c1"># Shutdown</span>
    <span class="n">comm</span><span class="o">.</span><span class="n">Disconnect</span><span class="p">()</span>

<span class="c1"># Catch</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">usage</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</div>
</div>
</div>
<span id="document-api"></span><div class="section" id="api">
<h2>API<a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h2>
<div class="section" id="classes">
<h3>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h3>
<p>ESMPy uses a <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> object to represent data variables
built on an underlying spatial discretization, which is represented by a
<a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>, <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> or
<a class="reference internal" href="index.html#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStream</span></code></a>.
Regridding between <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Fields</span></code></a> is accomplished with the
<a class="reference internal" href="index.html#ESMF.api.regrid.Regrid" title="ESMF.api.regrid.Regrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Regrid</span></code></a> class.  All of these classes are explained in
more detail in the sections provided by the links in the following table.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 76%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Class</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#ESMF.api.esmpymanager.Manager" title="ESMF.api.esmpymanager.Manager"><code class="xref py py-class docutils literal notranslate"><span class="pre">Manager</span></code></a></p></td>
<td><p>A manager class to initialize and finalize ESMF</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>A data field built on a <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>, <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>, or <a class="reference internal" href="index.html#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStream</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a></p></td>
<td><p>A class to represent a logically rectangular grid</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a></p></td>
<td><p>A class to represent an unstructured grid</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStream</span></code></a></p></td>
<td><p>A class to represent observational data as a collection of disconnected points</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#ESMF.api.regrid.Regrid" title="ESMF.api.regrid.Regrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Regrid</span></code></a></p></td>
<td><p>The regridding utility</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#ESMF.api.regrid.RegridFromFile" title="ESMF.api.regrid.RegridFromFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">RegridFromFile</span></code></a></p></td>
<td><p>The from file regridding utility</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="named-constants">
<h3>Named Constants<a class="headerlink" href="#named-constants" title="Permalink to this headline">¶</a></h3>
<p>ESMPy follows the ESMF convention of using “named constants” to represent the
available options for parameters that expect a variety of specific inputs.  The
following table lists the available named constants and provides links to pages
that further explain the available values.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 35%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Named constants</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#ESMF.api.constants.CoordSys" title="ESMF.api.constants.CoordSys"><code class="xref py py-class docutils literal notranslate"><span class="pre">CoordSys</span></code></a></p></td>
<td><p>Specify the coordinate system of a <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#ESMF.api.constants.FileFormat" title="ESMF.api.constants.FileFormat"><code class="xref py py-class docutils literal notranslate"><span class="pre">FileFormat</span></code></a></p></td>
<td><p>Specify the format of a data file</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#ESMF.api.constants.FileMode" title="ESMF.api.constants.FileMode"><code class="xref py py-class docutils literal notranslate"><span class="pre">FileMode</span></code></a></p></td>
<td><p>Specify the mode of a data file</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#ESMF.api.constants.GridItem" title="ESMF.api.constants.GridItem"><code class="xref py py-class docutils literal notranslate"><span class="pre">GridItem</span></code></a></p></td>
<td><p>Specify a mask or area item on a <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#ESMF.api.constants.LineType" title="ESMF.api.constants.LineType"><code class="xref py py-class docutils literal notranslate"><span class="pre">LineType</span></code></a></p></td>
<td><p>Specify the type of line that connects two points on a sphere</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#ESMF.api.constants.LogKind" title="ESMF.api.constants.LogKind"><code class="xref py py-class docutils literal notranslate"><span class="pre">LogKind</span></code></a></p></td>
<td><p>Specify how much logging should be done</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#ESMF.api.constants.MeshElemType" title="ESMF.api.constants.MeshElemType"><code class="xref py py-class docutils literal notranslate"><span class="pre">MeshElemType</span></code></a></p></td>
<td><p>Specify the type of the <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> elements</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#ESMF.api.constants.MeshLoc" title="ESMF.api.constants.MeshLoc"><code class="xref py py-class docutils literal notranslate"><span class="pre">MeshLoc</span></code></a></p></td>
<td><p>Specify a nodal or elemental <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#ESMF.api.constants.NormType" title="ESMF.api.constants.NormType"><code class="xref py py-class docutils literal notranslate"><span class="pre">NormType</span></code></a></p></td>
<td><p>Specify the type of normalization to use for conservative regridding weights</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#ESMF.api.constants.PoleKind" title="ESMF.api.constants.PoleKind"><code class="xref py py-class docutils literal notranslate"><span class="pre">PoleKind</span></code></a></p></td>
<td><p>Specify the type of connection that appears at the poles of the <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#ESMF.api.constants.PoleMethod" title="ESMF.api.constants.PoleMethod"><code class="xref py py-class docutils literal notranslate"><span class="pre">PoleMethod</span></code></a></p></td>
<td><p>Specify which type of artificial pole to construct on the source <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> for regridding</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#ESMF.api.constants.Region" title="ESMF.api.constants.Region"><code class="xref py py-class docutils literal notranslate"><span class="pre">Region</span></code></a></p></td>
<td><p>Specify various regions in the data layout of</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#ESMF.api.constants.RegridMethod" title="ESMF.api.constants.RegridMethod"><code class="xref py py-class docutils literal notranslate"><span class="pre">RegridMethod</span></code></a></p></td>
<td><p>Specify which interpolation method to use regridding</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#ESMF.api.constants.StaggerLoc" title="ESMF.api.constants.StaggerLoc"><code class="xref py py-class docutils literal notranslate"><span class="pre">StaggerLoc</span></code></a></p></td>
<td><p>Specify the position for data in a <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> cell</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#ESMF.api.constants.TypeKind" title="ESMF.api.constants.TypeKind"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeKind</span></code></a></p></td>
<td><p>Specify the type and kind of data</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#ESMF.api.constants.UnmappedAction" title="ESMF.api.constants.UnmappedAction"><code class="xref py py-class docutils literal notranslate"><span class="pre">UnmappedAction</span></code></a></p></td>
<td><p>Specify which action to take with respect to unmapped destination points</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="manager">
<h3>Manager<a class="headerlink" href="#manager" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="index.html#ESMF.api.esmpymanager.Manager" title="ESMF.api.esmpymanager.Manager"><code class="xref py py-class docutils literal notranslate"><span class="pre">Manager</span></code></a> is used by ESMPy to simplify a
number of low-level calls used by the underlying ESMF framework to allocate
resources, enable logging, and control garbage collection.</p>
<div class="section" id="resource-allocation">
<h4>Resource Allocation<a class="headerlink" href="#resource-allocation" title="Permalink to this headline">¶</a></h4>
<p>The ESMF Virtual Machine (VM) <a class="reference external" href="http://www.earthsystemmodeling.org/esmf_releases/public/ESMF_8_0_1/ESMF_refdoc/node6.html#SECTION060120000000000000000">ESMF Virtual Machine (VM)</a>
is created at the beginning of each ESMPy execution, and contains information
about the topology and characteristics of the underlying computer. The VM
allocates computational resources in the form of
<strong>Persistent Execution Threads</strong>, or <strong>PETs</strong>. These are equivalent to operating
system threads with a lifetime of at least that of the ESMPy execution. In the
simplest, and most common case, a PET is equivalent to an MPI process. The
number of PETs and the current PET can be queried from the
<a class="reference internal" href="index.html#ESMF.api.esmpymanager.Manager" title="ESMF.api.esmpymanager.Manager"><code class="xref py py-class docutils literal notranslate"><span class="pre">Manager</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mg</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Manager</span><span class="p">()</span>
<span class="n">pet_count</span> <span class="o">=</span> <span class="n">mg</span><span class="o">.</span><span class="n">pet_count</span><span class="p">()</span>
<span class="n">local_pet</span> <span class="o">=</span> <span class="n">mg</span><span class="o">.</span><span class="n">local_pet</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="logging">
<h4>Logging<a class="headerlink" href="#logging" title="Permalink to this headline">¶</a></h4>
<p>The <a class="reference internal" href="index.html#ESMF.api.esmpymanager.Manager" title="ESMF.api.esmpymanager.Manager"><code class="xref py py-class docutils literal notranslate"><span class="pre">Manager</span></code></a> is also used to enable logging:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mg</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Manager</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">local_pet</span> <span class="o">=</span> <span class="n">mg</span><span class="o">.</span><span class="n">local_pet</span><span class="p">()</span>
</pre></div>
</div>
<p>The output will be logged in files named PET&lt;local_pet&gt;.ESMF_LogFile.</p>
</div>
<div class="section" id="garbage-collection">
<h4>Garbage Collection<a class="headerlink" href="#garbage-collection" title="Permalink to this headline">¶</a></h4>
<p>The underlying ESMF framework needs to be initialized and finalized once and
only once per execution. This is handled internally by the
<a class="reference internal" href="index.html#ESMF.api.esmpymanager.Manager" title="ESMF.api.esmpymanager.Manager"><code class="xref py py-class docutils literal notranslate"><span class="pre">Manager</span></code></a> and <strong>does not</strong> require any explicit
user intervention. However, the ESMF garbage collection feature is not triggered
until the finalization routine is invoked. So if memory deallocation of ESMPy
objects is required <em>prior</em> to the end of the program, the class level
<code class="docutils literal notranslate"><span class="pre">destroy</span></code> routines should be invoked:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mg</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Manager</span><span class="p">()</span>

<span class="n">mg</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
</pre></div>
</div>
<p>This is commonly required when reusing a <a class="reference internal" href="index.html#ESMF.api.regrid.Regrid" title="ESMF.api.regrid.Regrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Regrid</span></code></a> object
to interpolate data between many <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> pairs to
conserve memory to complete all interpolations in a single execution.</p>
</div>
</div>
<div class="section" id="spatial-discretization-objects">
<h3>Spatial Discretization Objects<a class="headerlink" href="#spatial-discretization-objects" title="Permalink to this headline">¶</a></h3>
<p>There are three different objects used for spatial coordinate representation:
<a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>, <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>, and <a class="reference internal" href="index.html#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStream</span></code></a>. <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></a> are used to represent logically rectangular
grids, <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Meshes</span></code></a> are used for unstructured collections of polygons, and
<a class="reference internal" href="index.html#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStreams</span></code></a> are used for unstructured collections of individual points. These
objects are nearly identical counterparts to the objects of the same name in
ESMF, with some simplifications for ease of use in the Python environment.</p>
<div class="section" id="grid">
<h4>Grid<a class="headerlink" href="#grid" title="Permalink to this headline">¶</a></h4>
<p>The <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> is used to represent the geometry and discretization of logically
rectangular physical grids. The <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> can also hold information that can used in
calculations involving the <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>, like a mask or the cell areas. The ESMF reference
manual has an in-depth description of the
<a class="reference external" href="http://www.earthsystemmodeling.org/esmf_releases/public/ESMF_8_0_1/ESMF_refdoc/node5.html#SECTION05080000000000000000">Grid class</a>.</p>
<div class="section" id="staggering">
<h5>Staggering<a class="headerlink" href="#staggering" title="Permalink to this headline">¶</a></h5>
<p>Staggering is a finite difference technique in which the values of different
physical quantities are placed at different locations within a grid cell.</p>
<p>The ESMF <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> class supports a variety of stagger locations, including cell
centers, corners, and edge centers. The default stagger location in ESMF is the
cell center, and cell counts in <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> are based on this assumption. Combinations
of the 2D ESMF stagger locations are sufficient to specify any of the Arakawa
staggers. ESMF also supports staggering in 3D and higher dimensions. There are
shortcuts for standard staggers, and interfaces through which users can create
custom staggers.</p>
<p>As a default the ESMF <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> class provides symmetric staggering, so that cell
centers are enclosed by cell perimeter (e.g. corner) stagger locations. This
means the coordinate arrays for stagger locations other than the center will
have an additional element of padding in order to enclose the cell center
locations. However, to achieve other types of staggering, the user may alter or
eliminate this padding by using the appropriate options when adding coordinates
to a <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>.</p>
<p><a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> staggers are indicated using
<a class="reference internal" href="index.html#ESMF.api.constants.StaggerLoc" title="ESMF.api.constants.StaggerLoc"><code class="xref py py-class docutils literal notranslate"><span class="pre">StaggerLoc</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Grid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span> <span class="n">staggerloc</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="spherical-coordinates">
<h5>Spherical Coordinates<a class="headerlink" href="#spherical-coordinates" title="Permalink to this headline">¶</a></h5>
<p>In the case that the <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> is on a sphere (coord_sys = <a class="reference internal" href="index.html#ESMF.api.constants.CoordSys.SPH_DEG" title="ESMF.api.constants.CoordSys.SPH_DEG"><code class="xref py py-class docutils literal notranslate"><span class="pre">ESMF.api.constants.CoordSys.SPH_DEG</span></code></a> or
<a class="reference internal" href="index.html#ESMF.api.constants.CoordSys.SPH_RAD" title="ESMF.api.constants.CoordSys.SPH_RAD"><code class="xref py py-class docutils literal notranslate"><span class="pre">ESMF.api.constants.CoordSys.SPH_RAD</span></code></a>) then the coordinates given in the <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> are interpreted
as latitude and longitude values. The coordinates can either be in degrees or
radians as indicated by the <code class="docutils literal notranslate"><span class="pre">coord_sys</span></code> flag set during <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> creation. As is
true with many global models, this application currently assumes the latitude
and longitude refer to positions on a perfect sphere.</p>
<p>The <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> coordinate system is represented using
<a class="reference internal" href="index.html#ESMF.api.constants.CoordSys" title="ESMF.api.constants.CoordSys"><code class="xref py py-class docutils literal notranslate"><span class="pre">CoordSys</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Grid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span> <span class="n">staggerloc</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">,</span>
                    <span class="n">coord_sys</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">CoordSys</span><span class="o">.</span><span class="n">SPH_DEG</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="periodicity">
<h5>Periodicity<a class="headerlink" href="#periodicity" title="Permalink to this headline">¶</a></h5>
<p>A periodic connection can be specified when building <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></a> in spherical
coordinates. The <code class="docutils literal notranslate"><span class="pre">num_peri_dims</span></code> parameter indicates the total number of
periodic dimensions and <code class="docutils literal notranslate"><span class="pre">periodic_dim</span></code> is used to identify which dimensions
should be considered periodic. There must always be at least one non-periodic
dimension. For example, to create a global latitude-longitude <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> there would
be one periodic dimension, dimension 0 (longitude).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Grid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span> <span class="n">staggerloc</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">,</span>
                    <span class="n">coord_sys</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">CoordSys</span><span class="o">.</span><span class="n">SPH_DEG</span><span class="p">,</span>
                    <span class="n">num_peri_dims</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">periodic_dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="pole-generation">
<h5>Pole Generation<a class="headerlink" href="#pole-generation" title="Permalink to this headline">¶</a></h5>
<p>The <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> can generate an artificial pole by using the <code class="docutils literal notranslate"><span class="pre">pole_dim</span></code> parameter. This
can be helpful for regridding operations to smooth out the interpolated values
in the polar region. For the example of creating a global latitude-longitude
<a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>, the pole dimension would be 1 (latitude).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Grid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span> <span class="n">staggerloc</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">,</span>
                    <span class="n">coord_sys</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">CoordSys</span><span class="o">.</span><span class="n">SPH_DEG</span><span class="p">,</span>
                    <span class="n">num_peri_dims</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">periodic_dim</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">pole_dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="masking">
<h5>Masking<a class="headerlink" href="#masking" title="Permalink to this headline">¶</a></h5>
<p>Masking is the process used to mark parts of a <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> to be ignored during an
operation. Marking <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> cells as masked can affect the <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> values that are
represented by those cells. Masking is specified by assigning an integer value
to a <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> cell. This allows many different masks to be defined on the same <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>,
any combination of which may be also activated on the <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> by specifying the
corresponding integer values. The activation of <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> masks with respect to the
underlying <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> mask is handled by <a class="reference internal" href="index.html#ESMF.api.regrid.Regrid" title="ESMF.api.regrid.Regrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Regrid</span></code></a>, and a more
general discussion of masking is covered in the <a class="reference internal" href="#id8"><span class="std std-ref">masking</span></a>
section.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
   <span class="o">...</span><span class="p">:</span> <span class="kn">import</span> <span class="nn">ESMF</span>
   <span class="o">...</span><span class="p">:</span> <span class="n">grid</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Grid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span> <span class="n">staggerloc</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">,</span>
   <span class="o">...</span><span class="p">:</span>                                <span class="n">coord_sys</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">CoordSys</span><span class="o">.</span><span class="n">SPH_DEG</span><span class="p">,</span>
   <span class="o">...</span><span class="p">:</span>                                <span class="n">num_peri_dims</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">periodic_dim</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">pole_dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
   <span class="o">...</span><span class="p">:</span>
   <span class="o">...</span><span class="p">:</span> <span class="n">mask</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="n">ESMF</span><span class="o">.</span><span class="n">GridItem</span><span class="o">.</span><span class="n">MASK</span><span class="p">,</span> <span class="n">staggerloc</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">)</span>
   <span class="o">...</span><span class="p">:</span> <span class="n">mask</span>
   <span class="o">...</span><span class="p">:</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="cell-areas">
<h5>Cell Areas<a class="headerlink" href="#cell-areas" title="Permalink to this headline">¶</a></h5>
<p><a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> cell areas can be calculated by ESMPy. Space must first be allocated for
this calculation by adding an
<a class="reference internal" href="index.html#ESMF.api.constants.GridItem.AREA" title="ESMF.api.constants.GridItem.AREA"><code class="xref py py-class docutils literal notranslate"><span class="pre">AREA</span></code></a> item to the <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>.
Then a <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> must be created, and the
<a class="reference internal" href="index.html#ESMF.api.field.Field.get_area" title="ESMF.api.field.Field.get_area"><code class="xref py py-class docutils literal notranslate"><span class="pre">get_area()</span></code></a> function called.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> area calculation assumes the <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> is a unit sphere.</p>
</div>
<p><a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> cell areas may also be set to user-defined values
after the <a class="reference internal" href="index.html#ESMF.api.constants.GridItem.AREA" title="ESMF.api.constants.GridItem.AREA"><code class="xref py py-class docutils literal notranslate"><span class="pre">AREA</span></code></a> item has
been allocated and retrieved using <a class="reference internal" href="index.html#ESMF.api.grid.Grid.get_item" title="ESMF.api.grid.Grid.get_item"><code class="xref py py-class docutils literal notranslate"><span class="pre">get_item()</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">grid</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Grid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span> <span class="n">staggerloc</span><span class="o">=</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">,</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CORNER</span><span class="p">],</span>
   <span class="o">...</span><span class="p">:</span>                  <span class="n">coord_sys</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">CoordSys</span><span class="o">.</span><span class="n">SPH_DEG</span><span class="p">,</span>
   <span class="o">...</span><span class="p">:</span>                  <span class="n">num_peri_dims</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">periodic_dim</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">pole_dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
   <span class="o">...</span><span class="p">:</span>
   <span class="o">...</span><span class="p">:</span>
   <span class="o">...</span><span class="p">:</span> <span class="n">gridLon</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">get_coords</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
   <span class="o">...</span><span class="p">:</span> <span class="n">gridLat</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">get_coords</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
   <span class="o">...</span><span class="p">:</span> <span class="n">gridLonCorner</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">get_coords</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">staggerloc</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CORNER</span><span class="p">)</span>
   <span class="o">...</span><span class="p">:</span> <span class="n">gridLatCorner</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">get_coords</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">staggerloc</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CORNER</span><span class="p">)</span>
   <span class="o">...</span><span class="p">:</span>
   <span class="o">...</span><span class="p">:</span> <span class="n">lon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">120</span><span class="p">,</span><span class="mi">120</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
   <span class="o">...</span><span class="p">:</span> <span class="n">lat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">67.5</span><span class="p">,</span> <span class="mf">67.5</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
   <span class="o">...</span><span class="p">:</span> <span class="n">lon_corner</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">120</span><span class="p">)</span>
   <span class="o">...</span><span class="p">:</span> <span class="n">lat_corner</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
   <span class="o">...</span><span class="p">:</span>
   <span class="o">...</span><span class="p">:</span> <span class="n">lonm</span><span class="p">,</span> <span class="n">latm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">indexing</span><span class="o">=</span><span class="s1">&#39;ij&#39;</span><span class="p">)</span>
   <span class="o">...</span><span class="p">:</span> <span class="n">lonm_corner</span><span class="p">,</span> <span class="n">latm_corner</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lon_corner</span><span class="p">,</span> <span class="n">lat_corner</span><span class="p">,</span> <span class="n">indexing</span><span class="o">=</span><span class="s1">&#39;ij&#39;</span><span class="p">)</span>
   <span class="o">...</span><span class="p">:</span>
   <span class="o">...</span><span class="p">:</span> <span class="n">gridLon</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">lonm</span>
   <span class="o">...</span><span class="p">:</span> <span class="n">gridLat</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">latm</span>
   <span class="o">...</span><span class="p">:</span> <span class="n">gridLonCorner</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">lonm_corner</span>
   <span class="o">...</span><span class="p">:</span> <span class="n">gridLatCorner</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">latm_corner</span>
   <span class="o">...</span><span class="p">:</span>
   <span class="o">...</span><span class="p">:</span> <span class="n">field</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
   <span class="o">...</span><span class="p">:</span> <span class="n">field</span><span class="o">.</span><span class="n">get_area</span><span class="p">()</span>
   <span class="o">...</span><span class="p">:</span> <span class="n">field</span><span class="o">.</span><span class="n">data</span>
   <span class="o">...</span><span class="p">:</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.32224085</span><span class="p">,</span>  <span class="mf">1.02707409</span><span class="p">,</span>  <span class="mf">1.02707409</span><span class="p">,</span>  <span class="mf">0.32224085</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.32224085</span><span class="p">,</span>  <span class="mf">1.02707409</span><span class="p">,</span>  <span class="mf">1.02707409</span><span class="p">,</span>  <span class="mf">0.32224085</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.32224085</span><span class="p">,</span>  <span class="mf">1.02707409</span><span class="p">,</span>  <span class="mf">1.02707409</span><span class="p">,</span>  <span class="mf">0.32224085</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="mesh">
<h4>Mesh<a class="headerlink" href="#mesh" title="Permalink to this headline">¶</a></h4>
<p>A <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> is an object for representing unstructured grids. The ESMF reference
manual has an in-depth description of the
<a class="reference external" href="http://www.earthsystemmodeling.org/esmf_releases/public/ESMF_8_0_1/ESMF_refdoc/node5.html#SECTION050100000000000000000">Mesh class</a>.</p>
<p>A <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> is constructed of <em>nodes</em> and <em>elements</em>. A node, also known as a vertex
or corner, is a part of a <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> which represents a single point. An element,
also known as a cell, is a part of a <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> which represents a small
region of space. Elements are described in terms of a connected set of nodes
which represent locations along their boundaries.</p>
<p><a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> data may be located on either the nodes or elements of a <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>. <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Fields</span></code></a>
created on a <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> can also be used as either the source or destination or both
of a regridding operation.</p>
<p>The dimension of a <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> in ESMF is specified with two parameters: the
<em>parametric</em> dimension and the <em>spatial</em> dimension.</p>
<p>The parametric dimension of a <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> is the dimension of the topology of the <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>.
This can be thought of as the dimension of the elements which make up the <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>.
For example, a <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> composed of triangles would have a parametric dimension of
2, and a <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> composed of tetrahedra would have a parametric dimension of 3.</p>
<p>The spatial dimension of a <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> is the dimension of the space in which the <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>
is embedded. In other words, it is the number of coordinate dimensions needed to
describe the location of the nodes making up the <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>.</p>
<p>For example, a <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> constructed of squares on a plane would have a parametric
dimension of 2 and a spatial dimension of 2. If that same <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> were used to
represent the 2D surface of a sphere, then the <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> would still have a
parametric dimension of 2, but now its spatial dimension would be 3.</p>
<p>Only <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Meshes</span></code></a> whose number of coordinate dimensions (spatial dimension) is 2 or 3
are supported. The dimension of the elements in a <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> (parametric dimension) must
be less than or equal to the spatial dimension, but also must be either 2 or 3.
This means that a <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> may be either 2D elements in 2D space, 3D elements in 3D
space, or a manifold constructed of 2D elements embedded in 3D space.</p>
<p>For a parametric dimension of 2, the native supported element types are
triangles and quadrilaterals. In addition to these, ESMF supports 2D polygons
with any number of sides. Internally these are represented as sets of triangles,
but to the user should behave like any other element. For a parametric dimension
of 3, the supported element types are tetrahedrons and hexahedrons. The <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>
supports any combination of element types within a particular dimension, but
types from different dimensions may not be mixed. For example, a <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> cannot be
constructed of both quadrilaterals and tetrahedra.</p>
<div class="section" id="mesh-creation">
<h5>Mesh Creation<a class="headerlink" href="#mesh-creation" title="Permalink to this headline">¶</a></h5>
<p>To create a <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> we need to set some properties of the <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> as a whole, some
properties of each node in the <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> and then some properties of each element
which connects the nodes.</p>
<p>For the <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> as a whole we set its parametric dimension and spatial dimension.
A <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh's</span></code></a> parametric dimension can be thought of as the dimension of the elements
which make up the <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>. A <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh's</span></code></a> spatial dimension, on the other hand, is the
number of coordinate dimensions needed to describe the location of the nodes
making up the <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>.</p>
<p>The structure of the per node and element information used to create a <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> is
influenced by the <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> distribution strategy. The <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> class is distributed by
elements. This means that a node must be present on any PET that contains
an element associated with that node, but not on any other PET (a node
can’t be on a PET without an element “home”). Since a node may be used by
two or more elements located on different PETs, a node may be duplicated
on multiple PETs. When a node is duplicated in this manner, one and only
one of the PETs that contain the node must “own” the node. The user sets
this ownership when they define the nodes during <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>
creation. When a <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> is created on a
<a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> (i.e. on the <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> nodes),
on each PET the <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> is only
created on the nodes which are owned by that PET. This means that the size
of the <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> memory on the PET can be smaller than the
number of nodes used to create the <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> on that PET.</p>
<p>Three properties need to be defined for each <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> node: the global id of the node
(<code class="docutils literal notranslate"><span class="pre">node_ids</span></code>), node coordinates (<code class="docutils literal notranslate"><span class="pre">node_coords</span></code>), and which PET owns the node
(<code class="docutils literal notranslate"><span class="pre">node_owners</span></code>). The node id is a unique (across all PETs) integer attached
to the particular node. It is used to indicate which nodes are the same when
connecting together pieces of the <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> on different PETs. The node
coordinates indicate the location of a node in space and are used in the <a class="reference internal" href="index.html#ESMF.api.regrid.Regrid" title="ESMF.api.regrid.Regrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Regrid</span></code></a>
functionality when interpolating. The node owner indicates which PET is in
charge of the node. This is used when creating a <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> on the <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> to indicate
which PET should contain a <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> location for the data.</p>
<p>Three properties need to be defined for each <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> element: the global id of the
element (<code class="docutils literal notranslate"><span class="pre">element_ids</span></code>), the topology type of the element (<code class="docutils literal notranslate"><span class="pre">element_types</span></code>), and
which nodes are connected together to form the element (<code class="docutils literal notranslate"><span class="pre">element_conn</span></code>). The
element id is a unique (across all PETs) integer attached to the
particular element. The element type describes the topology of the element
(e.g. a triangle vs. a quadrilateral). The range of choices for the topology of
the elements in a <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> are restricted by the <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh's</span></code></a> parametric dimension (e.g. a
<a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> can’t contain a 2D element like a triangle, when its parametric dimension
is 3D), but it can contain any combination of elements appropriate to its
dimension. In particular, in 2D ESMF supports two native element types triangle
and quadrilateral, but also provides support for polygons with any number of
sides. These polygons are represented internally as sets of triangles, but to
the user should behave like other elements. To specify a polygon with more than
four sides, the element type should be set to the number of corners of the
polygon (e.g. element type=6 for a hexagon). The element connectivity indicates
which nodes are to be connected together to form the element. The number of
nodes connected together for each element is implied by the elements topology
type (<code class="docutils literal notranslate"><span class="pre">element_types</span></code>). It is IMPORTANT to note, that the entries in this list are
NOT the global ids of the nodes, but are indices into the PET local lists
of node info used in the <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> creation. In other words, the element connectivity
isn’t specified in terms of the global list of nodes, but instead is specified
in terms of the locally described node info. One other important point about
connectivities is that the order of the nodes in the connectivity list of an
element is important. In general, when specifying an element with parametric
dimension 2, the nodes should be given in counterclockwise order around the
element.</p>
<p>The three step <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> creation process starts with a call to the <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> constructor.
It is then followed by the <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh.add_nodes" title="ESMF.api.mesh.Mesh.add_nodes"><code class="xref py py-class docutils literal notranslate"><span class="pre">add_nodes()</span></code></a> call to
specify nodes, and then the <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh.add_elements" title="ESMF.api.mesh.Mesh.add_elements"><code class="xref py py-class docutils literal notranslate"><span class="pre">add_elements()</span></code></a> call to
specify elements.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#  2.5        8        10 --------11</span>
<span class="c1">#          /     \   /            |</span>
<span class="c1">#  2.1   7         9              12</span>
<span class="c1">#        |         |      5       /</span>
<span class="c1">#        |    4    |            /</span>
<span class="c1">#        |         |          /</span>
<span class="c1">#  1.0   4 ------- 5 ------- 6</span>
<span class="c1">#        |         |  \   3  |</span>
<span class="c1">#        |    1    |    \    |</span>
<span class="c1">#        |         |  2   \  |</span>
<span class="c1"># -0.1   1 ------- 2 ------- 3</span>
<span class="c1">#</span>
<span class="c1">#      -0.1       1.0       2.1   2.5</span>
<span class="c1">#</span>
<span class="c1">#          Node Ids at corners</span>
<span class="c1">#          Element Ids in centers</span>

<span class="c1"># Two parametric dimensions, and two spatial dimensions</span>
<span class="n">mesh</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">parametric_dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">spatial_dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">coord_sys</span><span class="o">=</span><span class="n">coord_sys</span><span class="p">)</span>

<span class="n">num_node</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">num_elem</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">nodeId</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">])</span>
<span class="n">nodeCoord</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span>  <span class="c1">#node id 1</span>
                      <span class="mf">1.0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span>  <span class="c1">#node id 2</span>
                      <span class="mf">2.1</span><span class="p">,</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span>  <span class="c1">#node id 3</span>
                      <span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span>  <span class="c1">#node id 4</span>
                      <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span>  <span class="c1">#node id 5</span>
                      <span class="mf">2.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span>  <span class="c1">#node id 6</span>
                      <span class="mf">0.1</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span>  <span class="c1">#node id 7</span>
                      <span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span>  <span class="c1">#node id 8</span>
                      <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span>  <span class="c1">#node id 9</span>
                      <span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span>  <span class="c1">#node id 10</span>
                      <span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span>  <span class="c1">#node id 11</span>
                      <span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">])</span> <span class="c1">#node id 12</span>


<span class="n">nodeOwner</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_node</span><span class="p">)</span>

<span class="n">elemId</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">elemType</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ESMF</span><span class="o">.</span><span class="n">MeshElemType</span><span class="o">.</span><span class="n">QUAD</span><span class="p">,</span>
                   <span class="n">ESMF</span><span class="o">.</span><span class="n">MeshElemType</span><span class="o">.</span><span class="n">TRI</span><span class="p">,</span>
                   <span class="n">ESMF</span><span class="o">.</span><span class="n">MeshElemType</span><span class="o">.</span><span class="n">TRI</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>

<span class="n">elemConn</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span>         <span class="c1"># elem id 1</span>
                   <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span>           <span class="c1"># elem id 2</span>
                   <span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span>           <span class="c1"># elem id 3</span>
                   <span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span>       <span class="c1"># elem id 4</span>
                   <span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>  <span class="c1"># elem id 5</span>

<span class="n">mesh</span><span class="o">.</span><span class="n">add_nodes</span><span class="p">(</span><span class="n">num_node</span><span class="p">,</span><span class="n">nodeId</span><span class="p">,</span><span class="n">nodeCoord</span><span class="p">,</span><span class="n">nodeOwner</span><span class="p">)</span>

<span class="n">mesh</span><span class="o">.</span><span class="n">add_elements</span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="n">elemId</span><span class="p">,</span><span class="n">elemType</span><span class="p">,</span><span class="n">elemConn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id1">
<h5>Masking<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h5>
<p>There are two types of masking available in <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>: node masking and element
masking. These both work in a similar manner, but vary slightly in the details
of setting the mask information during <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> creation.</p>
<p>For node masking, the mask information is set using the <code class="docutils literal notranslate"><span class="pre">node_mask</span></code> parameter.
When a <a class="reference internal" href="index.html#ESMF.api.regrid.Regrid" title="ESMF.api.regrid.Regrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Regrid</span></code></a> object is created the mask values arguments <code class="docutils literal notranslate"><span class="pre">src_mask_values</span></code> and
<code class="docutils literal notranslate"><span class="pre">dst_mask_values</span></code> can then be used to indicate which particular values set in
the <code class="docutils literal notranslate"><span class="pre">node_mask</span></code> array indicate that the node should be masked. For example, if
<code class="docutils literal notranslate"><span class="pre">dst_mask_values</span></code> has been set to 1, then any node in the destination <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> whose
corresponding <code class="docutils literal notranslate"><span class="pre">node_mask</span></code> value is 1 will be masked out (a node with any other
value than 1 will not be masked).</p>
<p>For element masking, the mask information is set using the <code class="docutils literal notranslate"><span class="pre">element_mask</span></code>
parameter when adding elements to the <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>. In a similar manner to node masking,
the mask values parameters to <a class="reference internal" href="index.html#ESMF.api.regrid.Regrid" title="ESMF.api.regrid.Regrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Regrid</span></code></a>, <code class="docutils literal notranslate"><span class="pre">src_mask_values</span></code> and <code class="docutils literal notranslate"><span class="pre">dst_mask_values</span></code>
can then be used to indicate which particular values set in the <code class="docutils literal notranslate"><span class="pre">element_mask</span></code>
array indicate that the element should be masked. For example, if
<code class="docutils literal notranslate"><span class="pre">dst_mask_values</span></code> has been set to 1, then any element in the destination <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>
whose corresponding <code class="docutils literal notranslate"><span class="pre">element_mask</span></code> value is 1 will be masked out (an element
with any other value than 1 will not be masked).</p>
</div>
<div class="section" id="areas">
<h5>Areas<a class="headerlink" href="#areas" title="Permalink to this headline">¶</a></h5>
<p><a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> cell areas can be specified using the <code class="docutils literal notranslate"><span class="pre">element_areas</span></code> parameter to
<a class="reference internal" href="index.html#ESMF.api.mesh.Mesh.add_elements" title="ESMF.api.mesh.Mesh.add_elements"><code class="xref py py-class docutils literal notranslate"><span class="pre">add_elements()</span></code></a>.</p>
<p>If cell areas are not specified by the user they can be calculated by ESMPy
using <a class="reference internal" href="index.html#ESMF.api.field.Field.get_area" title="ESMF.api.field.Field.get_area"><code class="xref py py-class docutils literal notranslate"><span class="pre">get_area()</span></code></a>.</p>
</div>
</div>
<div class="section" id="locstream">
<h4>LocStream<a class="headerlink" href="#locstream" title="Permalink to this headline">¶</a></h4>
<p>A <a class="reference internal" href="index.html#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStream</span></code></a> can be used to represent the locations of a set of
data points. For example, in the data assimilation world, <a class="reference internal" href="index.html#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStreams</span></code></a> can be used
to represent a set of observations. The values of the data points are stored
within a <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> created using the <a class="reference internal" href="index.html#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStream</span></code></a>. The ESMF reference
manual has an in-depth description of the
<a class="reference external" href="http://www.earthsystemmodeling.org/esmf_releases/public/ESMF_8_0_1/ESMF_refdoc/node5.html#SECTION05090000000000000000">LocStream class</a>.</p>
<p>The locations are generally described using Cartesian (x, y, z), or
(lat, lon, radius) coordinates. The coordinates are stored using constructs
called <em>keys</em>. A key is essentially a list of point descriptors, one for each data
point. They may hold other information besides the coordinates - a mask, for
example. They may also hold a second set of coordinates. Keys are referenced by
name. Each key must contain the same number of elements as there are data points
in the <a class="reference internal" href="index.html#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStream</span></code></a>. While there is no assumption in the ordering of the points,
the order chosen must be maintained in each of the keys.</p>
<p>A <a class="reference internal" href="index.html#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStream</span></code></a> can be very large. Data assimilation systems might use <a class="reference internal" href="index.html#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStreams</span></code></a>
with up to <img class="math" src="_images/math/4ab319b8ffcfc6de23092d698c335f347028e39f.png" alt="10^8"/> observations, so efficiency is critical. <a class="reference internal" href="index.html#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStreams</span></code></a> can be
created from file.</p>
<p>A <a class="reference internal" href="index.html#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStream</span></code></a> is similar to a <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> in that both are collections of irregularly
positioned points. However, the two structures differ because a <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> also has
connectivity: each data point represents either a center or corner of a cell.
There is no requirement that the points in a <a class="reference internal" href="index.html#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStream</span></code></a> have connectivity, in
fact there is no requirement that any two points have any particular spatial
relationship at all.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">locstream</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">LocStream</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">coord_sys</span><span class="o">=</span><span class="n">coord_sys</span><span class="p">)</span>

<span class="n">deg_rad</span> <span class="o">=</span> <span class="n">pi</span>
<span class="k">if</span> <span class="n">coord_sys</span> <span class="o">==</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">CoordSys</span><span class="o">.</span><span class="n">SPH_DEG</span><span class="p">:</span>
    <span class="n">deg_rad</span> <span class="o">=</span> <span class="mi">180</span>

<span class="n">locstream</span><span class="p">[</span><span class="s2">&quot;ESMF:Lon&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">]</span>
<span class="n">locstream</span><span class="p">[</span><span class="s2">&quot;ESMF:Lat&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">deg_rad</span><span class="o">/-</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">deg_rad</span><span class="o">/-</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">deg_rad</span><span class="o">/-</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">deg_rad</span><span class="o">/-</span><span class="mf">2.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="mf">0.25</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="mf">0.25</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="mf">0.25</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="mf">0.25</span><span class="o">*</span><span class="n">deg_rad</span><span class="p">,</span> <span class="n">deg_rad</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">deg_rad</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">deg_rad</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">deg_rad</span><span class="o">/</span><span class="mf">2.0</span><span class="p">]</span>
<span class="k">if</span> <span class="n">domask</span><span class="p">:</span>
    <span class="n">locstream</span><span class="p">[</span><span class="s2">&quot;ESMF:Mask&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="create-a-grid-or-mesh-from-file">
<h3>Create a Grid or Mesh from File<a class="headerlink" href="#create-a-grid-or-mesh-from-file" title="Permalink to this headline">¶</a></h3>
<div class="section" id="file-formats">
<h4>File Formats<a class="headerlink" href="#file-formats" title="Permalink to this headline">¶</a></h4>
<p>ESMPy can create <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> or <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> objects from NetCDF files in a variety
of formats.  A <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> can be created from files in <a class="reference internal" href="index.html#ESMF.api.constants.FileFormat.SCRIP" title="ESMF.api.constants.FileFormat.SCRIP"><code class="xref py py-class docutils literal notranslate"><span class="pre">SCRIP</span></code></a>, <a class="reference internal" href="index.html#ESMF.api.constants.FileFormat.ESMFMESH" title="ESMF.api.constants.FileFormat.ESMFMESH"><code class="xref py py-class docutils literal notranslate"><span class="pre">ESMFMESH</span></code></a>, and <a class="reference internal" href="index.html#ESMF.api.constants.FileFormat.UGRID" title="ESMF.api.constants.FileFormat.UGRID"><code class="xref py py-class docutils literal notranslate"><span class="pre">UGRID</span></code></a>
formats.  <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> files can be in <a class="reference internal" href="index.html#ESMF.api.constants.FileFormat.SCRIP" title="ESMF.api.constants.FileFormat.SCRIP"><code class="xref py py-class docutils literal notranslate"><span class="pre">SCRIP</span></code></a> and <a class="reference internal" href="index.html#ESMF.api.constants.FileFormat.GRIDSPEC" title="ESMF.api.constants.FileFormat.GRIDSPEC"><code class="xref py py-class docutils literal notranslate"><span class="pre">GRIDSPEC</span></code></a> format.</p>
<div class="section" id="scrip">
<h5>SCRIP<a class="headerlink" href="#scrip" title="Permalink to this headline">¶</a></h5>
<p id="id2">This file format is used by the <a class="reference internal" href="index.html#ESMF.api.constants.FileFormat.SCRIP" title="ESMF.api.constants.FileFormat.SCRIP"><code class="xref py py-class docutils literal notranslate"><span class="pre">SCRIP</span></code></a> <a class="bibtex reference internal" href="index.html#ref-scrip" id="id3">[1]</a>, package, grid files that
work with that package should also work here.  <a class="reference internal" href="index.html#ESMF.api.constants.FileFormat.SCRIP" title="ESMF.api.constants.FileFormat.SCRIP"><code class="xref py py-class docutils literal notranslate"><span class="pre">SCRIP</span></code></a> format files are
capable of storing either 2D logically rectangular grids or 2D
unstructured grids.  More information can be found in the ESMF reference
manual section on the <a class="reference external" href="http://www.earthsystemmodeling.org/esmf_releases/public/ESMF_8_0_1/ESMF_refdoc/node3.html#SECTION03028100000000000000">SCRIP Grid File Format</a>.</p>
</div>
<div class="section" id="esmfmesh">
<h5>ESMFMESH<a class="headerlink" href="#esmfmesh" title="Permalink to this headline">¶</a></h5>
<p id="id4">ESMF has a custom unstructured grid file format for describing <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Meshes</span></code></a>.
This format is more compatible than the <a class="reference internal" href="index.html#ESMF.api.constants.FileFormat.SCRIP" title="ESMF.api.constants.FileFormat.SCRIP"><code class="xref py py-class docutils literal notranslate"><span class="pre">SCRIP</span></code></a> format with the methods
used to create a <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> object, so less conversion needs to be done to
create a <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>. The <a class="reference internal" href="index.html#ESMF.api.constants.FileFormat.ESMFMESH" title="ESMF.api.constants.FileFormat.ESMFMESH"><code class="xref py py-class docutils literal notranslate"><span class="pre">ESMFMESH</span></code></a> format is thus more efficient than <a class="reference internal" href="index.html#ESMF.api.constants.FileFormat.SCRIP" title="ESMF.api.constants.FileFormat.SCRIP"><code class="xref py py-class docutils literal notranslate"><span class="pre">SCRIP</span></code></a> when
used with ESMPy.  More information can be found in the ESMF reference
manual section on the <a class="reference external" href="http://www.earthsystemmodeling.org/esmf_releases/public/ESMF_8_0_1/ESMF_refdoc/node3.html#SECTION03028200000000000000">ESMF Unstructured Grid File Format</a>.</p>
</div>
<div class="section" id="gridspec">
<h5>GRIDSPEC<a class="headerlink" href="#gridspec" title="Permalink to this headline">¶</a></h5>
<p id="id5"><a class="reference internal" href="index.html#ESMF.api.constants.FileFormat.GRIDSPEC" title="ESMF.api.constants.FileFormat.GRIDSPEC"><code class="xref py py-class docutils literal notranslate"><span class="pre">GRIDSPEC</span></code></a> is an extension to the Climate and Forecast (CF) metadata
conventions for the representation of gridded data for Earth System
Models.  ESMPy supports NetCDF files that follow the CF <a class="reference internal" href="index.html#ESMF.api.constants.FileFormat.GRIDSPEC" title="ESMF.api.constants.FileFormat.GRIDSPEC"><code class="xref py py-class docutils literal notranslate"><span class="pre">GRIDSPEC</span></code></a>
convention to support logically rectangular lat/lon grids.  More
information can be found in the ESMF reference manual section on the
<a class="reference external" href="http://www.earthsystemmodeling.org/esmf_releases/public/ESMF_8_0_1/ESMF_refdoc/node3.html#SECTION03028300000000000000">CF Convention GRIDSPEC File Format</a>.</p>
</div>
<div class="section" id="ugrid">
<h5>UGRID<a class="headerlink" href="#ugrid" title="Permalink to this headline">¶</a></h5>
<p id="id6"><a class="reference internal" href="index.html#ESMF.api.constants.FileFormat.UGRID" title="ESMF.api.constants.FileFormat.UGRID"><code class="xref py py-class docutils literal notranslate"><span class="pre">UGRID</span></code></a> is an extension to the CF metadata
conventions for the unstructured grid data model.  ESMPy support
NetCDF files that follow the CF <a class="reference internal" href="index.html#ESMF.api.constants.FileFormat.UGRID" title="ESMF.api.constants.FileFormat.UGRID"><code class="xref py py-class docutils literal notranslate"><span class="pre">UGRID</span></code></a> convention for unstructured grids.
More information can be found in the ESMF reference manual section on
the <a class="reference external" href="http://www.earthsystemmodeling.org/esmf_releases/public/ESMF_8_0_1/ESMF_refdoc/node3.html#SECTION03028400000000000000">CF Convention UGRID File Format</a>.</p>
</div>
</div>
<div class="section" id="meshes-from-file">
<h4>Meshes from File<a class="headerlink" href="#meshes-from-file" title="Permalink to this headline">¶</a></h4>
<p>When creating a <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> from a <a class="reference internal" href="index.html#ESMF.api.constants.FileFormat.SCRIP" title="ESMF.api.constants.FileFormat.SCRIP"><code class="xref py py-class docutils literal notranslate"><span class="pre">SCRIP</span></code></a> format file, there are a number of
options to control the output <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>. The data is located at the center
of the grid cell in a <a class="reference internal" href="index.html#ESMF.api.constants.FileFormat.SCRIP" title="ESMF.api.constants.FileFormat.SCRIP"><code class="xref py py-class docutils literal notranslate"><span class="pre">SCRIP</span></code></a> grid. Therefore, when the <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> will be
part of a conservative regridding operation, the <code class="docutils literal notranslate"><span class="pre">convert_to_dual</span></code>
flag must be set to True to properly generate coordinates at the the
cell corners.</p>
<p>A <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> may also be created with boolean flags to specify whether or not to
add an area property to the <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> <code class="docutils literal notranslate"><span class="pre">add_user_area</span></code>, or to add a mask
<code class="docutils literal notranslate"><span class="pre">add_mask</span></code> held by the NetCDF variable indicated in the optional argument,
<code class="docutils literal notranslate"><span class="pre">varname</span></code>.  These argument are only valid for <a class="reference internal" href="index.html#ESMF.api.constants.FileFormat.UGRID" title="ESMF.api.constants.FileFormat.UGRID"><code class="xref py py-class docutils literal notranslate"><span class="pre">UGRID</span></code></a> formatted files.
The mask generated for a <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> created from file will
have 0 for the masked values and 1 for the unmasked values.</p>
</div>
<div class="section" id="grids-from-file">
<h4>Grids from File<a class="headerlink" href="#grids-from-file" title="Permalink to this headline">¶</a></h4>
<p>A number of optional boolean arguments are also supported to create a
structured <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> from a file.  These include <code class="docutils literal notranslate"><span class="pre">is_sphere</span></code> to indicate whether
the grid is spherical or regional, <code class="docutils literal notranslate"><span class="pre">add_corner_stagger</span></code> to add the corner
stagger information to the <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> for conservative regridding, and
<code class="docutils literal notranslate"><span class="pre">add_user_area</span></code> to specify whether to read in the cell area from the
NetCDF file or to calculate them.</p>
<p>For <a class="reference internal" href="index.html#ESMF.api.constants.FileFormat.GRIDSPEC" title="ESMF.api.constants.FileFormat.GRIDSPEC"><code class="xref py py-class docutils literal notranslate"><span class="pre">GRIDSPEC</span></code></a> formated files
there is the <code class="docutils literal notranslate"><span class="pre">add_mask</span></code> optional argument
to add a mask held by the NetCDF variable indicated in optional
argument, <code class="docutils literal notranslate"><span class="pre">varname</span></code>, and the <code class="docutils literal notranslate"><span class="pre">coord_names</span></code> argument to specify the longitude
and latitude variable names in a <a class="reference internal" href="index.html#ESMF.api.constants.FileFormat.GRIDSPEC" title="ESMF.api.constants.FileFormat.GRIDSPEC"><code class="xref py py-class docutils literal notranslate"><span class="pre">GRIDSPEC</span></code></a> file containing multiple sets of
coordinates.</p>
<p>For <a class="reference internal" href="index.html#ESMF.api.constants.FileFormat.SCRIP" title="ESMF.api.constants.FileFormat.SCRIP"><code class="xref py py-class docutils literal notranslate"><span class="pre">SCRIP</span></code></a> formated files the integer array <code class="docutils literal notranslate"><span class="pre">grid_imask</span></code> is used to mask out grid cells which should not participate in the regridding.</p>
<p>The mask generated for a <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> created from
file (any format) will have 0 for the masked values and 1 for the unmasked values.</p>
</div>
</div>
<div class="section" id="regridding">
<h3>Regridding<a class="headerlink" href="#regridding" title="Permalink to this headline">¶</a></h3>
<p>The following table describe the regridding methods and options that are
available in ESMPy, the flag that is required to use it, a short description,
and an ESMF documentation reference.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 19%" />
<col style="width: 60%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Class</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Link</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#ESMF.api.constants.RegridMethod.BILINEAR" title="ESMF.api.constants.RegridMethod.BILINEAR"><code class="xref py py-class docutils literal notranslate"><span class="pre">BILINEAR</span></code></a></p></td>
<td><p>Linear regridding in two dimensions</p></td>
<td><p><a class="reference external" href="http://www.earthsystemmodeling.org/esmf_releases/public/ESMF_8_0_1/ESMF_refdoc/node5.html#SECTION05012100000000000000">Bilinear</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#ESMF.api.constants.RegridMethod.PATCH" title="ESMF.api.constants.RegridMethod.PATCH"><code class="xref py py-class docutils literal notranslate"><span class="pre">PATCH</span></code></a></p></td>
<td><p>Higher-order least squares method</p></td>
<td><p><a class="reference external" href="http://www.earthsystemmodeling.org/esmf_releases/public/ESMF_8_0_1/ESMF_refdoc/node5.html#SECTION05012200000000000000">Higher-order patch</a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#ESMF.api.constants.RegridMethod.NEAREST_STOD" title="ESMF.api.constants.RegridMethod.NEAREST_STOD"><code class="xref py py-class docutils literal notranslate"><span class="pre">NEAREST_STOD</span></code></a></p></td>
<td><p>Nearest source point used for each destination</p></td>
<td><p><a class="reference external" href="http://www.earthsystemmodeling.org/esmf_releases/public/ESMF_8_0_1/ESMF_refdoc/node5.html#SECTION05012300000000000000">Nearest source to destination</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#ESMF.api.constants.RegridMethod.NEAREST_DTOS" title="ESMF.api.constants.RegridMethod.NEAREST_DTOS"><code class="xref py py-class docutils literal notranslate"><span class="pre">NEAREST_DTOS</span></code></a></p></td>
<td><p>Nearest destination point used for each source</p></td>
<td><p><a class="reference external" href="http://www.earthsystemmodeling.org/esmf_releases/public/ESMF_8_0_1/ESMF_refdoc/node5.html#SECTION05012400000000000000">Nearest destination to source</a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#ESMF.api.constants.RegridMethod.CONSERVE" title="ESMF.api.constants.RegridMethod.CONSERVE"><code class="xref py py-class docutils literal notranslate"><span class="pre">CONSERVE</span></code></a></p></td>
<td><p>First-order conservative</p></td>
<td><p><a class="reference external" href="http://www.earthsystemmodeling.org/esmf_releases/public/ESMF_8_0_1/ESMF_refdoc/node5.html#SECTION05012500000000000000">First-order conservative</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#ESMF.api.constants.RegridMethod.CONSERVE_2ND" title="ESMF.api.constants.RegridMethod.CONSERVE_2ND"><code class="xref py py-class docutils literal notranslate"><span class="pre">CONSERVE_2ND</span></code></a></p></td>
<td><p>Second-order conservative</p></td>
<td><p><a class="reference external" href="http://www.earthsystemmodeling.org/esmf_releases/public/ESMF_8_0_1/ESMF_refdoc/node5.html#SECTION05012600000000000000">Second-order conservative</a></p></td>
</tr>
<tr class="row-even"><td><p>See conservative options above.</p></td>
<td><p>Conservation equations</p></td>
<td><p><a class="reference external" href="http://www.earthsystemmodeling.org/esmf_releases/public/ESMF_8_0_1/ESMF_refdoc/node5.html#SECTION05012700000000000000">Conservation</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#ESMF.api.constants.NormType" title="ESMF.api.constants.NormType"><code class="xref py py-class docutils literal notranslate"><span class="pre">NormType</span></code></a></p></td>
<td><p>Normalization options for integral conservation</p></td>
<td><p><a class="reference external" href="http://www.earthsystemmodeling.org/esmf_releases/public/ESMF_8_0_1/ESMF_refdoc/node5.html#SECTION05012800000000000000">Normalization options</a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#ESMF.api.constants.LineType" title="ESMF.api.constants.LineType"><code class="xref py py-class docutils literal notranslate"><span class="pre">LineType</span></code></a></p></td>
<td><p>Line types for spherical and Cartesian space</p></td>
<td><p><a class="reference external" href="http://www.earthsystemmodeling.org/esmf_releases/public/ESMF_8_0_1/ESMF_refdoc/node5.html#SECTION05012900000000000000">Great circle cells</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#ESMF.api.constants.UnmappedAction" title="ESMF.api.constants.UnmappedAction"><code class="xref py py-class docutils literal notranslate"><span class="pre">UnmappedAction</span></code></a></p></td>
<td><p>Unmapped destination point handling options</p></td>
<td><p><a class="reference external" href="http://www.earthsystemmodeling.org/esmf_releases/public/ESMF_8_0_1/ESMF_refdoc/node5.html#SECTION050121500000000000000">Unmapped destination points</a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#ESMF.api.constants.CoordSys" title="ESMF.api.constants.CoordSys"><code class="xref py py-class docutils literal notranslate"><span class="pre">CoordSys</span></code></a></p></td>
<td><p>Spherical grids and pole handling</p></td>
<td><p><a class="reference external" href="http://www.earthsystemmodeling.org/esmf_releases/public/ESMF_8_0_1/ESMF_refdoc/node5.html#SECTION050121600000000000000">Spherical grids and poles</a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id7">
<h3>Masking<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<p id="id8">Masking is the process whereby parts of a <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>, <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> or <a class="reference internal" href="index.html#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStream</span></code></a> can be marked to be ignored
during an operation, such as when they are used in regridding. Masking can be used on a <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a>
created from a regridding source to indicate that certain portions should not be used to generate
regridded data. This is useful, for example, if a portion of the source contains unusable values.
Masking can also be used on a <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> created from a regridding destination to indicate that a certain
portion should not receive regridded data. This is useful, for example, when part of the destination
isn’t being used (e.g. the land portion of an ocean grid).</p>
<p>The user may mask out points in the source <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> or destination <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> or both. To do masking the user
sets mask information in the <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>, <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>, or <a class="reference internal" href="index.html#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStream</span></code></a> upon
which the <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Fields</span></code></a> passed into the <a class="reference internal" href="index.html#ESMF.api.regrid.Regrid" title="ESMF.api.regrid.Regrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Regrid</span></code></a> call are built. The <code class="docutils literal notranslate"><span class="pre">src_mask_values</span></code> and
<code class="docutils literal notranslate"><span class="pre">dst_mask_values</span></code> arguments to that call can then be used to specify which values in that mask information
indicate that a location should be masked out. For example, if <code class="docutils literal notranslate"><span class="pre">dst_mask_values</span></code> is set to [1,2], then any
location that has a value of 1 or 2 in the mask information of the <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>, <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> or <a class="reference internal" href="index.html#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStream</span></code></a> upon which
the destination <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> is built will be masked out.</p>
<p>Masking behavior differs slightly between regridding methods. For non-conservative regridding methods
(e.g. bilinear or high-order patch), masking is done on points. For these methods, masking a destination
point means that the point will not participate in regridding. For these
methods, masking a source point means that the entire source cell using that point is masked out.
In other words, if any corner point making up a source cell is masked then the cell is masked.
For conservative regridding methods masking is done on cells.
Masking a destination cell means that the cell won’t participate in regridding.
Similarly, masking a source cell means that the cell won’t participate in regridding.
For any type of interpolation method (conservative or non-conservative)
the masking is set on the location upon which the
<a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Fields</span></code></a> passed into the regridding call are built.
For example, if <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Fields</span></code></a> built on
<a class="reference internal" href="index.html#ESMF.api.constants.StaggerLoc.CENTER" title="ESMF.api.constants.StaggerLoc.CENTER"><code class="xref py py-class docutils literal notranslate"><span class="pre">StaggerLoc.CENTER</span></code></a> are passed into
<a class="reference internal" href="index.html#ESMF.api.regrid.Regrid" title="ESMF.api.regrid.Regrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Regrid</span></code></a>
then the masking should also be set on <a class="reference internal" href="index.html#ESMF.api.constants.StaggerLoc.CENTER" title="ESMF.api.constants.StaggerLoc.CENTER"><code class="xref py py-class docutils literal notranslate"><span class="pre">StaggerLoc.CENTER</span></code></a>.</p>
<p>The mask generated for a <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>,
<a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> or <a class="reference internal" href="index.html#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStream</span></code></a> created
from file will have 0 for the masked values and 1 for the unmasked values.</p>
</div>
<div class="section" id="numpy-slicing-and-indexing">
<h3>Numpy Slicing and Indexing<a class="headerlink" href="#numpy-slicing-and-indexing" title="Permalink to this headline">¶</a></h3>
<p>Numpy arrays are used to represent <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>, <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> and <a class="reference internal" href="index.html#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStream</span></code></a> coordinates and <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> data,
among other things.  Standard numpy conventions for array indexing
and slicing can be expected.  There are some exceptions when it comes to fancy
indexing, index arrays, and multi-dimensional slicing.  Significant effort has
been put into raising exceptions where inappropriate indexing or slicing
operations are attempted.</p>
<p>It is very important to remember that all indexing
and slicing operations apply <strong>ONLY</strong> to the ESMPy level objects, and these operations
do not propagate down to the lower-level Fortran- and C-based representations
of the ESMF objects.  One example of where this could come up is when passing
a <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> slice into regridding.  The entire original <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> will still be run
through the ESMF regridding engine, and only the appropriate portion of
the <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> slice will be updated with the regridded values.</p>
<div class="section" id="dimension-ordering">
<h4>Dimension Ordering<a class="headerlink" href="#dimension-ordering" title="Permalink to this headline">¶</a></h4>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The underlying ESMF library is built with a mix of Fortran and C/C++
and follows Fortran conventions with respect to array indexing and
dimension ordering. Some effort has been made to make ESMPy feel more
natural to the Python user where possible. This means that ESMPy uses
0-based indexing, which is translated to the 1-based indexing used by
the ESMPy backend. However, the dimension ordering still follows
Fortran conventions. Namely, longitude comes before latitude, which
also comes before temporal dimensions when in use.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
   <span class="o">...</span><span class="p">:</span> <span class="kn">import</span> <span class="nn">ESMF</span>
   <span class="o">...</span><span class="p">:</span>
   <span class="o">...</span><span class="p">:</span> <span class="n">grid</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Grid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span> <span class="n">staggerloc</span><span class="o">=</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">)</span>
   <span class="o">...</span><span class="p">:</span>
   <span class="o">...</span><span class="p">:</span> <span class="n">gridLon</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">get_coords</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
   <span class="o">...</span><span class="p">:</span> <span class="n">gridLat</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">get_coords</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
   <span class="o">...</span><span class="p">:</span>
   <span class="o">...</span><span class="p">:</span> <span class="n">lon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">120</span><span class="p">,</span><span class="mi">120</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
   <span class="o">...</span><span class="p">:</span> <span class="n">lat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">67.5</span><span class="p">,</span> <span class="mf">67.5</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
   <span class="o">...</span><span class="p">:</span>
   <span class="o">...</span><span class="p">:</span> <span class="n">lonm</span><span class="p">,</span> <span class="n">latm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">indexing</span><span class="o">=</span><span class="s1">&#39;ij&#39;</span><span class="p">)</span>
   <span class="o">...</span><span class="p">:</span>
   <span class="o">...</span><span class="p">:</span> <span class="n">gridLon</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">lonm</span>
   <span class="o">...</span><span class="p">:</span> <span class="n">gridLat</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">latm</span>
   <span class="o">...</span><span class="p">:</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">grid</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">lon</span><span class="o">.</span><span class="n">shape</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="p">(</span><span class="mi">3</span><span class="p">,)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">lat</span><span class="o">.</span><span class="n">shape</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="p">(</span><span class="mi">4</span><span class="p">,)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">grid</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">120.</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.</span><span class="p">],</span>
       <span class="p">[</span>   <span class="mf">0.</span><span class="p">,</span>    <span class="mf">0.</span><span class="p">,</span>    <span class="mf">0.</span><span class="p">,</span>    <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">120.</span><span class="p">,</span>  <span class="mf">120.</span><span class="p">,</span>  <span class="mf">120.</span><span class="p">,</span>  <span class="mf">120.</span><span class="p">]])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="n">grid</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">ESMF</span><span class="o">.</span><span class="n">StaggerLoc</span><span class="o">.</span><span class="n">CENTER</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">67.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">22.5</span><span class="p">,</span>  <span class="mf">22.5</span><span class="p">,</span>  <span class="mf">67.5</span><span class="p">],</span>
       <span class="p">[</span><span class="o">-</span><span class="mf">67.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">22.5</span><span class="p">,</span>  <span class="mf">22.5</span><span class="p">,</span>  <span class="mf">67.5</span><span class="p">],</span>
       <span class="p">[</span><span class="o">-</span><span class="mf">67.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">22.5</span><span class="p">,</span>  <span class="mf">22.5</span><span class="p">,</span>  <span class="mf">67.5</span><span class="p">]])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">7</span><span class="p">]:</span> <span class="n">field</span> <span class="o">=</span> <span class="n">ESMF</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">ndbounds</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">])</span> <span class="c1"># create a Field with a time dimension</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">8</span><span class="p">]:</span> <span class="n">field</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">8</span><span class="p">]:</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-execution">
<h3>Parallel Execution<a class="headerlink" href="#parallel-execution" title="Permalink to this headline">¶</a></h3>
<p>ESMPy is a thin wrapper on top of ESMF, which was designed for high performance
and scalable computing. The ESMF virtual machine is used to manage the available
resources of the execution environment in a layer that is transparent to the
ESMPy user. This allows the full power of the high performance computing
environment to be utilized by the ESMPy user with little use of specialized
parallel programming techniques.</p>
<p>ESMPy objects will be distributed across the available computing resources with
no additional parameters required. The <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>, <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>, <a class="reference internal" href="index.html#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStream</span></code></a>, and <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> classes
will all be transparently “parallelized” with no need for user calls to a
message passing interface. Likewise, the <a class="reference internal" href="index.html#ESMF.api.regrid.Regrid" title="ESMF.api.regrid.Regrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Regrid</span></code></a> class will compute and apply
the interpolation weights using all available computing resources with no need
for user intervention.</p>
<p>However, it is useful to remember that resulting <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> values will only be
accessible on certain PETs. The mpi4py package may be necessary for post
processing tasks that require access to global <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> values.</p>
<div class="section" id="mpirun-vs-mpi-spawn">
<h4>mpirun vs. MPI.Spawn<a class="headerlink" href="#mpirun-vs-mpi-spawn" title="Permalink to this headline">¶</a></h4>
<p>There are a few different options for using ESMPy in a parallel
environment. Using mpirun to specify the desired number of computing cores
is probably the easiest way to start a parallel ESMPy job. Another option is to
call the MPI.Spawn() function from the mpi4py Python package from within a
serial Python script or interpreter. It has been observed that MPI.Spawn() may
not work properly when mpi4py is built with an underlying mpich
library, openmpi has seen better success. A third option is to call mpirun
using a system call from within a serial Python script or interpreter, however
this method is not highly recommended.</p>
<p>The following two examples demonstrate how to execute an ESMPy script in
parallel. Any of the scripts found in the examples directory of the ESMPy source
code can be run in parallel using mpirun as well as in serial mode.</p>
<div class="section" id="mpirun">
<h5>mpirun<a class="headerlink" href="#mpirun" title="Permalink to this headline">¶</a></h5>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mpirun</span> <span class="o">-</span><span class="n">n</span> <span class="mi">4</span> <span class="n">python</span> <span class="n">hello_world</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
</div>
<div class="section" id="mpi-spawn">
<h5>MPI.Spawn<a class="headerlink" href="#mpi-spawn" title="Permalink to this headline">¶</a></h5>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">mpi4py</span> <span class="kn">import</span> <span class="n">MPI</span>

<span class="c1"># Parent</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>

    <span class="c1"># Spawn workers</span>
    <span class="n">comm</span> <span class="o">=</span> <span class="n">MPI</span><span class="o">.</span><span class="n">COMM_WORLD</span><span class="o">.</span><span class="n">Spawn</span><span class="p">(</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">executable</span><span class="p">,</span>
        <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;worker&#39;</span><span class="p">],</span>
        <span class="n">maxprocs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

    <span class="c1"># Shutdown</span>
    <span class="n">comm</span><span class="o">.</span><span class="n">Disconnect</span><span class="p">()</span>

<span class="c1"># Worker</span>
<span class="k">elif</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;worker&#39;</span><span class="p">:</span>

    <span class="c1"># Connect to parent</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">comm</span> <span class="o">=</span> <span class="n">MPI</span><span class="o">.</span><span class="n">Comm</span><span class="o">.</span><span class="n">Get_parent</span><span class="p">()</span>
        <span class="n">rank</span> <span class="o">=</span> <span class="n">comm</span><span class="o">.</span><span class="n">Get_rank</span><span class="p">()</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Could not connect to parent - &#39;</span> <span class="o">+</span> <span class="n">usage</span><span class="p">)</span>

    <span class="c1"># worker code goes here, regridding etc..</span>
    <span class="nb">print</span> <span class="s2">&quot;Hello World from PET #&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">rank</span><span class="p">)</span>

    <span class="c1"># Shutdown</span>
    <span class="n">comm</span><span class="o">.</span><span class="n">Disconnect</span><span class="p">()</span>

<span class="c1"># Catch</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Program should be started without arguments&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>A more detailed example of using MPI.Spawn() can be found in the Tutorials section
of the documentation.</p>
</div>
</div>
</div>
</div>
<span id="document-appendix"></span><div class="section" id="appendices">
<h2>Appendices<a class="headerlink" href="#appendices" title="Permalink to this headline">¶</a></h2>
<div class="section" id="class-apis">
<h3>Class APIs<a class="headerlink" href="#class-apis" title="Permalink to this headline">¶</a></h3>
<div class="toctree-wrapper compound">
<span id="document-manager"></span><div class="section" id="manager">
<h4>Manager<a class="headerlink" href="#manager" title="Permalink to this headline">¶</a></h4>
<dl class="py class">
<dt id="ESMF.api.esmpymanager.Manager">
<em class="property">class </em><code class="sig-prename descclassname">ESMF.api.esmpymanager.</code><code class="sig-name descname">Manager</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">debug</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ESMF.api.esmpymanager.Manager" title="Permalink to this definition">¶</a></dt>
<dd><p>This singleton class is designed to ensure that ESMF is properly initialized 
and finalized.  ESMF is initialized at 
<a class="reference internal" href="#ESMF.api.esmpymanager.Manager" title="ESMF.api.esmpymanager.Manager"><code class="xref py py-class docutils literal notranslate"><span class="pre">Manager</span></code></a> creation, and the __del__ 
method is registered with atexit to ensure ESMF is always finalized prior to 
exiting Python.  If the object is copied, the copy will always be an alias 
to the original <a class="reference internal" href="#ESMF.api.esmpymanager.Manager" title="ESMF.api.esmpymanager.Manager"><code class="xref py py-class docutils literal notranslate"><span class="pre">Manager</span></code></a> object.  The 
<a class="reference internal" href="#ESMF.api.esmpymanager.Manager" title="ESMF.api.esmpymanager.Manager"><code class="xref py py-class docutils literal notranslate"><span class="pre">Manager</span></code></a> will be created when the first 
ESMPy object is created if it is not created explicitly by the user.</p>
<p>Explicit creation of a <a class="reference internal" href="#ESMF.api.esmpymanager.Manager" title="ESMF.api.esmpymanager.Manager"><code class="xref py py-class docutils literal notranslate"><span class="pre">Manager</span></code></a> object allows
for setting a flag which 
results in the output of debug information from the ESMF logging capability 
during the application runtime.  The output log files are named 
PET&lt;PET number&gt;.ESMF_LogFile.</p>
<p>The PET rank (local_pet) and total number of PETs (pet_count) 
can also be retrieved from the <a class="reference internal" href="#ESMF.api.esmpymanager.Manager" title="ESMF.api.esmpymanager.Manager"><code class="xref py py-class docutils literal notranslate"><span class="pre">Manager</span></code></a> 
using the following calls:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ESMF</span><span class="o">.</span><span class="n">local_pet</span><span class="p">()</span>
<span class="n">ESMF</span><span class="o">.</span><span class="n">pet_count</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">local_pet</span></code> and <code class="docutils literal notranslate"><span class="pre">pet_count</span></code> are also properties of the 
<a class="reference internal" href="#ESMF.api.esmpymanager.Manager" title="ESMF.api.esmpymanager.Manager"><code class="xref py py-class docutils literal notranslate"><span class="pre">Manager</span></code></a>.</p>
<p>Calls ESMP_Initialize and registers __del__ with atexit when called the
first time.  Subsequent calls only return whether or not ESMF is
initialized.  Registering __del__ with atexit ensures the ESMP_Finalize
will always be called prior to exiting Python.  Calling __init__
explicitly results in a no-op.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>debug</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – outputs logging information to ESMF logfiles. If
<code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to False.</p>
</dd>
</dl>
</dd></dl>

</div>
<span id="document-field"></span><div class="section" id="field">
<h4>Field<a class="headerlink" href="#field" title="Permalink to this headline">¶</a></h4>
<dl class="py class">
<dt id="ESMF.api.field.Field">
<em class="property">class </em><code class="sig-prename descclassname">ESMF.api.field.</code><code class="sig-name descname">Field</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">grid</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">typekind</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">staggerloc</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">meshloc</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ndbounds</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ESMF.api.field.Field" title="Permalink to this definition">¶</a></dt>
<dd><p>The <a class="reference internal" href="#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> class is a Python wrapper object for the ESMF Field.
The individual values of all data arrays are referenced to those of the
underlying Fortran ESMF object.</p>
<p>A <a class="reference internal" href="#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> represents a physical field, such as temperature.   The <a class="reference internal" href="#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> class
contains distributed and discretized field data, a reference to its
associated grid, and metadata. The <a class="reference internal" href="#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> class stores the grid staggering
for that physical field. This is the relationship of how the data array of
a field maps onto a grid (e.g. one item per cell located at the cell center,
one item per cell located at the NW corner, one item per cell vertex, etc.).
This means that different <a class="reference internal" href="#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Fields</span></code></a> which are on the same underlying <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> but
have different staggerings can share the same <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> object without needing to
replicate it multiple times.</p>
<p>For more information about the ESMF Field class, please see the <a class="reference external" href="http://www.earthsystemmodeling.org/esmf_releases/public/ESMF_7_1_0r/ESMF_refdoc/node5.html#SECTION05030000000000000000">ESMF Field documentation</a>.</p>
<p>The following parameters are used to create a <a class="reference internal" href="#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a>
from a <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>, <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> or
<a class="reference internal" href="index.html#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStream</span></code></a>.</p>
<p><em>REQUIRED:</em></p>
<dl class="simple">
<dt>:param <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>/Mesh/<a class="reference internal" href="index.html#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStream</span></code></a> grid: A <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>,</dt><dd><p><a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> or <a class="reference internal" href="index.html#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStream</span></code></a>
with coordinates allocated on at least one stagger location.</p>
</dd>
</dl>
<p><em>OPTIONAL:</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – An optional user friendly name for the
<a class="reference internal" href="#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a>.</p></li>
<li><p><strong>typekind</strong> (<a class="reference internal" href="index.html#ESMF.api.constants.TypeKind" title="ESMF.api.constants.TypeKind"><em>TypeKind</em></a>) – Type of the <a class="reference internal" href="#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a>
data. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to <a class="reference internal" href="index.html#ESMF.api.constants.TypeKind.R8" title="ESMF.api.constants.TypeKind.R8"><code class="xref py py-attr docutils literal notranslate"><span class="pre">R8</span></code></a>.</p></li>
<li><p><strong>staggerloc</strong> (<a class="reference internal" href="index.html#ESMF.api.constants.StaggerLoc" title="ESMF.api.constants.StaggerLoc"><em>StaggerLoc</em></a>) – The stagger location of the
<a class="reference internal" href="#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> data, only specify this argument when
using a <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to <a class="reference internal" href="index.html#ESMF.api.constants.StaggerLoc.CENTER" title="ESMF.api.constants.StaggerLoc.CENTER"><code class="xref py py-attr docutils literal notranslate"><span class="pre">CENTER</span></code></a>
in 2D and <a class="reference internal" href="index.html#ESMF.api.constants.StaggerLoc.CENTER_VCENTER" title="ESMF.api.constants.StaggerLoc.CENTER_VCENTER"><code class="xref py py-attr docutils literal notranslate"><span class="pre">CENTER_VCENTER</span></code></a> in 3D.</p></li>
<li><p><strong>meshloc</strong> (<a class="reference internal" href="index.html#ESMF.api.constants.MeshLoc" title="ESMF.api.constants.MeshLoc"><em>MeshLoc</em></a>) – The mesh location of the
<a class="reference internal" href="#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> data, only specify this argument when
using a <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>
if <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to <a class="reference internal" href="index.html#ESMF.api.constants.MeshLoc.NODE" title="ESMF.api.constants.MeshLoc.NODE"><code class="xref py py-attr docutils literal notranslate"><span class="pre">NODE</span></code></a>.</p></li>
<li><p><strong>ndbounds</strong> (<em>tuple</em>) – The number of entries in an extra
<a class="reference internal" href="#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> dimension. This is represented as a
single value, a list or a tuple containing the number of entries for
each desired extra dimension of the <a class="reference internal" href="#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a>. The
time dimension must be last, following Fortran indexing conventions.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="ESMF.api.field.Field.data">
<em class="property">property </em><code class="sig-name descname">data</code><a class="headerlink" href="#ESMF.api.field.Field.data" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="index.html#ESMF.api.constants.TypeKind" title="ESMF.api.constants.TypeKind"><code class="xref py py-attr docutils literal notranslate"><span class="pre">TypeKind</span></code></a></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The data of the <a class="reference internal" href="#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.field.Field.grid">
<em class="property">property </em><code class="sig-name descname">grid</code><a class="headerlink" href="#ESMF.api.field.Field.grid" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>, <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>, or
<a class="reference internal" href="index.html#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStream</span></code></a></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The discretization object upon which the
<a class="reference internal" href="#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> is built.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.field.Field.lower_bounds">
<em class="property">property </em><code class="sig-name descname">lower_bounds</code><a class="headerlink" href="#ESMF.api.field.Field.lower_bounds" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The lower bounds of the <a class="reference internal" href="#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.field.Field.name">
<em class="property">property </em><code class="sig-name descname">name</code><a class="headerlink" href="#ESMF.api.field.Field.name" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)">str</a></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the name of the <a class="reference internal" href="#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.field.Field.ndbounds">
<em class="property">property </em><code class="sig-name descname">ndbounds</code><a class="headerlink" href="#ESMF.api.field.Field.ndbounds" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The bounds of the extra dimensions in the
<a class="reference internal" href="#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.field.Field.rank">
<em class="property">property </em><code class="sig-name descname">rank</code><a class="headerlink" href="#ESMF.api.field.Field.rank" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)">int</a></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The rank of the <a class="reference internal" href="#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.field.Field.staggerloc">
<em class="property">property </em><code class="sig-name descname">staggerloc</code><a class="headerlink" href="#ESMF.api.field.Field.staggerloc" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="index.html#ESMF.api.constants.StaggerLoc" title="ESMF.api.constants.StaggerLoc"><code class="xref py py-attr docutils literal notranslate"><span class="pre">StaggerLoc</span></code></a> or
<a class="reference internal" href="index.html#ESMF.api.constants.MeshLoc" title="ESMF.api.constants.MeshLoc"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MeshLoc</span></code></a></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The location upon which the <a class="reference internal" href="#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a>
is built.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.field.Field.type">
<em class="property">property </em><code class="sig-name descname">type</code><a class="headerlink" href="#ESMF.api.field.Field.type" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="index.html#ESMF.api.constants.TypeKind" title="ESMF.api.constants.TypeKind"><code class="xref py py-attr docutils literal notranslate"><span class="pre">TypeKind</span></code></a></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The type of the data in the <a class="reference internal" href="#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.field.Field.upper_bounds">
<em class="property">property </em><code class="sig-name descname">upper_bounds</code><a class="headerlink" href="#ESMF.api.field.Field.upper_bounds" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The upper bounds of the <a class="reference internal" href="#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.field.Field.xd">
<em class="property">property </em><code class="sig-name descname">xd</code><a class="headerlink" href="#ESMF.api.field.Field.xd" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)">int</a></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The number of extra (ungridded) dimensions of the
<a class="reference internal" href="#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.field.Field.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ESMF.api.field.Field.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy a <a class="reference internal" href="#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> in an ESMF-safe manner.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A <a class="reference internal" href="#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> shallow copy.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.field.Field.destroy">
<code class="sig-name descname">destroy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ESMF.api.field.Field.destroy" title="Permalink to this definition">¶</a></dt>
<dd><p>Release the memory associated with a <a class="reference internal" href="#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.field.Field.get_area">
<code class="sig-name descname">get_area</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ESMF.api.field.Field.get_area" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize an existing <a class="reference internal" href="#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> with the areas of
the cells of the underlying <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> or
<a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.field.Field.read">
<code class="sig-name descname">read</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">variable</span></em>, <em class="sig-param"><span class="n">timeslice</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ESMF.api.field.Field.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read data into an existing <a class="reference internal" href="#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> from a
CF-compliant NetCDF file.</p>
<dl class="field-list simple">
<dt class="field-odd">Note</dt>
<dd class="field-odd"><p>This interface is not supported when ESMF is built with
<code class="docutils literal notranslate"><span class="pre">ESMF_COMM=mpiuni</span></code>.</p>
</dd>
<dt class="field-even">Note</dt>
<dd class="field-even"><p>This interface does not currently support reading ungridded 
dimensions.</p>
</dd>
</dl>
<p><em>REQUIRED:</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The name of the NetCDF file.</p></li>
<li><p><strong>variable</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The name of the data variable to read from file.</p></li>
</ul>
</dd>
</dl>
<p><em>OPTIONAL:</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>timeslice</strong> (<em>list</em>) – The number of timeslices to read.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<span id="document-grid"></span><div class="section" id="grid">
<h4>Grid<a class="headerlink" href="#grid" title="Permalink to this headline">¶</a></h4>
<dl class="py class">
<dt id="ESMF.api.grid.Grid">
<em class="property">class </em><code class="sig-prename descclassname">ESMF.api.grid.</code><code class="sig-name descname">Grid</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">max_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">num_peri_dims</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">periodic_dim</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pole_dim</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">coord_sys</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">coord_typekind</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">staggerloc</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pole_kind</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">filetype</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">reg_decomp</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">decompflag</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">is_sphere</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">add_corner_stagger</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">add_user_area</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">add_mask</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">varname</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">coord_names</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tilesize</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">regDecompPTile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ESMF.api.grid.Grid" title="Permalink to this definition">¶</a></dt>
<dd><p>The <a class="reference internal" href="#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> class is a Python wrapper object for the ESMF Grid.  The individual 
values of all coordinate and mask arrays are referenced to those of the
underlying Fortran ESMF object.</p>
<p>The <a class="reference internal" href="#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> class is used to describe the geometry and
discretization of logically rectangular physical grids.  It also contains
the description of the underlying topology and decomposition of the physical
grid across the available computational resources. The most frequent use of
the <a class="reference internal" href="#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> class is to describe physical grids in user
code so that sufficient information is available to perform regridding
operations.</p>
<p>For more information about the ESMF Grid class, please see the 
<a class="reference external" href="http://www.earthsystemmodeling.org/esmf_releases/public/ESMF_7_1_0r/ESMF_refdoc/node5.html#SECTION05080000000000000000">ESMF Grid documentation</a>.</p>
<p>A <a class="reference internal" href="#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> can be created in two different ways, as a
<a class="reference internal" href="#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> in memory, or from SCRIP formatted or CF compliant GRIDSPEC file. The
arguments for each type of <a class="reference internal" href="#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> creation are
outlined below.</p>
<p><strong>Created in-memory:</strong></p>
<p><em>REQUIRED:</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>max_index</strong> (<em>list</em>) – An integer list of length 2 or 3, with the
number of grid cells in each dimension.</p>
</dd>
</dl>
<p><em>OPTIONAL:</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_peri_dims</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The number of periodic dimensions, either <code class="docutils literal notranslate"><span class="pre">0</span></code>
or <code class="docutils literal notranslate"><span class="pre">1</span></code>. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p></li>
<li><p><strong>periodic_dim</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The periodic dimension: <code class="docutils literal notranslate"><span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">1</span></code> or <code class="docutils literal notranslate"><span class="pre">2</span></code>.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p></li>
<li><p><strong>pole_dim</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The pole dimension <code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code>.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p></li>
<li><p><strong>coord_sys</strong> (<a class="reference internal" href="index.html#ESMF.api.constants.CoordSys" title="ESMF.api.constants.CoordSys"><em>CoordSys</em></a>) – Coordinate system for the
<a class="reference internal" href="#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to <a class="reference internal" href="index.html#ESMF.api.constants.CoordSys.SPH_DEG" title="ESMF.api.constants.CoordSys.SPH_DEG"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SPH_DEG</span></code></a>.</p></li>
<li><p><strong>coord_typekind</strong> (<a class="reference internal" href="index.html#ESMF.api.constants.TypeKind" title="ESMF.api.constants.TypeKind"><em>TypeKind</em></a>) – Type of the <a class="reference internal" href="#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>
coordinates.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to <a class="reference internal" href="index.html#ESMF.api.constants.TypeKind.R8" title="ESMF.api.constants.TypeKind.R8"><code class="xref py py-attr docutils literal notranslate"><span class="pre">R8</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<p><strong>Created either from file or in-memory:</strong></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>staggerloc</strong> (<a class="reference internal" href="index.html#ESMF.api.constants.StaggerLoc" title="ESMF.api.constants.StaggerLoc"><em>StaggerLoc</em></a>) – The stagger location of the coordinate values.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to <a class="reference internal" href="index.html#ESMF.api.constants.StaggerLoc.CENTER" title="ESMF.api.constants.StaggerLoc.CENTER"><code class="xref py py-attr docutils literal notranslate"><span class="pre">CENTER</span></code></a>
in 2D and <a class="reference internal" href="index.html#ESMF.api.constants.StaggerLoc.CENTER_VCENTER" title="ESMF.api.constants.StaggerLoc.CENTER_VCENTER"><code class="xref py py-attr docutils literal notranslate"><span class="pre">CENTER_VCENTER</span></code></a> in 3D.</p></li>
<li><p><strong>pole_kind</strong> (<a class="reference internal" href="index.html#ESMF.api.constants.PoleKind" title="ESMF.api.constants.PoleKind"><em>PoleKind</em></a>) – Two item list which specifies the type of
connection which occurs at the pole. The first value specifies the
connection that occurs at the minimum end of the pole dimension. 
The second value specifies the connection that occurs at the maximum 
end of the pole dimension.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to <a class="reference internal" href="index.html#ESMF.api.constants.PoleKind.MONOPOLE" title="ESMF.api.constants.PoleKind.MONOPOLE"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MONOPOLE</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<p><strong>Created from file:</strong></p>
<p><em>REQUIRED:</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The name of the NetCDF grid file.</p></li>
<li><p><strong>filetype</strong> (<a class="reference internal" href="index.html#ESMF.api.constants.FileFormat" title="ESMF.api.constants.FileFormat"><em>FileFormat</em></a>) – The grid <a class="reference internal" href="index.html#ESMF.api.constants.FileFormat" title="ESMF.api.constants.FileFormat"><code class="xref py py-attr docutils literal notranslate"><span class="pre">FileFormat</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<p><em>OPTIONAL:</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>is_sphere</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Set to <code class="docutils literal notranslate"><span class="pre">True</span></code> for a spherical grid, or <code class="docutils literal notranslate"><span class="pre">False</span></code>
for regional. Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>add_corner_stagger</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Set to <code class="docutils literal notranslate"><span class="pre">True</span></code> to use the information in
the grid file to add the corner stagger to the grid. The coordinates for
the corner stagger are required for conservative regridding. If
not specified, defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>add_user_area</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Set to <code class="docutils literal notranslate"><span class="pre">True</span></code> to read in the cell area from the
grid file; otherwise, ESMF will calculate it. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>add_mask</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Set to <code class="docutils literal notranslate"><span class="pre">True</span></code> to generate the mask using the
<code class="docutils literal notranslate"><span class="pre">missing_value</span></code> attribute defined in <code class="docutils literal notranslate"><span class="pre">varname</span></code>.  This argument is
only supported with filetype
<a class="reference internal" href="index.html#ESMF.api.constants.FileFormat.GRIDSPEC" title="ESMF.api.constants.FileFormat.GRIDSPEC"><code class="xref py py-attr docutils literal notranslate"><span class="pre">GRIDSPEC</span></code></a>.
Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>varname</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – If add_mask is <code class="docutils literal notranslate"><span class="pre">True</span></code>, provide a variable name stored
in the grid file and the mask will be generated using the missing value
of the data value of this variable.  The first two dimensions of the
variable has to be the longitude and the latitude dimension and the
mask is derived from the first 2D values of this variable even if this
data is a 3D, or 4D array. This argument is only supported with
filetype <a class="reference internal" href="index.html#ESMF.api.constants.FileFormat.GRIDSPEC" title="ESMF.api.constants.FileFormat.GRIDSPEC"><code class="xref py py-attr docutils literal notranslate"><span class="pre">GRIDSPEC</span></code></a>.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>coord_names</strong> (<em>list</em>) – A two-element array containing the longitude and
latitude variable names in a GRIDSPEC file if there are multiple
coordinates defined in the file. This argument is only supported with
filetype <a class="reference internal" href="index.html#ESMF.api.constants.FileFormat.GRIDSPEC" title="ESMF.api.constants.FileFormat.GRIDSPEC"><code class="xref py py-attr docutils literal notranslate"><span class="pre">GRIDSPEC</span></code></a>.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
</dl>
<p><strong>Cubed sphere:</strong></p>
<p><em>REQUIRED:</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tilesize</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The number of elements on each side of the tile of the
cubed sphere grid.</p>
</dd>
</dl>
<p><em>OPTIONAL:</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>regDecompPTile</strong> (<em>list</em>) – List of DE counts for each dimension. The second index steps through
the tiles. The total deCount is determined as the sum over
the products of regDecompPTile elements for each tile.
By default every tile is decomposed in the same way.  If the total
PET count is less than 6, one tile will be assigned to one DE and the DEs
will be assigned to PETs sequentially, therefore, some PETs may have
more than one DE. If the total PET count is greater than 6, the total
number of DEs will be a multiple of 6 and less than or equal to the total
PET count. For instance, if the total PET count is 16, the total DE count
will be 12 with each tile decomposed into 1x2 blocks. The 12 DEs are mapped
to the first 12 PETs and the remaining 4 PETs have no DEs locally.</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The name of the <a class="reference internal" href="#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="ESMF.api.grid.Grid.area">
<em class="property">property </em><code class="sig-name descname">area</code><a class="headerlink" href="#ESMF.api.grid.Grid.area" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>A list of numpy arrays with an entry for every stagger location
of the <a class="reference internal" href="#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The <a class="reference internal" href="#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> cell areas represented as
numpy arrays of floats of size given by
<code class="docutils literal notranslate"><span class="pre">upper_bounds</span> <span class="pre">-</span> <span class="pre">lower_bounds</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.grid.Grid.areatype">
<em class="property">property </em><code class="sig-name descname">areatype</code><a class="headerlink" href="#ESMF.api.grid.Grid.areatype" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="index.html#ESMF.api.constants.TypeKind" title="ESMF.api.constants.TypeKind"><code class="xref py py-attr docutils literal notranslate"><span class="pre">TypeKind</span></code></a></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The ESMF typekind of the <a class="reference internal" href="#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> cell
areas.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.grid.Grid.coords">
<em class="property">property </em><code class="sig-name descname">coords</code><a class="headerlink" href="#ESMF.api.grid.Grid.coords" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2D list of numpy arrays of size given by
<code class="docutils literal notranslate"><span class="pre">upper_bounds</span> <span class="pre">-</span> <span class="pre">lower_bounds</span></code>, where the first index represents
the stagger locations of the <a class="reference internal" href="#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> and the
second index represent the coordinate dimensions of the
<a class="reference internal" href="#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The coordinates of the <a class="reference internal" href="#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.grid.Grid.coord_sys">
<em class="property">property </em><code class="sig-name descname">coord_sys</code><a class="headerlink" href="#ESMF.api.grid.Grid.coord_sys" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="index.html#ESMF.api.constants.CoordSys" title="ESMF.api.constants.CoordSys"><code class="xref py py-attr docutils literal notranslate"><span class="pre">CoordSys</span></code></a></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The coordinate system of the <a class="reference internal" href="#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.grid.Grid.has_corners">
<em class="property">property </em><code class="sig-name descname">has_corners</code><a class="headerlink" href="#ESMF.api.grid.Grid.has_corners" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)">bool</a></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A boolean value to tell if the <a class="reference internal" href="#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>
has corners allocated.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.grid.Grid.lower_bounds">
<em class="property">property </em><code class="sig-name descname">lower_bounds</code><a class="headerlink" href="#ESMF.api.grid.Grid.lower_bounds" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>A list of numpy arrays with an entry for every stagger location
of the <a class="reference internal" href="#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The lower bounds of the <a class="reference internal" href="#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>
represented as numpy arrays of ints of size given by
<code class="docutils literal notranslate"><span class="pre">upper_bounds</span> <span class="pre">-</span> <span class="pre">lower_bounds</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.grid.Grid.mask">
<em class="property">property </em><code class="sig-name descname">mask</code><a class="headerlink" href="#ESMF.api.grid.Grid.mask" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>A list of numpy arrays with an entry for every stagger location
of the <a class="reference internal" href="#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The mask of the <a class="reference internal" href="#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> represented as
numpy arrays of ints of size given by `
<cite>upper_bounds - lower_bounds`</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.grid.Grid.max_index">
<em class="property">property </em><code class="sig-name descname">max_index</code><a class="headerlink" href="#ESMF.api.grid.Grid.max_index" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>A numpy array with as many values as the
<a class="reference internal" href="#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> rank.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The number of <a class="reference internal" href="#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> cells in each
dimension of the grid.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.grid.Grid.num_peri_dims">
<em class="property">property </em><code class="sig-name descname">num_peri_dims</code><a class="headerlink" href="#ESMF.api.grid.Grid.num_peri_dims" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)">int</a></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The total number of periodic dimensions in the
<a class="reference internal" href="#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.grid.Grid.periodic_dim">
<em class="property">property </em><code class="sig-name descname">periodic_dim</code><a class="headerlink" href="#ESMF.api.grid.Grid.periodic_dim" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)">int</a></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The periodic dimension of the <a class="reference internal" href="#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>
(e.g. <code class="docutils literal notranslate"><span class="pre">0</span></code> for <code class="docutils literal notranslate"><span class="pre">x</span></code> or <code class="docutils literal notranslate"><span class="pre">longitude</span></code>, <code class="docutils literal notranslate"><span class="pre">1</span></code> for <code class="docutils literal notranslate"><span class="pre">y</span></code> or
<code class="docutils literal notranslate"><span class="pre">latitude</span></code>, etc.).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.grid.Grid.pole_dim">
<em class="property">property </em><code class="sig-name descname">pole_dim</code><a class="headerlink" href="#ESMF.api.grid.Grid.pole_dim" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)">int</a></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The pole dimension of the <a class="reference internal" href="#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>
(e.g. <code class="docutils literal notranslate"><span class="pre">0</span></code> for <code class="docutils literal notranslate"><span class="pre">x</span></code> or <code class="docutils literal notranslate"><span class="pre">longitude</span></code>, <code class="docutils literal notranslate"><span class="pre">1</span></code> for <code class="docutils literal notranslate"><span class="pre">y</span></code> or
<code class="docutils literal notranslate"><span class="pre">latitude</span></code>, etc.).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.grid.Grid.rank">
<em class="property">property </em><code class="sig-name descname">rank</code><a class="headerlink" href="#ESMF.api.grid.Grid.rank" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)">int</a></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The rank of the <a class="reference internal" href="#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.grid.Grid.size">
<em class="property">property </em><code class="sig-name descname">size</code><a class="headerlink" href="#ESMF.api.grid.Grid.size" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>A list of numpy arrays with an entry for every stagger location
of the <a class="reference internal" href="#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The size of the <a class="reference internal" href="#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> represented as
numpy arrays of ints of size given by
<code class="docutils literal notranslate"><span class="pre">upper_bounds</span> <span class="pre">-</span> <span class="pre">lower_bounds</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.grid.Grid.staggerloc">
<em class="property">property </em><code class="sig-name descname">staggerloc</code><a class="headerlink" href="#ESMF.api.grid.Grid.staggerloc" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of bools</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The stagger locations that have been allocated for the
<a class="reference internal" href="#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.grid.Grid.type">
<em class="property">property </em><code class="sig-name descname">type</code><a class="headerlink" href="#ESMF.api.grid.Grid.type" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="index.html#ESMF.api.constants.TypeKind" title="ESMF.api.constants.TypeKind"><code class="xref py py-attr docutils literal notranslate"><span class="pre">TypeKind</span></code></a></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The ESMF typekind of the <a class="reference internal" href="#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>
coordinates.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.grid.Grid.upper_bounds">
<em class="property">property </em><code class="sig-name descname">upper_bounds</code><a class="headerlink" href="#ESMF.api.grid.Grid.upper_bounds" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>A list of numpy arrays with an entry for every stagger location
of the <a class="reference internal" href="#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The upper bounds of the <a class="reference internal" href="#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>
represented as numpy arrays of ints of size given by
<code class="docutils literal notranslate"><span class="pre">upper_bounds</span> <span class="pre">-</span> <span class="pre">lower_bounds</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.grid.Grid.add_coords">
<code class="sig-name descname">add_coords</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">staggerloc</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">coord_dim</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">from_file</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ESMF.api.grid.Grid.add_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Add coordinates to the <a class="reference internal" href="#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> at the specified
stagger location.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>staggerloc</strong> (<a class="reference internal" href="index.html#ESMF.api.constants.StaggerLoc" title="ESMF.api.constants.StaggerLoc"><em>StaggerLoc</em></a>) – The stagger location of the coordinate
values. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to
<a class="reference internal" href="index.html#ESMF.api.constants.StaggerLoc.CENTER" title="ESMF.api.constants.StaggerLoc.CENTER"><code class="xref py py-attr docutils literal notranslate"><span class="pre">CENTER</span></code></a>
in 2D and <a class="reference internal" href="index.html#ESMF.api.constants.StaggerLoc.CENTER_VCENTER" title="ESMF.api.constants.StaggerLoc.CENTER_VCENTER"><code class="xref py py-attr docutils literal notranslate"><span class="pre">CENTER_VCENTER</span></code></a> in
3D.</p></li>
<li><p><strong>coord_dim</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The dimension number of the coordinates to return
e.g. <code class="docutils literal notranslate"><span class="pre">[x,</span> <span class="pre">y,</span> <span class="pre">z]</span> <span class="pre">=</span> <span class="pre">(0,</span> <span class="pre">1,</span> <span class="pre">2)</span></code>, or <code class="docutils literal notranslate"><span class="pre">[lon,</span> <span class="pre">lat]</span> <span class="pre">=</span> <span class="pre">(0,</span> <span class="pre">1)</span></code>
(coordinates will not be returned if coord_dim is not specified and
staggerlocs is a list with more than one element).</p></li>
<li><p><strong>from_file</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Boolean for internal use to determine whether the
<a class="reference internal" href="#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> has already been created from file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A numpy array of coordinate values if staggerloc and
coord_dim are specified, otherwise return None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.grid.Grid.add_item">
<code class="sig-name descname">add_item</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">item</span></em>, <em class="sig-param"><span class="n">staggerloc</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">from_file</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ESMF.api.grid.Grid.add_item" title="Permalink to this definition">¶</a></dt>
<dd><p>Allocate space for a <a class="reference internal" href="#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> item (mask or areas)
at a specified stagger location.</p>
<p><em>REQUIRED:</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>item</strong> (<a class="reference internal" href="index.html#ESMF.api.constants.GridItem" title="ESMF.api.constants.GridItem"><em>GridItem</em></a>) – The <a class="reference internal" href="index.html#ESMF.api.constants.GridItem" title="ESMF.api.constants.GridItem"><code class="xref py py-attr docutils literal notranslate"><span class="pre">GridItem</span></code></a> to
allocate.</p>
</dd>
</dl>
<p><em>OPTIONAL:</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>staggerloc</strong> (<a class="reference internal" href="index.html#ESMF.api.constants.StaggerLoc" title="ESMF.api.constants.StaggerLoc"><em>StaggerLoc</em></a>) – The stagger location of the item
values. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to
<a class="reference internal" href="index.html#ESMF.api.constants.StaggerLoc.CENTER" title="ESMF.api.constants.StaggerLoc.CENTER"><code class="xref py py-attr docutils literal notranslate"><span class="pre">CENTER</span></code></a>
in 2D and <a class="reference internal" href="index.html#ESMF.api.constants.StaggerLoc.CENTER_VCENTER" title="ESMF.api.constants.StaggerLoc.CENTER_VCENTER"><code class="xref py py-attr docutils literal notranslate"><span class="pre">CENTER_VCENTER</span></code></a> in
3D.</p></li>
<li><p><strong>from_file</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Boolean for internal use to determine whether the
<a class="reference internal" href="#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> has already been created from file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A numpy array of the mask or area values if a single
staggerloc is given, otherwise return None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.grid.Grid.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ESMF.api.grid.Grid.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy a <a class="reference internal" href="#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> in an ESMF-safe manner.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A <a class="reference internal" href="#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> shallow copy.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.grid.Grid.destroy">
<code class="sig-name descname">destroy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ESMF.api.grid.Grid.destroy" title="Permalink to this definition">¶</a></dt>
<dd><p>Release the memory associated with a <a class="reference internal" href="#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.grid.Grid.get_coords">
<code class="sig-name descname">get_coords</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">coord_dim</span></em>, <em class="sig-param"><span class="n">staggerloc</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ESMF.api.grid.Grid.get_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a numpy array of coordinates at a specified stagger 
location. The returned array is NOT a copy, it is
directly aliased to the underlying memory allocated by ESMF.</p>
<p><em>REQUIRED:</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>coord_dim</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The dimension number of the coordinates to return
e.g. <code class="docutils literal notranslate"><span class="pre">[x,</span> <span class="pre">y,</span> <span class="pre">z]</span> <span class="pre">=</span> <span class="pre">(0,</span> <span class="pre">1,</span> <span class="pre">2)</span></code>, or <code class="docutils literal notranslate"><span class="pre">[lon,</span> <span class="pre">lat]</span> <span class="pre">=</span> <span class="pre">(0,</span> <span class="pre">1)</span></code>
(coordinates will not be returned if <code class="docutils literal notranslate"><span class="pre">coord_dim</span></code> is not specified
and <code class="docutils literal notranslate"><span class="pre">staggerlocs</span></code> is a list with more than one element).</p>
</dd>
</dl>
<p><em>OPTIONAL:</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>staggerloc</strong> (<a class="reference internal" href="index.html#ESMF.api.constants.StaggerLoc" title="ESMF.api.constants.StaggerLoc"><em>StaggerLoc</em></a>) – The stagger location of the coordinate
values. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to
<a class="reference internal" href="index.html#ESMF.api.constants.StaggerLoc.CENTER" title="ESMF.api.constants.StaggerLoc.CENTER"><code class="xref py py-attr docutils literal notranslate"><span class="pre">CENTER</span></code></a>
in 2D and <a class="reference internal" href="index.html#ESMF.api.constants.StaggerLoc.CENTER_VCENTER" title="ESMF.api.constants.StaggerLoc.CENTER_VCENTER"><code class="xref py py-attr docutils literal notranslate"><span class="pre">CENTER_VCENTER</span></code></a> in
3D.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A numpy array of coordinate values at the specified staggerloc.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.grid.Grid.get_item">
<code class="sig-name descname">get_item</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">item</span></em>, <em class="sig-param"><span class="n">staggerloc</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ESMF.api.grid.Grid.get_item" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a numpy array of item values at a specified stagger
location.  The returned array is NOT a copy, it is
directly aliased to the underlying memory allocated by ESMF.</p>
<p><em>REQUIRED:</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>item</strong> (<a class="reference internal" href="index.html#ESMF.api.constants.GridItem" title="ESMF.api.constants.GridItem"><em>GridItem</em></a>) – The <a class="reference internal" href="index.html#ESMF.api.constants.GridItem" title="ESMF.api.constants.GridItem"><code class="xref py py-attr docutils literal notranslate"><span class="pre">GridItem</span></code></a> to
return.</p>
</dd>
</dl>
<p><em>OPTIONAL:</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>staggerloc</strong> (<a class="reference internal" href="index.html#ESMF.api.constants.StaggerLoc" title="ESMF.api.constants.StaggerLoc"><em>StaggerLoc</em></a>) – The stagger location of the item
values. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to
<a class="reference internal" href="index.html#ESMF.api.constants.StaggerLoc.CENTER" title="ESMF.api.constants.StaggerLoc.CENTER"><code class="xref py py-attr docutils literal notranslate"><span class="pre">CENTER</span></code></a> in 2D and
<a class="reference internal" href="index.html#ESMF.api.constants.StaggerLoc.CENTER_VCENTER" title="ESMF.api.constants.StaggerLoc.CENTER_VCENTER"><code class="xref py py-attr docutils literal notranslate"><span class="pre">CENTER_VCENTER</span></code></a> in 3D.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A numpy array of mask or area values at the specified staggerloc.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<span id="document-mesh"></span><div class="section" id="mesh">
<h4>Mesh<a class="headerlink" href="#mesh" title="Permalink to this headline">¶</a></h4>
<dl class="py class">
<dt id="ESMF.api.mesh.Mesh">
<em class="property">class </em><code class="sig-prename descclassname">ESMF.api.mesh.</code><code class="sig-name descname">Mesh</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">parametric_dim</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">spatial_dim</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">coord_sys</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">filetype</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">convert_to_dual</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">add_user_area</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">meshname</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">mask_flag</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">varname</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ESMF.api.mesh.Mesh" title="Permalink to this definition">¶</a></dt>
<dd><p>The <a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> class is a Python wrapper object for the ESMF Mesh.
The individual values of all coordinate and mask arrays are referenced to
those of the underlying Fortran ESMF object.</p>
<p>The ESMF library provides a class for representing unstructured grids called
the <a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>. <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Fields</span></code></a> can be created on a <a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> to hold data. <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Fields</span></code></a> created on a
<a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> can also be used as either the source or destination or both of a
regrididng operation which allows data to be moved between unstructured
grids.  A <a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> is constructed of nodes and elements. A node, also known as
a vertex or corner, is a part of a <a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> which represents a single point.
Coordinate information is set in a node. An element, also known as a cell,
is a part of a mesh which represents a small region of space. Elements are
described in terms of a connected set of nodes which represent locations
along their boundaries. <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> data may be located on either the nodes or
elements of a <a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>.</p>
<p>For more information about the ESMF Mesh class, please see the <a class="reference external" href="http://www.earthsystemmodeling.org/esmf_releases/public/ESMF_7_1_0r/ESMF_refdoc/node5.html#SECTION050100000000000000000">ESMF Mesh
documentation</a>.</p>
<p>An unstructured <a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> can be created in two different ways, as a <a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> in
memory, or from a SCRIP formatted or CF compliant UGRID file. The arguments
for each type of <a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> creation are outlined below.</p>
<p><strong>Created in-memory:</strong></p>
<dl class="simple">
<dt>The in-memory <a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> can be created manually in 3 steps:</dt><dd><ol class="arabic simple">
<li><p>create the <a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> (specifying <code class="docutils literal notranslate"><span class="pre">parametric_dim</span></code> and <code class="docutils literal notranslate"><span class="pre">spatial_dim</span></code>),</p></li>
<li><p>add nodes,</p></li>
<li><p>add elements.</p></li>
</ol>
</dd>
</dl>
<p><em>REQUIRED:</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parametric_dim</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – the dimension of the topology of the
<a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> (e.g. a <a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> composed of squares would have a
parametric dimension of 2 and a <a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> composed of cubes
would have a parametric dimension of 3).</p></li>
<li><p><strong>spatial_dim</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – the number of coordinate dimensions
needed to describe the locations of the nodes making up the
<a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>.  For a manifold the spatial dimension can be larger
than the parametric dimension (e.g. the 2D surface of a
sphere in 3D space), but it cannot be smaller.</p></li>
</ul>
</dd>
</dl>
<p><em>OPTIONAL:</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>coord_sys</strong> (<a class="reference internal" href="index.html#ESMF.api.constants.CoordSys" title="ESMF.api.constants.CoordSys"><em>CoordSys</em></a>) – Coordinate system for the
<a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to <a class="reference internal" href="index.html#ESMF.api.constants.CoordSys.SPH_DEG" title="ESMF.api.constants.CoordSys.SPH_DEG"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SPH_DEG</span></code></a>.</p>
</dd>
</dl>
<p><strong>Created from file:</strong></p>
<p>Note that <a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Meshes</span></code></a> created from file do not use the <code class="docutils literal notranslate"><span class="pre">parametric_dim</span></code> and
<code class="docutils literal notranslate"><span class="pre">spatial_dim</span></code> parameters.</p>
<p><em>REQUIRED:</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – the name of NetCDF file containing the <a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>.</p></li>
<li><p><strong>filetype</strong> (<a class="reference internal" href="index.html#ESMF.api.constants.FileFormat" title="ESMF.api.constants.FileFormat"><em>FileFormat</em></a>) – the input
<a class="reference internal" href="index.html#ESMF.api.constants.FileFormat" title="ESMF.api.constants.FileFormat"><code class="xref py py-attr docutils literal notranslate"><span class="pre">FileFormat</span></code></a> of the <a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<p><em>OPTIONAL:</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>convert_to_dual</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – a boolean value to specify if the
dual <a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> should be calculated.  Defaults to False.  This
argument is only supported with
<a class="reference internal" href="index.html#ESMF.api.constants.FileFormat.SCRIP" title="ESMF.api.constants.FileFormat.SCRIP"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SCRIP</span></code></a>.</p></li>
<li><p><strong>add_user_area</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – a boolean value to specify if an area
property should be added to the mesh.  This argument is only
supported for <a class="reference internal" href="index.html#ESMF.api.constants.FileFormat.SCRIP" title="ESMF.api.constants.FileFormat.SCRIP"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SCRIP</span></code></a>
or <a class="reference internal" href="index.html#ESMF.api.constants.FileFormat.ESMFMESH" title="ESMF.api.constants.FileFormat.ESMFMESH"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ESMFMESH</span></code></a>.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to False.</p></li>
<li><p><strong>meshname</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – the name of the <a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> metadata variable in
a UGRID file.  This argument is only supported with
<a class="reference internal" href="index.html#ESMF.api.constants.FileFormat.UGRID" title="ESMF.api.constants.FileFormat.UGRID"><code class="xref py py-attr docutils literal notranslate"><span class="pre">UGRID</span></code></a>.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to the empty string.</p></li>
<li><p><strong>mask_flag</strong> (<a class="reference internal" href="index.html#ESMF.api.constants.MeshLoc" title="ESMF.api.constants.MeshLoc"><em>MeshLoc</em></a>) – an enumerated integer that, if
specified, tells whether a mask in a UGRID file should be
defined on the <code class="xref py py-attr docutils literal notranslate"><span class="pre">Mesh</span></code>.
This argument is only supported with
<a class="reference internal" href="index.html#ESMF.api.constants.FileFormat.UGRID" title="ESMF.api.constants.FileFormat.UGRID"><code class="xref py py-attr docutils literal notranslate"><span class="pre">UGRID</span></code></a>.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to no masking.</p></li>
<li><p><strong>varname</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – a variable name for the mask in a UGRID file
if mask_flag is specified.  This argument is only supported
for <a class="reference internal" href="index.html#ESMF.api.constants.FileFormat.UGRID" title="ESMF.api.constants.FileFormat.UGRID"><code class="xref py py-attr docutils literal notranslate"><span class="pre">UGRID</span></code></a>.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to the empty string.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="ESMF.api.mesh.Mesh.area">
<em class="property">property </em><code class="sig-name descname">area</code><a class="headerlink" href="#ESMF.api.mesh.Mesh.area" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>A two element list of numpy arrays to hold values for the nodes
and elements of the <a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The <a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> area represented as a numpy
array of floats of the same number of entries as <a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> elements.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.mesh.Mesh.coords">
<em class="property">property </em><code class="sig-name descname">coords</code><a class="headerlink" href="#ESMF.api.mesh.Mesh.coords" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>A two element list of numpy arrays to hold values for the nodes
and elements of the <a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The coordinates represented as a numpy array of floats
with a value for each node and/or element of the <a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>
<a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.mesh.Mesh.coord_sys">
<em class="property">property </em><code class="sig-name descname">coord_sys</code><a class="headerlink" href="#ESMF.api.mesh.Mesh.coord_sys" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="index.html#ESMF.api.constants.CoordSys" title="ESMF.api.constants.CoordSys"><code class="xref py py-attr docutils literal notranslate"><span class="pre">CoordSys</span></code></a></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The coordinate system of the <a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.mesh.Mesh.mask">
<em class="property">property </em><code class="sig-name descname">mask</code><a class="headerlink" href="#ESMF.api.mesh.Mesh.mask" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>A two element list of numpy arrays to hold values for the nodes
and elements of the <a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The masked values on the nodes and elements of the
<a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.mesh.Mesh.rank">
<em class="property">property </em><code class="sig-name descname">rank</code><a class="headerlink" href="#ESMF.api.mesh.Mesh.rank" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)">int</a></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The rank of the Mesh, (i.e. always 1).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.mesh.Mesh.size">
<em class="property">property </em><code class="sig-name descname">size</code><a class="headerlink" href="#ESMF.api.mesh.Mesh.size" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>A two element list of integers.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The number of nodes and elements in the <a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> on the current
processor.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.mesh.Mesh.size_owned">
<em class="property">property </em><code class="sig-name descname">size_owned</code><a class="headerlink" href="#ESMF.api.mesh.Mesh.size_owned" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>A two element list of integers.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The number of owned nodes and elements in the <a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> on the
current processor.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.mesh.Mesh.add_elements">
<code class="sig-name descname">add_elements</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">element_count</span></em>, <em class="sig-param"><span class="n">element_ids</span></em>, <em class="sig-param"><span class="n">element_types</span></em>, <em class="sig-param"><span class="n">element_conn</span></em>, <em class="sig-param"><span class="n">element_mask</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">element_area</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">element_coords</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ESMF.api.mesh.Mesh.add_elements" title="Permalink to this definition">¶</a></dt>
<dd><p>Add elements to a <a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>, this must be done after adding nodes.</p>
<p><em>REQUIRED:</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>element_count</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – the number of elements to add to the <a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>.</p></li>
<li><p><strong>element_ids</strong> (<em>ndarray</em>) – a numpy array of of shape
<code class="docutils literal notranslate"><span class="pre">(element_count,</span> <span class="pre">1)</span></code> to specify the element ids.</p></li>
<li><p><strong>element_types</strong> (<em>ndarray</em>) – a numpy array of
<code class="xref py py-attr docutils literal notranslate"><span class="pre">MeshElemType`s</span> <span class="pre">of</span> <span class="pre">shape</span>
<span class="pre">``(element_count,</span> <span class="pre">1)`</span></code> to specify the element types.</p></li>
<li><p><strong>element_conn</strong> (<em>ndarray</em>) – a numpy array of shape
<code class="docutils literal notranslate"><span class="pre">sum(element_types[:],</span> <span class="pre">1)</span></code> to specify the connectivity of the
<a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>. The connectivity array is constructed by concatenating the
tuples that correspond to the element_ids. The connectivity tuples
are constructed by listing the node_ids of each element in
<strong>COUNTERCLOCKWISE</strong> order.</p></li>
</ul>
</dd>
</dl>
<p><em>OPTIONAL:</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>element_mask</strong> (<em>ndarray</em>) – a numpy array of shape
<code class="docutils literal notranslate"><span class="pre">(element_count,</span> <span class="pre">1)</span></code> containing integer values to specify masked
elements. The specific values that are masked are specified in the
<a class="reference internal" href="index.html#ESMF.api.regrid.Regrid" title="ESMF.api.regrid.Regrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Regrid</span></code></a> constructor.</p></li>
<li><p><strong>element_area</strong> (<em>ndarray</em>) – a numpy array of shape
<code class="docutils literal notranslate"><span class="pre">(element_count,</span> <span class="pre">1)</span></code> to specify the areas of the elements.</p></li>
<li><p><strong>element_coords</strong> (<em>ndarray</em>) – a numpy array of shape
<code class="docutils literal notranslate"><span class="pre">(element_count,</span> <span class="pre">1)</span></code> to specify the coordinates of the elements.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.mesh.Mesh.add_nodes">
<code class="sig-name descname">add_nodes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">node_count</span></em>, <em class="sig-param"><span class="n">node_ids</span></em>, <em class="sig-param"><span class="n">node_coords</span></em>, <em class="sig-param"><span class="n">node_owners</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ESMF.api.mesh.Mesh.add_nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Add nodes to a <a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>, this must be done before adding elements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>node_count</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – the number of nodes to add to the <a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>.</p></li>
<li><p><strong>node_ids</strong> (<em>ndarray</em>) – a numpy array of shape (node_count, 1) to
specify the node_ids.</p></li>
<li><p><strong>node_coords</strong> (<em>ndarray</em>) – a numpy array of shape
(spatial_dim*node_count, 1) to specify the coordinates of the <a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>.
The array should be constructed by concatenating the coordinate
tuples into a numpy array that correspond to node_ids.</p></li>
<li><p><strong>node_owners</strong> (<em>ndarray</em>) – a numpy array of shape (node_count, 1) to
specify the rank of the processor that owns each node.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.mesh.Mesh.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ESMF.api.mesh.Mesh.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy a <a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> in an ESMF-safe manner.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A <a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> shallow copy.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.mesh.Mesh.destroy">
<code class="sig-name descname">destroy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ESMF.api.mesh.Mesh.destroy" title="Permalink to this definition">¶</a></dt>
<dd><p>Release the memory associated with a <a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.mesh.Mesh.free_memory">
<code class="sig-name descname">free_memory</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ESMF.api.mesh.Mesh.free_memory" title="Permalink to this definition">¶</a></dt>
<dd><p>Free memory associated with the creation of a
<a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> which is no longer needed for ongoing
operations.</p>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.mesh.Mesh.get_coords">
<code class="sig-name descname">get_coords</code><span class="sig-paren">(</span><em class="sig-param">coord_dim</em>, <em class="sig-param">meshloc=&lt;MeshLoc.NODE: 0&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#ESMF.api.mesh.Mesh.get_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a numpy array of coordinates at a specified <a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> 
location (coordinates can only be returned for the <a class="reference internal" href="#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>
<a class="reference internal" href="index.html#ESMF.api.constants.MeshLoc.NODE" title="ESMF.api.constants.MeshLoc.NODE"><code class="xref py py-attr docutils literal notranslate"><span class="pre">NODE</span></code></a>s
at this time). The returned array is NOT a copy, it is
directly aliased to the underlying memory allocated by ESMF.</p>
<p><em>REQUIRED:</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>coord_dim</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – the dimension number of the coordinates to return:
e.g. <code class="docutils literal notranslate"><span class="pre">[x,</span> <span class="pre">y,</span> <span class="pre">z]</span> <span class="pre">=</span> <span class="pre">(0,</span> <span class="pre">1,</span> <span class="pre">2)</span></code>, or <code class="docutils literal notranslate"><span class="pre">[lat,</span> <span class="pre">lon]</span> <span class="pre">=</span> <span class="pre">(0,</span> <span class="pre">1)</span></code></p>
</dd>
</dl>
<p><em>OPTIONAL:</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meshloc</strong> (<a class="reference internal" href="index.html#ESMF.api.constants.MeshLoc" title="ESMF.api.constants.MeshLoc"><em>MeshLoc</em></a>) – the <a class="reference internal" href="index.html#ESMF.api.constants.MeshLoc" title="ESMF.api.constants.MeshLoc"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MeshLoc</span></code></a> of the
coordinates.  If <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to
<a class="reference internal" href="index.html#ESMF.api.constants.MeshLoc.NODE" title="ESMF.api.constants.MeshLoc.NODE"><code class="xref py py-attr docutils literal notranslate"><span class="pre">NODE</span></code></a>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A numpy array of coordinate values at the specified
<a class="reference internal" href="index.html#ESMF.api.constants.MeshLoc" title="ESMF.api.constants.MeshLoc"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MeshLoc</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<span id="document-locstream"></span><div class="section" id="locstream">
<h4>LocStream<a class="headerlink" href="#locstream" title="Permalink to this headline">¶</a></h4>
<dl class="py class">
<dt id="ESMF.api.locstream.LocStream">
<em class="property">class </em><code class="sig-prename descclassname">ESMF.api.locstream.</code><code class="sig-name descname">LocStream</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">location_count</span></em>, <em class="sig-param"><span class="n">coord_sys</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">esmf</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ESMF.api.locstream.LocStream" title="Permalink to this definition">¶</a></dt>
<dd><p>The <a class="reference internal" href="#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStream</span></code></a> class is a Python wrapper object for the ESMF LocStream.
<a class="reference internal" href="#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStream</span></code></a> is a derived type of a Python dictionary.</p>
<p>The individual values of all key arrays are referenced to those of the
underlying Fortran ESMF object.</p>
<p>A <a class="reference internal" href="#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStream</span></code></a> is used to represent the locations of a
set of data points. The values of the data points are stored within a
<a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> created using the <a class="reference internal" href="#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStream</span></code></a>.</p>
<p>In the data assimilation world, location streams can be thought of as a set
of observations. Their locations are generally described using Cartesian
<code class="docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y,</span> <span class="pre">z)</span></code>, or <code class="docutils literal notranslate"><span class="pre">(lat,</span> <span class="pre">lon,</span> <span class="pre">height)</span></code> coordinates. There is no assumption
of any regularity in the positions of the points. To make the concept more
general, the locations for each data point are represented using a construct
called keys. Keys can include other descriptors besides location, including
a second set of coordinates.</p>
<p>For more information about the ESMF LocStream class, please see the
<a class="reference external" href="http://www.earthsystemmodeling.org/esmf_releases/public/ESMF_7_1_0r/ESMF_refdoc/node5.html#SECTION05090000000000000000">ESMF LocStream documentation</a>.</p>
<p><a class="reference internal" href="#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStream</span></code></a> follows standard dictionary syntax. For example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">locstream</span><span class="p">[</span><span class="s2">&quot;ESMF:X&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">locstream</span><span class="p">[</span><span class="s2">&quot;ESMF:X&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locstream</span><span class="p">[</span><span class="s2">&quot;ESMF:Y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">locstream</span><span class="p">[</span><span class="s2">&quot;ESMF:Y&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locstream</span><span class="p">[</span><span class="s2">&quot;ESMF:Mask&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">locstream</span><span class="p">[</span><span class="s2">&quot;ESMF:Mask&quot;</span><span class="p">]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Setting keys of lists of mixed types can result in errors due to
type mismatches from the ESMF library.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Mask must be of type <a class="reference internal" href="index.html#ESMF.api.constants.TypeKind.I4" title="ESMF.api.constants.TypeKind.I4"><code class="xref py py-attr docutils literal notranslate"><span class="pre">I4</span></code></a>,
and coordinates must by of type <a class="reference internal" href="index.html#ESMF.api.constants.TypeKind.R8" title="ESMF.api.constants.TypeKind.R8"><code class="xref py py-attr docutils literal notranslate"><span class="pre">R8</span></code></a>.</p>
</div>
<p>For ESMF to be able to recognize coordinates specified in a <a class="reference internal" href="#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStream</span></code></a> key
they need to be named with the appropriate identifiers. The particular
identifiers depend on the coordinate system (i.e. <code class="docutils literal notranslate"><span class="pre">coord_sys</span></code> argument)
used to create the <a class="reference internal" href="#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStream</span></code></a>.</p>
<p>The valid values are:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 57%" />
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 14%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Coordinate System</p></th>
<th class="head"><p>dimension 1</p></th>
<th class="head"><p>dimension 2</p></th>
<th class="head"><p>dimension 3</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#ESMF.api.constants.CoordSys.SPH_DEG" title="ESMF.api.constants.CoordSys.SPH_DEG"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SPH_DEG</span></code></a></p></td>
<td><p>ESMF:Lon</p></td>
<td><p>ESMF:Lat</p></td>
<td><p>ESMF:Radius</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#ESMF.api.constants.CoordSys.SPH_RAD" title="ESMF.api.constants.CoordSys.SPH_RAD"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SPH_RAD</span></code></a></p></td>
<td><p>ESMF:Lon</p></td>
<td><p>ESMF:Lat</p></td>
<td><p>ESMF:Radius</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#ESMF.api.constants.CoordSys.CART" title="ESMF.api.constants.CoordSys.CART"><code class="xref py py-attr docutils literal notranslate"><span class="pre">CART</span></code></a></p></td>
<td><p>ESMF:X</p></td>
<td><p>ESMF:Y</p></td>
<td><p>ESMF:Z</p></td>
</tr>
</tbody>
</table>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>location_count</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The number of points in this stream.</p></li>
<li><p><strong>coord_sys</strong> (<a class="reference internal" href="index.html#ESMF.api.constants.CoordSys" title="ESMF.api.constants.CoordSys"><em>CoordSys</em></a>) – Coordinate system for the location stream.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to <a class="reference internal" href="index.html#ESMF.api.constants.CoordSys.SPH_DEG" title="ESMF.api.constants.CoordSys.SPH_DEG"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SPH_DEG</span></code></a>.</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Optional name for the location stream.</p></li>
<li><p><strong>esmf</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Internal parameter controlling shallow copying by ESMF.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="ESMF.api.locstream.LocStream.lower_bounds">
<em class="property">property </em><code class="sig-name descname">lower_bounds</code><a class="headerlink" href="#ESMF.api.locstream.LocStream.lower_bounds" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)">int</a></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The lower bounds of the <a class="reference internal" href="#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStream</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.locstream.LocStream.name">
<em class="property">property </em><code class="sig-name descname">name</code><a class="headerlink" href="#ESMF.api.locstream.LocStream.name" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)">str</a></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The name of the <a class="reference internal" href="#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStream</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.locstream.LocStream.rank">
<em class="property">property </em><code class="sig-name descname">rank</code><a class="headerlink" href="#ESMF.api.locstream.LocStream.rank" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)">int</a></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The rank of the <a class="reference internal" href="#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStream</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.locstream.LocStream.size">
<em class="property">property </em><code class="sig-name descname">size</code><a class="headerlink" href="#ESMF.api.locstream.LocStream.size" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)">int</a></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The size of the <a class="reference internal" href="#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStream</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.locstream.LocStream.upper_bounds">
<em class="property">property </em><code class="sig-name descname">upper_bounds</code><a class="headerlink" href="#ESMF.api.locstream.LocStream.upper_bounds" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)">int</a></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The upper bounds of the <a class="reference internal" href="#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStream</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.locstream.LocStream.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ESMF.api.locstream.LocStream.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy a <a class="reference internal" href="#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStream</span></code></a> in an ESMF-safe manner.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A <a class="reference internal" href="#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStream</span></code></a> shallow copy.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.locstream.LocStream.destroy">
<code class="sig-name descname">destroy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ESMF.api.locstream.LocStream.destroy" title="Permalink to this definition">¶</a></dt>
<dd><p>Release the memory associated with a
<a class="reference internal" href="#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStream</span></code></a>.</p>
</dd></dl>

</dd></dl>

</div>
<span id="document-regrid"></span><div class="section" id="regrid">
<h4>Regrid<a class="headerlink" href="#regrid" title="Permalink to this headline">¶</a></h4>
<dl class="py class">
<dt id="ESMF.api.regrid.Regrid">
<em class="property">class </em><code class="sig-prename descclassname">ESMF.api.regrid.</code><code class="sig-name descname">Regrid</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">srcfield</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dstfield</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">rh_filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">src_mask_values</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dst_mask_values</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">regrid_method</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pole_method</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">regrid_pole_npoints</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">line_type</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">norm_type</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">extrap_method</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">extrap_num_src_pnts</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">extrap_dist_exponent</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">unmapped_action</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ignore_degenerate</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">create_rh</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">filemode</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">src_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dst_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">src_file_type</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dst_file_type</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">src_frac_field</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dst_frac_field</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">factors</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ESMF.api.regrid.Regrid" title="Permalink to this definition">¶</a></dt>
<dd><p>The <a class="reference internal" href="#ESMF.api.regrid.Regrid" title="ESMF.api.regrid.Regrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Regrid</span></code></a> object represents a regridding operator between two <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Fields</span></code></a>.  The
creation of this object is analogous to ESMF_FieldRegridStore(), and
calling this object corresponds to ESMF_FieldRegrid().
ESMF_FieldRegridRelease() is called when the <a class="reference internal" href="#ESMF.api.regrid.Regrid" title="ESMF.api.regrid.Regrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Regrid</span></code></a> object goes out of
scope (this only happens when the <a class="reference internal" href="index.html#ESMF.api.esmpymanager.Manager" title="ESMF.api.esmpymanager.Manager"><code class="xref py py-class docutils literal notranslate"><span class="pre">Manager</span></code></a> goes out of scope, there is a
destroy() call for explicit deallocation of the <a class="reference internal" href="#ESMF.api.regrid.Regrid" title="ESMF.api.regrid.Regrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Regrid</span></code></a>).</p>
<p>For more information about the ESMF Regridding functionality, please see
the <a class="reference external" href="http://www.earthsystemmodeling.org/esmf_releases/public/ESMF_7_1_0r/ESMF_refdoc/node5.html#SECTION05012000000000000000">ESMF Regrid documentation</a>.</p>
<p>The following arguments are used to create a handle to a Regridding
operation between two <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Fields</span></code></a>.</p>
<p><em>REQUIRED:</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>srcfield</strong> (<a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><em>Field</em></a>) – source <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> associated with an underlying <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>,
<a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> or <a class="reference internal" href="index.html#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStream</span></code></a>.</p></li>
<li><p><strong>dstfield</strong> (<a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><em>Field</em></a>) – destination <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> associated with an underlying
<a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>, <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> or <a class="reference internal" href="index.html#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStream</span></code></a>.  The data in this <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> may be overwritten
by this call.</p></li>
</ul>
</dd>
</dl>
<p><em>OPTIONAL:</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>) – path to the output netCDF weight file.</p></li>
<li><p><strong>rh_filename</strong> (<em>string</em>) – path to the output RouteHandle file.</p></li>
<li><p><strong>src_mask_values</strong> (<em>ndarray</em>) – a numpy array of values that should be
considered masked value on the source <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a>.</p></li>
<li><p><strong>dst_mask_values</strong> (<em>ndarray</em>) – a numpy array of values that should be
considered masked value on the destination <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a>.</p></li>
<li><p><strong>regrid_method</strong> (<a class="reference internal" href="index.html#ESMF.api.constants.RegridMethod" title="ESMF.api.constants.RegridMethod"><em>RegridMethod</em></a>) – specifies which
<a class="reference internal" href="index.html#ESMF.api.constants.RegridMethod" title="ESMF.api.constants.RegridMethod"><code class="xref py py-attr docutils literal notranslate"><span class="pre">RegridMethod</span></code></a> to use.  If <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults
to <a class="reference internal" href="index.html#ESMF.api.constants.RegridMethod.BILINEAR" title="ESMF.api.constants.RegridMethod.BILINEAR"><code class="xref py py-attr docutils literal notranslate"><span class="pre">BILINEAR</span></code></a>.</p></li>
<li><p><strong>pole_method</strong> (<a class="reference internal" href="index.html#ESMF.api.constants.PoleMethod" title="ESMF.api.constants.PoleMethod"><em>PoleMethod</em></a>) – specifies which type of artificial pole
to construct on the source <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> for regridding.  If
<code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to: <a class="reference internal" href="index.html#ESMF.api.constants.PoleMethod.NONE" title="ESMF.api.constants.PoleMethod.NONE"><code class="xref py py-attr docutils literal notranslate"><span class="pre">NONE</span></code></a> for
regridmethod == <a class="reference internal" href="index.html#ESMF.api.constants.RegridMethod.CONSERVE" title="ESMF.api.constants.RegridMethod.CONSERVE"><code class="xref py py-attr docutils literal notranslate"><span class="pre">CONSERVE</span></code></a>, or
<a class="reference internal" href="index.html#ESMF.api.constants.PoleMethod.ALLAVG" title="ESMF.api.constants.PoleMethod.ALLAVG"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ALLAVG</span></code></a> for
regridmethod != <a class="reference internal" href="index.html#ESMF.api.constants.RegridMethod.CONSERVE" title="ESMF.api.constants.RegridMethod.CONSERVE"><code class="xref py py-attr docutils literal notranslate"><span class="pre">CONSERVE</span></code></a>.</p></li>
<li><p><strong>regrid_pole_npoints</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – specifies how many points to average over
if polemethod == <a class="reference internal" href="index.html#ESMF.api.constants.PoleMethod.ALLAVG" title="ESMF.api.constants.PoleMethod.ALLAVG"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ALLAVG</span></code></a>.</p></li>
<li><p><strong>line_type</strong> (<a class="reference internal" href="index.html#ESMF.api.constants.LineType" title="ESMF.api.constants.LineType"><em>LineType</em></a>) – select the path of the line that connects two
points on the surface of a sphere.  This in turn controls the path along
which distances are calculated and the shape of the edges that make up a
cell.  If <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to:
<a class="reference internal" href="index.html#ESMF.api.constants.LineType.GREAT_CIRCLE" title="ESMF.api.constants.LineType.GREAT_CIRCLE"><code class="xref py py-attr docutils literal notranslate"><span class="pre">GREAT_CIRCLE</span></code></a> for
regridmethod == <a class="reference internal" href="index.html#ESMF.api.constants.RegridMethod.CONSERVE" title="ESMF.api.constants.RegridMethod.CONSERVE"><code class="xref py py-attr docutils literal notranslate"><span class="pre">CONSERVE</span></code></a>, or
<a class="reference internal" href="index.html#ESMF.api.constants.LineType.CART" title="ESMF.api.constants.LineType.CART"><code class="xref py py-attr docutils literal notranslate"><span class="pre">CART</span></code></a> for
regridmethod != <a class="reference internal" href="index.html#ESMF.api.constants.RegridMethod.CONSERVE" title="ESMF.api.constants.RegridMethod.CONSERVE"><code class="xref py py-attr docutils literal notranslate"><span class="pre">CONSERVE</span></code></a>.</p></li>
<li><p><strong>norm_type</strong> (<a class="reference internal" href="index.html#ESMF.api.constants.NormType" title="ESMF.api.constants.NormType"><em>NormType</em></a>) – control which type of normalization to do when
generating conservative regridding weights. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to
<a class="reference internal" href="index.html#ESMF.api.constants.NormType.DSTAREA" title="ESMF.api.constants.NormType.DSTAREA"><code class="xref py py-attr docutils literal notranslate"><span class="pre">DSTAREA</span></code></a>.</p></li>
<li><p><strong>extrap_method</strong> (<a class="reference internal" href="index.html#ESMF.api.constants.ExtrapMethod" title="ESMF.api.constants.ExtrapMethod"><em>ExtrapMethod</em></a>) – Specify which extrapolation method to use on 
unmapped destination points after regridding.</p></li>
<li><p><strong>extrap_num_src_pnts</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The number of source points to use for the 
extrapolation methods that use more than one source point 
(e.g. <a class="reference internal" href="index.html#ESMF.api.constants.ExtrapMethod.NEAREST_IDAVG" title="ESMF.api.constants.ExtrapMethod.NEAREST_IDAVG"><code class="xref py py-attr docutils literal notranslate"><span class="pre">NEAREST_IDAVG</span></code></a>). If not 
specified, defaults to 8.</p></li>
<li><p><strong>extrap_dist_exponent</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – The exponent to raise the distance to when 
calculating weights for the <a class="reference internal" href="index.html#ESMF.api.constants.ExtrapMethod.NEAREST_IDAVG" title="ESMF.api.constants.ExtrapMethod.NEAREST_IDAVG"><code class="xref py py-attr docutils literal notranslate"><span class="pre">NEAREST_IDAVG</span></code></a>
extrapolation method. A higher value reduces the influence of more distant
points. If not specified, defaults to <code class="docutils literal notranslate"><span class="pre">2.0</span></code>.</p></li>
<li><p><strong>unmapped_action</strong> (<a class="reference internal" href="index.html#ESMF.api.constants.UnmappedAction" title="ESMF.api.constants.UnmappedAction"><em>UnmappedAction</em></a>) – specifies which action to take if a
destination point is found which does not map to any source point. If
<code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to <a class="reference internal" href="index.html#ESMF.api.constants.UnmappedAction.ERROR" title="ESMF.api.constants.UnmappedAction.ERROR"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ERROR</span></code></a>.</p></li>
<li><p><strong>ignore_degenerate</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Ignore degenerate cells when checking the
input <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></a> or <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Meshes</span></code></a>
for errors. If this is set to True, then the regridding proceeds, but
degenerate cells will be skipped. If set to False, a degenerate cell produces
an error. This currently only applies to <a class="reference internal" href="index.html#ESMF.api.constants.RegridMethod.CONSERVE" title="ESMF.api.constants.RegridMethod.CONSERVE"><code class="xref py py-attr docutils literal notranslate"><span class="pre">CONSERVE</span></code></a>,
other regrid methods currently always skip degenerate cells. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults
to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>src_frac_field</strong> (<em>ndarray</em>) – return a numpy array of values containing
weights corresponding to the amount of each <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a>
value which contributes to the total mass of the <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a>.</p></li>
<li><p><strong>dst_frac_field</strong> (<em>ndarray</em>) – return a numpy array of values containing
weights corresponding to the amount of each <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a>
value which contributes to the total mass of the <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a>.</p></li>
<li><p><strong>factors</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, return the factor and factor index list
when calling into <code class="docutils literal notranslate"><span class="pre">ESMF</span></code>’s regrid store method. These lists are converted
to NumPy arrays and attached to the regrid object. The factor arrays
are retrievable via <code class="xref py py-meth docutils literal notranslate"><span class="pre">get_factors()</span></code> or <code class="xref py py-meth docutils literal notranslate"><span class="pre">get_weights_dict()</span></code>.
See the respective documentation on those methods for additional information.
For more information on how <code class="docutils literal notranslate"><span class="pre">ESMF</span></code> treats factor retrieval see the
documentation for <a class="reference external" href="http://www.earthsystemmodeling.org/esmf_releases/public/ESMF_8_0_1/ESMF_refdoc/node5.html#SECTION050366000000000000000">ESMF_FieldRegridStore</a>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="ESMF.api.regrid.Regrid.__call__">
<code class="sig-name descname">__call__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">srcfield</span></em>, <em class="sig-param"><span class="n">dstfield</span></em>, <em class="sig-param"><span class="n">zero_region</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ESMF.api.regrid.Regrid.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Call a regridding operation from srcfield to dstfield.</p>
<p><em>REQUIRED:</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>srcfield</strong> (<a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><em>Field</em></a>) – the <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> of source data to regrid.</p></li>
<li><p><strong>dstfield</strong> (<a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><em>Field</em></a>) – the <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> to hold the regridded data.</p></li>
</ul>
</dd>
</dl>
<p><em>OPTIONAL:</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>zero_region</strong> (<a class="reference internal" href="index.html#ESMF.api.constants.Region" title="ESMF.api.constants.Region"><em>Region</em></a>) – specify which region of the field indices
will be zeroed out before adding the values resulting from the
interpolation.  If <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to
<a class="reference internal" href="index.html#ESMF.api.constants.Region.TOTAL" title="ESMF.api.constants.Region.TOTAL"><code class="xref py py-attr docutils literal notranslate"><span class="pre">TOTAL</span></code></a>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dstfield</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.regrid.Regrid.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ESMF.api.regrid.Regrid.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy a <a class="reference internal" href="#ESMF.api.regrid.Regrid" title="ESMF.api.regrid.Regrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Regrid</span></code></a> in an ESMF-safe manner.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A <a class="reference internal" href="#ESMF.api.regrid.Regrid" title="ESMF.api.regrid.Regrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Regrid</span></code></a> shallow copy.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.regrid.Regrid.destroy">
<code class="sig-name descname">destroy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ESMF.api.regrid.Regrid.destroy" title="Permalink to this definition">¶</a></dt>
<dd><p>Release the memory associated with a <a class="reference internal" href="#ESMF.api.regrid.Regrid" title="ESMF.api.regrid.Regrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Regrid</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.regrid.Regrid.get_factors">
<code class="sig-name descname">get_factors</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">deep_copy</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ESMF.api.regrid.Regrid.get_factors" title="Permalink to this definition">¶</a></dt>
<dd><p>Return factor and factor index arrays. These arrays will only be
available if the <code class="docutils literal notranslate"><span class="pre">Regrid</span></code> object was initialized with <code class="docutils literal notranslate"><span class="pre">factors=True</span></code>.
See the <a class="reference external" href="http://www.earthsystemmodeling.org/esmf_releases/public/ESMF_8_0_1/ESMF_refdoc/node5.html#SECTION050366000000000000000">ESMF documentation</a>
for additional information on these arrays (see below for indexing in
Python though).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">factors</span><span class="p">,</span> <span class="n">factors_index</span> <span class="o">=</span> <span class="n">get_factors</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>The first tuple element <code class="docutils literal notranslate"><span class="pre">factors</span></code> will have shape <code class="docutils literal notranslate"><span class="pre">(m,)</span></code> where
<code class="docutils literal notranslate"><span class="pre">m</span></code> is the number of factors or weights. It will be <code class="docutils literal notranslate"><span class="pre">dtype(float64)</span></code>.
The second tupe element <code class="docutils literal notranslate"><span class="pre">factors_index</span></code> will have shape <code class="docutils literal notranslate"><span class="pre">(m,</span> <span class="pre">2)</span></code>
where <code class="docutils literal notranslate"><span class="pre">m</span></code> is the number of factors or weights. The source/col indices
are selected by <code class="docutils literal notranslate"><span class="pre">factors_index[:,</span> <span class="pre">0]</span></code>. The destination/row indices
are selected by <code class="docutils literal notranslate"><span class="pre">factors_index[:,</span> <span class="pre">1]</span></code>. It will be <code class="docutils literal notranslate"><span class="pre">dtype(int32)</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <code class="docutils literal notranslate"><span class="pre">deep_copy=True</span></code>, array memory is C contiguous according
to NumPy array flags (<code class="docutils literal notranslate"><span class="pre">&lt;array&gt;.flags</span></code>).</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Remember to call <code class="xref py py-meth docutils literal notranslate"><span class="pre">destroy()</span></code> to deallocate
memory associated with a regrid operation. This will be called by
the Python garbage collector. However, if numerous regridding operations
are called in a tight loop, a memory leak will occur without a call
to <code class="docutils literal notranslate"><span class="pre">destroy</span></code>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>deep_copy</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, make deep copies of the returned
arrays. If <code class="docutils literal notranslate"><span class="pre">False</span></code> (the default), the returned arrays will reference
the underlying <code class="docutils literal notranslate"><span class="pre">ESMF</span></code> memory.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple of NumPy array objects</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.regrid.Regrid.get_weights_dict">
<code class="sig-name descname">get_weights_dict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">deep_copy</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ESMF.api.regrid.Regrid.get_weights_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary mapping that is more user-friendly for weight/factor
retrieval. Please read the documentation for <code class="xref py py-meth docutils literal notranslate"><span class="pre">get_factors()</span></code>
before using this function.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 32%" />
<col style="width: 68%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Key</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">weights</span></code></p></td>
<td><p>Weight value array</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">row_dst</span></code></p></td>
<td><p>Destination/row indices</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">col_src</span></code></p></td>
<td><p>Source/col indices</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <code class="docutils literal notranslate"><span class="pre">deep_copy=True</span></code>, array memory is C contiguous according
to NumPy array flags (<code class="docutils literal notranslate"><span class="pre">&lt;array&gt;.flags</span></code>).</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>deep_copy</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, make deep copies of the returned
arrays. If <code class="docutils literal notranslate"><span class="pre">False</span></code> (the default), the returned arrays will reference
the underlying <code class="docutils literal notranslate"><span class="pre">ESMF</span></code> memory.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<span id="document-regridfromfile"></span><div class="section" id="regridfromfile">
<h4>RegridFromFile<a class="headerlink" href="#regridfromfile" title="Permalink to this headline">¶</a></h4>
<dl class="py class">
<dt id="ESMF.api.regrid.RegridFromFile">
<em class="property">class </em><code class="sig-prename descclassname">ESMF.api.regrid.</code><code class="sig-name descname">RegridFromFile</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">srcfield</span></em>, <em class="sig-param"><span class="n">dstfield</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">rh_filename</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ESMF.api.regrid.RegridFromFile" title="Permalink to this definition">¶</a></dt>
<dd><p>The <a class="reference internal" href="#ESMF.api.regrid.RegridFromFile" title="ESMF.api.regrid.RegridFromFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">RegridFromFile</span></code></a> object represents a regridding
operator between two <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Fields</span></code></a> that is read
from a file. The creation of this object is analogous to= ESMF_FieldSMMStore(),
and calling this object corresponds to ESMF_FieldRegrid(). ESMF_FieldRegridRelease()
is called when the <a class="reference internal" href="#ESMF.api.regrid.RegridFromFile" title="ESMF.api.regrid.RegridFromFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">RegridFromFile</span></code></a> object goes
out of scope (this only happens when the <a class="reference internal" href="index.html#ESMF.api.esmpymanager.Manager" title="ESMF.api.esmpymanager.Manager"><code class="xref py py-class docutils literal notranslate"><span class="pre">Manager</span></code></a>
goes out of scope, there is a destroy() call for explicit deallocation of
the <a class="reference internal" href="#ESMF.api.regrid.RegridFromFile" title="ESMF.api.regrid.RegridFromFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">RegridFromFile</span></code></a>).</p>
<p>For more information about the ESMF Regridding functionality, please see
the <a class="reference external" href="http://www.earthsystemmodeling.org/esmf_releases/public/ESMF_7_1_0r/ESMF_refdoc/node5.html#SECTION05012000000000000000">ESMF Regrid documentation</a>.</p>
<p>The following arguments are used to create a handle to a regridding
operation between two <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Fields</span></code></a>.</p>
<p><em>REQUIRED:</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>srcfield</strong> (<a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><em>Field</em></a>) – source <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> associated
with an underlying <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>, <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>
or <a class="reference internal" href="index.html#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStream</span></code></a>.</p></li>
<li><p><strong>dstfield</strong> (<a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><em>Field</em></a>) – destination <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> associated
with an underlying <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>, <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>
or <a class="reference internal" href="index.html#ESMF.api.locstream.LocStream" title="ESMF.api.locstream.LocStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocStream</span></code></a>.  The data in this <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a>
may be overwritten by this call.</p></li>
<li><p><strong>filename</strong> (<em>string</em>) – the name of the file from which to retrieve the
weights.</p></li>
<li><p><strong>rh_filename</strong> (<em>string</em>) – the name of the file from which to retrieve the
routehandle information.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="ESMF.api.regrid.RegridFromFile.__call__">
<code class="sig-name descname">__call__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">srcfield</span></em>, <em class="sig-param"><span class="n">dstfield</span></em>, <em class="sig-param"><span class="n">zero_region</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ESMF.api.regrid.RegridFromFile.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Call a regridding operation from srcfield to dstfield.</p>
<p><em>REQUIRED:</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>srcfield</strong> (<a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><em>Field</em></a>) – the <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> of source data to regrid.</p></li>
<li><p><strong>dstfield</strong> (<a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><em>Field</em></a>) – the <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> to hold the regridded data.</p></li>
</ul>
</dd>
</dl>
<p><em>OPTIONAL:</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>zero_region</strong> (<a class="reference internal" href="index.html#ESMF.api.constants.Region" title="ESMF.api.constants.Region"><em>Region</em></a>) – specify which region of the field indices
will be zeroed out before adding the values resulting from the
interpolation.  If <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to
<a class="reference internal" href="index.html#ESMF.api.constants.Region.TOTAL" title="ESMF.api.constants.Region.TOTAL"><code class="xref py py-attr docutils literal notranslate"><span class="pre">TOTAL</span></code></a>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dstfield</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.regrid.RegridFromFile.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ESMF.api.regrid.RegridFromFile.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy a <a class="reference internal" href="index.html#ESMF.api.regrid.Regrid" title="ESMF.api.regrid.Regrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Regrid</span></code></a> in an ESMF-safe manner.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A <a class="reference internal" href="index.html#ESMF.api.regrid.Regrid" title="ESMF.api.regrid.Regrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Regrid</span></code></a> shallow copy.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ESMF.api.regrid.RegridFromFile.destroy">
<code class="sig-name descname">destroy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ESMF.api.regrid.RegridFromFile.destroy" title="Permalink to this definition">¶</a></dt>
<dd><p>Release the memory associated with the <a class="reference internal" href="#ESMF.api.regrid.RegridFromFile" title="ESMF.api.regrid.RegridFromFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">RegridFromFile</span></code></a>
object.</p>
</dd></dl>

</dd></dl>

</div>
</div>
</div>
<div class="section" id="named-constants">
<h3>Named Constants<a class="headerlink" href="#named-constants" title="Permalink to this headline">¶</a></h3>
<div class="toctree-wrapper compound">
<span id="document-CoordSys"></span><div class="section" id="coordsys">
<h4>CoordSys<a class="headerlink" href="#coordsys" title="Permalink to this headline">¶</a></h4>
<dl class="py class">
<dt id="ESMF.api.constants.CoordSys">
<em class="property">class </em><code class="sig-prename descclassname">ESMF.api.constants.</code><code class="sig-name descname">CoordSys</code><a class="headerlink" href="#ESMF.api.constants.CoordSys" title="Permalink to this definition">¶</a></dt>
<dd><p>This flag indicates the coordinate system of a <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>. This value is
useful both to indicate to other users the type of the coordinates,
but also to control how the coordinates are interpreted in
regridding methods (e.g. <a class="reference internal" href="index.html#ESMF.api.regrid.Regrid" title="ESMF.api.regrid.Regrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Regrid</span></code></a>).</p>
<dl class="py attribute">
<dt id="ESMF.api.constants.CoordSys.CART">
<code class="sig-name descname">CART</code><em class="property"> = &lt;CoordSys.CART: 0&gt;</em><a class="headerlink" href="#ESMF.api.constants.CoordSys.CART" title="Permalink to this definition">¶</a></dt>
<dd><p>Cartesian coordinate system. In this system, the Cartesian
coordinates are mapped to the <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> coordinate dimensions in the
following order: x, y, z. (e.g. using coord_dim=1 in
<a class="reference internal" href="index.html#ESMF.api.grid.Grid.get_coords" title="ESMF.api.grid.Grid.get_coords"><code class="xref py py-class docutils literal notranslate"><span class="pre">get_coords()</span></code></a> references the y dimension)</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.CoordSys.SPH_DEG">
<code class="sig-name descname">SPH_DEG</code><em class="property"> = &lt;CoordSys.SPH_DEG: 1&gt;</em><a class="headerlink" href="#ESMF.api.constants.CoordSys.SPH_DEG" title="Permalink to this definition">¶</a></dt>
<dd><p>Spherical coordinates in degrees. In this system, the spherical
coordinates are mapped to the <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> coordinate dimensions in the
following order: longitude, latitude, radius. (E.g. using
coord_dim=1 in <code class="xref py py-class docutils literal notranslate"><span class="pre">get_coords()`</span></code> references the latitude dimension).</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.CoordSys.SPH_RAD">
<code class="sig-name descname">SPH_RAD</code><em class="property"> = &lt;CoordSys.SPH_RAD: 2&gt;</em><a class="headerlink" href="#ESMF.api.constants.CoordSys.SPH_RAD" title="Permalink to this definition">¶</a></dt>
<dd><p>Spherical coordinates in radians. In this system, the spherical
coordinates are mapped to the <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> coordinate dimensions in the
following order: longitude, latitude, radius. (E.g. using
coord_dim=1 in <a class="reference internal" href="index.html#ESMF.api.grid.Grid.get_coords" title="ESMF.api.grid.Grid.get_coords"><code class="xref py py-class docutils literal notranslate"><span class="pre">get_coords()</span></code></a> references the latitude dimension).</p>
</dd></dl>

</dd></dl>

</div>
<span id="document-ExtrapMethod"></span><div class="section" id="extrapmethod">
<h4>ExtrapMethod<a class="headerlink" href="#extrapmethod" title="Permalink to this headline">¶</a></h4>
<dl class="py class">
<dt id="ESMF.api.constants.ExtrapMethod">
<em class="property">class </em><code class="sig-prename descclassname">ESMF.api.constants.</code><code class="sig-name descname">ExtrapMethod</code><a class="headerlink" href="#ESMF.api.constants.ExtrapMethod" title="Permalink to this definition">¶</a></dt>
<dd><p>Specify which extrapolation method to use on unmapped destination points after 
regridding.</p>
<dl class="py attribute">
<dt id="ESMF.api.constants.ExtrapMethod.NONE">
<code class="sig-name descname">NONE</code><em class="property"> = &lt;ExtrapMethod.NONE: 0&gt;</em><a class="headerlink" href="#ESMF.api.constants.ExtrapMethod.NONE" title="Permalink to this definition">¶</a></dt>
<dd><p>Indicates that no extrapolation should be done.</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.ExtrapMethod.NEAREST_STOD">
<code class="sig-name descname">NEAREST_STOD</code><em class="property"> = &lt;ExtrapMethod.NEAREST_STOD: 1&gt;</em><a class="headerlink" href="#ESMF.api.constants.ExtrapMethod.NEAREST_STOD" title="Permalink to this definition">¶</a></dt>
<dd><p>Inverse distance weighted average. 
Here the value of a destination point is the weighted average of the 
closest N source points. The weight is the reciprocal of the distance of 
the source point from the destination point raised to a power P. All the
weights contributing to one destination point are normalized so that they 
sum to 1.0. The user can choose N and P when using this method, but 
defaults are also provided.</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.ExtrapMethod.NEAREST_IDAVG">
<code class="sig-name descname">NEAREST_IDAVG</code><em class="property"> = &lt;ExtrapMethod.NEAREST_IDAVG: 2&gt;</em><a class="headerlink" href="#ESMF.api.constants.ExtrapMethod.NEAREST_IDAVG" title="Permalink to this definition">¶</a></dt>
<dd><p>Nearest source to destination. 
Here each destination point is mapped to the closest source point. A given 
source point may go to multiple destination points, but no destination 
point will receive input from more than one source point.</p>
</dd></dl>

</dd></dl>

</div>
<span id="document-FileFormat"></span><div class="section" id="fileformat">
<h4>FileFormat<a class="headerlink" href="#fileformat" title="Permalink to this headline">¶</a></h4>
<dl class="py class">
<dt id="ESMF.api.constants.FileFormat">
<em class="property">class </em><code class="sig-prename descclassname">ESMF.api.constants.</code><code class="sig-name descname">FileFormat</code><a class="headerlink" href="#ESMF.api.constants.FileFormat" title="Permalink to this definition">¶</a></dt>
<dd><p>The <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> and <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> objects 
may be created from specifications in a NetCDF data file.  This flag 
indicates the format of the data file.</p>
<dl class="py attribute">
<dt id="ESMF.api.constants.FileFormat.VTK">
<code class="sig-name descname">VTK</code><em class="property"> = &lt;FileFormat.VTK: 1&gt;</em><a class="headerlink" href="#ESMF.api.constants.FileFormat.VTK" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the VTK file format.</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.FileFormat.SCRIP">
<code class="sig-name descname">SCRIP</code><em class="property"> = &lt;FileFormat.SCRIP: 2&gt;</em><a class="headerlink" href="#ESMF.api.constants.FileFormat.SCRIP" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the <a class="reference internal" href="index.html#id2"><span class="std std-ref">SCRIP</span></a> file format.</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.FileFormat.ESMFMESH">
<code class="sig-name descname">ESMFMESH</code><em class="property"> = &lt;FileFormat.ESMFMESH: 3&gt;</em><a class="headerlink" href="#ESMF.api.constants.FileFormat.ESMFMESH" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the <a class="reference internal" href="index.html#id4"><span class="std std-ref">ESMFMESH</span></a> unstructured grid file format.</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.FileFormat.ESMFGRID">
<code class="sig-name descname">ESMFGRID</code><em class="property"> = &lt;FileFormat.ESMFGRID: 4&gt;</em><a class="headerlink" href="#ESMF.api.constants.FileFormat.ESMFGRID" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the ESMF structured grid file format.</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.FileFormat.UGRID">
<code class="sig-name descname">UGRID</code><em class="property"> = &lt;FileFormat.UGRID: 5&gt;</em><a class="headerlink" href="#ESMF.api.constants.FileFormat.UGRID" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the <a class="reference internal" href="index.html#id6"><span class="std std-ref">UGRID</span></a> unstructured grid file format.</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.FileFormat.GRIDSPEC">
<code class="sig-name descname">GRIDSPEC</code><em class="property"> = &lt;FileFormat.GRIDSPEC: 6&gt;</em><a class="headerlink" href="#ESMF.api.constants.FileFormat.GRIDSPEC" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the <a class="reference internal" href="index.html#id5"><span class="std std-ref">UGRID single tile grid file format based on CF V1.6 conventions (a.k.a GRIDSPEC)</span></a>.</p>
</dd></dl>

</dd></dl>

</div>
<span id="document-FileMode"></span><div class="section" id="filemode">
<h4>FileMode<a class="headerlink" href="#filemode" title="Permalink to this headline">¶</a></h4>
<dl class="py class">
<dt id="ESMF.api.constants.FileMode">
<em class="property">class </em><code class="sig-prename descclassname">ESMF.api.constants.</code><code class="sig-name descname">FileMode</code><a class="headerlink" href="#ESMF.api.constants.FileMode" title="Permalink to this definition">¶</a></dt>
<dd><p>Specify which mode to use when writing a weight file.</p>
<dl class="py attribute">
<dt id="ESMF.api.constants.FileMode.BASIC">
<code class="sig-name descname">BASIC</code><em class="property"> = &lt;FileMode.BASIC: 0&gt;</em><a class="headerlink" href="#ESMF.api.constants.FileMode.BASIC" title="Permalink to this definition">¶</a></dt>
<dd><p>Indicates that only the factorList and factorIndexList should be written.</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.FileMode.WITHAUX">
<code class="sig-name descname">WITHAUX</code><em class="property"> = &lt;FileMode.WITHAUX: 1&gt;</em><a class="headerlink" href="#ESMF.api.constants.FileMode.WITHAUX" title="Permalink to this definition">¶</a></dt>
<dd><p>Indicates that grid center coordinates should also be written.</p>
</dd></dl>

</dd></dl>

</div>
<span id="document-GridItem"></span><div class="section" id="griditem">
<h4>GridItem<a class="headerlink" href="#griditem" title="Permalink to this headline">¶</a></h4>
<dl class="py class">
<dt id="ESMF.api.constants.GridItem">
<em class="property">class </em><code class="sig-prename descclassname">ESMF.api.constants.</code><code class="sig-name descname">GridItem</code><a class="headerlink" href="#ESMF.api.constants.GridItem" title="Permalink to this definition">¶</a></dt>
<dd><p>The <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> can contain other kinds of data besides coordinates. This
data is referred to as <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> “items”. Some items may be used
for calculations involving the <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>.</p>
<dl class="py attribute">
<dt id="ESMF.api.constants.GridItem.MASK">
<code class="sig-name descname">MASK</code><em class="property"> = &lt;GridItem.MASK: 0&gt;</em><a class="headerlink" href="#ESMF.api.constants.GridItem.MASK" title="Permalink to this definition">¶</a></dt>
<dd><p>A grid item to represent a mask.</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.GridItem.AREA">
<code class="sig-name descname">AREA</code><em class="property"> = &lt;GridItem.AREA: 1&gt;</em><a class="headerlink" href="#ESMF.api.constants.GridItem.AREA" title="Permalink to this definition">¶</a></dt>
<dd><p>A grid item to represent an area field for conservative regridding.</p>
</dd></dl>

</dd></dl>

</div>
<span id="document-LineType"></span><div class="section" id="linetype">
<h4>LineType<a class="headerlink" href="#linetype" title="Permalink to this headline">¶</a></h4>
<dl class="py class">
<dt id="ESMF.api.constants.LineType">
<em class="property">class </em><code class="sig-prename descclassname">ESMF.api.constants.</code><code class="sig-name descname">LineType</code><a class="headerlink" href="#ESMF.api.constants.LineType" title="Permalink to this definition">¶</a></dt>
<dd><p>This argument controls the path of the line which connects two points on
the surface of the sphere. This in turn controls the path along which
distances are calculated and the shape of the edges that make up a cell.
Both of these quantities can influence how interpolation weights are
calculated. As would be expected, this argument is only applicable with
grids which lie on the surface of a sphere.</p>
<dl class="py attribute">
<dt id="ESMF.api.constants.LineType.CART">
<code class="sig-name descname">CART</code><em class="property"> = &lt;LineType.CART: 0&gt;</em><a class="headerlink" href="#ESMF.api.constants.LineType.CART" title="Permalink to this definition">¶</a></dt>
<dd><p>Cartesian line. When this option is specified distances are calculated in a
straight line through the 3D Cartesian space in which the sphere is
embedded. Cells are approximated by 3D planes bounded by 3D Cartesian lines
between their corner vertices. When calculating regrid weights, this line
type is currently the default for the following all regrid methods except
for conservative.</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.LineType.GREAT_CIRCLE">
<code class="sig-name descname">GREAT_CIRCLE</code><em class="property"> = &lt;LineType.GREAT_CIRCLE: 1&gt;</em><a class="headerlink" href="#ESMF.api.constants.LineType.GREAT_CIRCLE" title="Permalink to this definition">¶</a></dt>
<dd><p>Great circle line. When this option is specified distances are calculated
along a great circle path (the shortest distance between two points on a
sphere surface). Cells are bounded by great circle paths between their
corner vertices. When calculating regrid weights, this line type is
currently the default for the conservative regrid method.</p>
</dd></dl>

</dd></dl>

</div>
<span id="document-LogKind"></span><div class="section" id="logkind">
<h4>LogKind<a class="headerlink" href="#logkind" title="Permalink to this headline">¶</a></h4>
<dl class="py class">
<dt id="ESMF.api.constants.LogKind">
<em class="property">class </em><code class="sig-prename descclassname">ESMF.api.constants.</code><code class="sig-name descname">LogKind</code><a class="headerlink" href="#ESMF.api.constants.LogKind" title="Permalink to this definition">¶</a></dt>
<dd><p>This flag is used to specify how much logging should be done.</p>
<dl class="py attribute">
<dt id="ESMF.api.constants.LogKind.MULTI">
<code class="sig-name descname">MULTI</code><em class="property"> = &lt;LogKind.MULTI: 2&gt;</em><a class="headerlink" href="#ESMF.api.constants.LogKind.MULTI" title="Permalink to this definition">¶</a></dt>
<dd><p>Use multiple log files – one per PET.</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.LogKind.NONE">
<code class="sig-name descname">NONE</code><em class="property"> = &lt;LogKind.NONE: 3&gt;</em><a class="headerlink" href="#ESMF.api.constants.LogKind.NONE" title="Permalink to this definition">¶</a></dt>
<dd><p>Do not issue messages to a log file.</p>
</dd></dl>

</dd></dl>

</div>
<span id="document-MeshElemType"></span><div class="section" id="meshelemtype">
<h4>MeshElemType<a class="headerlink" href="#meshelemtype" title="Permalink to this headline">¶</a></h4>
<dl class="py class">
<dt id="ESMF.api.constants.MeshElemType">
<em class="property">class </em><code class="sig-prename descclassname">ESMF.api.constants.</code><code class="sig-name descname">MeshElemType</code><a class="headerlink" href="#ESMF.api.constants.MeshElemType" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> can be constructed from a combination of different elements.
The type of elements that can be used in a <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> depends on the
parametric dimension of the <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>, which is set during <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>
creation. The following are the valid <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> element types for each
valid <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> parametric dimension (2D or 3D).</p>
<dl class="py attribute">
<dt id="ESMF.api.constants.MeshElemType.TRI">
<code class="sig-name descname">TRI</code><em class="property"> = &lt;MeshElemType.TRI: 3&gt;</em><a class="headerlink" href="#ESMF.api.constants.MeshElemType.TRI" title="Permalink to this definition">¶</a></dt>
<dd><p>2D triangular elements with 3 sides.</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.MeshElemType.QUAD">
<code class="sig-name descname">QUAD</code><em class="property"> = &lt;MeshElemType.QUAD: 4&gt;</em><a class="headerlink" href="#ESMF.api.constants.MeshElemType.QUAD" title="Permalink to this definition">¶</a></dt>
<dd><p>2D quadrilateral elements with 4 sides.</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.MeshElemType.TETRA">
<code class="sig-name descname">TETRA</code><em class="property"> = &lt;MeshElemType.TETRA: 10&gt;</em><a class="headerlink" href="#ESMF.api.constants.MeshElemType.TETRA" title="Permalink to this definition">¶</a></dt>
<dd><p>3D tetrahedral elements with 4 faces.</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.MeshElemType.HEX">
<code class="sig-name descname">HEX</code><em class="property"> = &lt;MeshElemType.HEX: 12&gt;</em><a class="headerlink" href="#ESMF.api.constants.MeshElemType.HEX" title="Permalink to this definition">¶</a></dt>
<dd><p>3D hexahedral elements with 6 faces.</p>
</dd></dl>

</dd></dl>

</div>
<span id="document-MeshLoc"></span><div class="section" id="meshloc">
<h4>MeshLoc<a class="headerlink" href="#meshloc" title="Permalink to this headline">¶</a></h4>
<dl class="py class">
<dt id="ESMF.api.constants.MeshLoc">
<em class="property">class </em><code class="sig-prename descclassname">ESMF.api.constants.</code><code class="sig-name descname">MeshLoc</code><a class="headerlink" href="#ESMF.api.constants.MeshLoc" title="Permalink to this definition">¶</a></dt>
<dd><p>The <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> location used to hold <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> data.</p>
<dl class="py attribute">
<dt id="ESMF.api.constants.MeshLoc.NODE">
<code class="sig-name descname">NODE</code><em class="property"> = &lt;MeshLoc.NODE: 0&gt;</em><a class="headerlink" href="#ESMF.api.constants.MeshLoc.NODE" title="Permalink to this definition">¶</a></dt>
<dd><p>The nodes of the <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>.</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.MeshLoc.ELEMENT">
<code class="sig-name descname">ELEMENT</code><em class="property"> = &lt;MeshLoc.ELEMENT: 1&gt;</em><a class="headerlink" href="#ESMF.api.constants.MeshLoc.ELEMENT" title="Permalink to this definition">¶</a></dt>
<dd><p>The elements of the <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>.</p>
</dd></dl>

</dd></dl>

</div>
<span id="document-NormType"></span><div class="section" id="normtype">
<h4>NormType<a class="headerlink" href="#normtype" title="Permalink to this headline">¶</a></h4>
<dl class="py class">
<dt id="ESMF.api.constants.NormType">
<em class="property">class </em><code class="sig-prename descclassname">ESMF.api.constants.</code><code class="sig-name descname">NormType</code><a class="headerlink" href="#ESMF.api.constants.NormType" title="Permalink to this definition">¶</a></dt>
<dd><p>When doing conservative regridding, this option allows the user
to select the type of normalization used when producing the weights.</p>
<dl class="py attribute">
<dt id="ESMF.api.constants.NormType.DSTAREA">
<code class="sig-name descname">DSTAREA</code><em class="property"> = &lt;NormType.DSTAREA: 0&gt;</em><a class="headerlink" href="#ESMF.api.constants.NormType.DSTAREA" title="Permalink to this definition">¶</a></dt>
<dd><p>Destination area normalization. Here the weights are calculated by dividing
the area of overlap of the source and destination cells by the area of the
entire destination cell. In other words, the weight is the fraction of the
entire destination cell which overlaps with the given source cell.</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.NormType.FRACAREA">
<code class="sig-name descname">FRACAREA</code><em class="property"> = &lt;NormType.FRACAREA: 1&gt;</em><a class="headerlink" href="#ESMF.api.constants.NormType.FRACAREA" title="Permalink to this definition">¶</a></dt>
<dd><p>Fraction area normalization. Here in addition to the weight calculation
done for destination area normalization the weights are also divided by the
fraction that the destination cell overlaps with the entire source grid. In
other words, the weight is the fraction of just the part of the destination
cell that overlaps with the entire source mesh.</p>
</dd></dl>

</dd></dl>

</div>
<span id="document-PoleKind"></span><div class="section" id="polekind">
<h4>PoleKind<a class="headerlink" href="#polekind" title="Permalink to this headline">¶</a></h4>
<dl class="py class">
<dt id="ESMF.api.constants.PoleKind">
<em class="property">class </em><code class="sig-prename descclassname">ESMF.api.constants.</code><code class="sig-name descname">PoleKind</code><a class="headerlink" href="#ESMF.api.constants.PoleKind" title="Permalink to this definition">¶</a></dt>
<dd><p>This type describes the type of connection that occurs at the pole of a  
<a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>.</p>
<dl class="py attribute">
<dt id="ESMF.api.constants.PoleKind.NONE">
<code class="sig-name descname">NONE</code><em class="property"> = &lt;PoleKind.NONE: 0&gt;</em><a class="headerlink" href="#ESMF.api.constants.PoleKind.NONE" title="Permalink to this definition">¶</a></dt>
<dd><p>No connection at pole.</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.PoleKind.MONOPOLE">
<code class="sig-name descname">MONOPOLE</code><em class="property"> = &lt;PoleKind.MONOPOLE: 1&gt;</em><a class="headerlink" href="#ESMF.api.constants.PoleKind.MONOPOLE" title="Permalink to this definition">¶</a></dt>
<dd><p>This edge is connected to itself. Given that the edge is n elements long, 
then element i is connected to element i+n/2.</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.PoleKind.BIPOLE">
<code class="sig-name descname">BIPOLE</code><em class="property"> = &lt;PoleKind.BIPOLE: 2&gt;</em><a class="headerlink" href="#ESMF.api.constants.PoleKind.BIPOLE" title="Permalink to this definition">¶</a></dt>
<dd><p>This edge is connected to itself. Given that the edge is n elements long, element i is connected to element n-i-1.</p>
</dd></dl>

</dd></dl>

</div>
<span id="document-PoleMethod"></span><div class="section" id="polemethod">
<h4>PoleMethod<a class="headerlink" href="#polemethod" title="Permalink to this headline">¶</a></h4>
<dl class="py class">
<dt id="ESMF.api.constants.PoleMethod">
<em class="property">class </em><code class="sig-prename descclassname">ESMF.api.constants.</code><code class="sig-name descname">PoleMethod</code><a class="headerlink" href="#ESMF.api.constants.PoleMethod" title="Permalink to this definition">¶</a></dt>
<dd><p>Indicates which type of artificial pole to construct on the source
<a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> for regridding.</p>
<dl class="py attribute">
<dt id="ESMF.api.constants.PoleMethod.NONE">
<code class="sig-name descname">NONE</code><em class="property"> = &lt;PoleMethod.NONE: 0&gt;</em><a class="headerlink" href="#ESMF.api.constants.PoleMethod.NONE" title="Permalink to this definition">¶</a></dt>
<dd><p>No pole. Destination points which lie above the top or below the bottom row
of the source <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> won’t be mapped.</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.PoleMethod.ALLAVG">
<code class="sig-name descname">ALLAVG</code><em class="property"> = &lt;PoleMethod.ALLAVG: 1&gt;</em><a class="headerlink" href="#ESMF.api.constants.PoleMethod.ALLAVG" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct an artificial pole placed in the center of the top (or bottom)
row of nodes, but projected onto the sphere formed by the rest of the grid.
The value at this pole is the average of all the source values surrounding
the pole.</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.PoleMethod.NPNTAVG">
<code class="sig-name descname">NPNTAVG</code><em class="property"> = &lt;PoleMethod.NPNTAVG: 2&gt;</em><a class="headerlink" href="#ESMF.api.constants.PoleMethod.NPNTAVG" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct an artificial pole placed in the center of the top (or bottom)
row of nodes, but projected onto the sphere formed by the rest of the grid.
The value at this pole is the average of the N source nodes next to the pole
and surrounding the destination point (i.e. the value may differ for each
destination point). Here N is set by using the regridPoleNPnts parameter
and ranges from 1 to the number of nodes around the pole. This option is
useful for interpolating values which may be zeroed out by averaging around
the entire pole (e.g. vector components).</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.PoleMethod.TEETH">
<code class="sig-name descname">TEETH</code><em class="property"> = &lt;PoleMethod.TEETH: 3&gt;</em><a class="headerlink" href="#ESMF.api.constants.PoleMethod.TEETH" title="Permalink to this definition">¶</a></dt>
<dd><p>No new pole point is constructed, instead the holes at the poles are filled
by constructing triangles across the top and bottom row of the source <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>.
This can be useful because no averaging occurs, however, because the top and
bottom of the sphere are now flat, for a big enough mismatch between the
size of the destination and source pole holes, some destination points may
still not be able to be mapped to the source <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>.</p>
</dd></dl>

</dd></dl>

</div>
<span id="document-Region"></span><div class="section" id="region">
<h4>Region<a class="headerlink" href="#region" title="Permalink to this headline">¶</a></h4>
<dl class="py class">
<dt id="ESMF.api.constants.Region">
<em class="property">class </em><code class="sig-prename descclassname">ESMF.api.constants.</code><code class="sig-name descname">Region</code><a class="headerlink" href="#ESMF.api.constants.Region" title="Permalink to this definition">¶</a></dt>
<dd><p>Specify various regions in the data layout of a <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> object.</p>
<dl class="py attribute">
<dt id="ESMF.api.constants.Region.TOTAL">
<code class="sig-name descname">TOTAL</code><em class="property"> = &lt;Region.TOTAL: 0&gt;</em><a class="headerlink" href="#ESMF.api.constants.Region.TOTAL" title="Permalink to this definition">¶</a></dt>
<dd><p>An operation applies to every element in the selected domain.</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.Region.SELECT">
<code class="sig-name descname">SELECT</code><em class="property"> = &lt;Region.SELECT: 1&gt;</em><a class="headerlink" href="#ESMF.api.constants.Region.SELECT" title="Permalink to this definition">¶</a></dt>
<dd><p>An operation applies to a select portion of the domain. One use of this is
to specify that the portions of a <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> that are not mapped in a regridding
operation should retain their original value (as opposed to being
initialized to 0).</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.Region.EMPTY">
<code class="sig-name descname">EMPTY</code><em class="property"> = &lt;Region.EMPTY: 2&gt;</em><a class="headerlink" href="#ESMF.api.constants.Region.EMPTY" title="Permalink to this definition">¶</a></dt>
<dd><p>An operation does not apply any element in the domain.</p>
</dd></dl>

</dd></dl>

</div>
<span id="document-RegridMethod"></span><div class="section" id="regridmethod">
<h4>RegridMethod<a class="headerlink" href="#regridmethod" title="Permalink to this headline">¶</a></h4>
<dl class="py class">
<dt id="ESMF.api.constants.RegridMethod">
<em class="property">class </em><code class="sig-prename descclassname">ESMF.api.constants.</code><code class="sig-name descname">RegridMethod</code><a class="headerlink" href="#ESMF.api.constants.RegridMethod" title="Permalink to this definition">¶</a></dt>
<dd><p>Specify which interpolation method to use during regridding.</p>
<dl class="py attribute">
<dt id="ESMF.api.constants.RegridMethod.BILINEAR">
<code class="sig-name descname">BILINEAR</code><em class="property"> = &lt;RegridMethod.BILINEAR: 0&gt;</em><a class="headerlink" href="#ESMF.api.constants.RegridMethod.BILINEAR" title="Permalink to this definition">¶</a></dt>
<dd><p>Bilinear interpolation. Destination value is a linear combination of the 
source values in the cell which contains the destination point. The 
weights for the linear combination are based on the distance of destination 
point from each source value.</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.RegridMethod.PATCH">
<code class="sig-name descname">PATCH</code><em class="property"> = &lt;RegridMethod.PATCH: 1&gt;</em><a class="headerlink" href="#ESMF.api.constants.RegridMethod.PATCH" title="Permalink to this definition">¶</a></dt>
<dd><p>Higher-order patch recovery interpolation. Destination value is a weighted 
average of 2D polynomial patches constructed from cells surrounding the 
source cell which contains the destination point. This method typically 
results in better approximations to values and derivatives than bilinear. 
However, because of its larger stencil, it also results in a much larger 
interpolation matrix (and thus routeHandle) than the bilinear.</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.RegridMethod.CONSERVE">
<code class="sig-name descname">CONSERVE</code><em class="property"> = &lt;RegridMethod.CONSERVE: 2&gt;</em><a class="headerlink" href="#ESMF.api.constants.RegridMethod.CONSERVE" title="Permalink to this definition">¶</a></dt>
<dd><p>First-order conservative interpolation. The main purpose of this method is 
to preserve the integral of the field between the source and destination. 
Will typically give a less accurate approximation to the individual field 
values than the bilinear or patch methods. The value of a destination cell 
is calculated as the weighted sum of the values of the source cells that it 
overlaps. The weights are determined by the amount the source cell overlaps 
the destination cell. Needs corner coordinate values to be provided in the 
<a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>. Currently only works for 
<a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Fields</span></code></a> created on the 
<a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> center stagger or 
the <a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> element location.</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.RegridMethod.NEAREST_STOD">
<code class="sig-name descname">NEAREST_STOD</code><em class="property"> = &lt;RegridMethod.NEAREST_STOD: 3&gt;</em><a class="headerlink" href="#ESMF.api.constants.RegridMethod.NEAREST_STOD" title="Permalink to this definition">¶</a></dt>
<dd><p>In this version of nearest neighbor interpolation each destination point is 
mapped to the closest source point. A given source point may go to multiple 
destination points, but no destination point will receive input from more 
than one source point.</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.RegridMethod.NEAREST_DTOS">
<code class="sig-name descname">NEAREST_DTOS</code><em class="property"> = &lt;RegridMethod.NEAREST_DTOS: 4&gt;</em><a class="headerlink" href="#ESMF.api.constants.RegridMethod.NEAREST_DTOS" title="Permalink to this definition">¶</a></dt>
<dd><p>In this version of nearest neighbor interpolation each source point is 
mapped to the closest destination point. A given destination point may 
receive input from multiple source points, but no source point will go to 
more than one destination point.</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.RegridMethod.CONSERVE_2ND">
<code class="sig-name descname">CONSERVE_2ND</code><em class="property"> = &lt;RegridMethod.CONSERVE_2ND: 5&gt;</em><a class="headerlink" href="#ESMF.api.constants.RegridMethod.CONSERVE_2ND" title="Permalink to this definition">¶</a></dt>
<dd><p>Second-order conservative interpolation. As with first-order, preserves the 
integral of the value between the source and destination. However, typically 
produces a smoother more accurate result than first-order. Also like 
first-order, the value of a destination cell is calculated as the weighted 
sum of the values of the source cells that it overlaps. However, 
second-order also includes additional terms to take into account the 
gradient of the field across the source cell. Needs corner coordinate 
values to be provided in the <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a>. Currently only 
works for <a class="reference internal" href="index.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Fields</span></code></a> created 
on the <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> center stagger or the 
<a class="reference internal" href="index.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> element location.</p>
</dd></dl>

</dd></dl>

</div>
<span id="document-StaggerLoc"></span><div class="section" id="staggerloc">
<h4>StaggerLoc<a class="headerlink" href="#staggerloc" title="Permalink to this headline">¶</a></h4>
<dl class="py class">
<dt id="ESMF.api.constants.StaggerLoc">
<em class="property">class </em><code class="sig-prename descclassname">ESMF.api.constants.</code><code class="sig-name descname">StaggerLoc</code><a class="headerlink" href="#ESMF.api.constants.StaggerLoc" title="Permalink to this definition">¶</a></dt>
<dd><p>In the <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> class, data can be located at different positions in a
<a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> cell. When setting or retrieving coordinate data the stagger
location is specified to tell the <a class="reference internal" href="index.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></a> method from where in the
cell to get the data.</p>
<dl class="py attribute">
<dt id="ESMF.api.constants.StaggerLoc.CENTER">
<code class="sig-name descname">CENTER</code><em class="property"> = &lt;StaggerLoc.CENTER: 0&gt;</em><a class="headerlink" href="#ESMF.api.constants.StaggerLoc.CENTER" title="Permalink to this definition">¶</a></dt>
<dd><p>2D: Cell centered stagger location.</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.StaggerLoc.EDGE1">
<code class="sig-name descname">EDGE1</code><em class="property"> = &lt;StaggerLoc.EDGE1: 1&gt;</em><a class="headerlink" href="#ESMF.api.constants.StaggerLoc.EDGE1" title="Permalink to this definition">¶</a></dt>
<dd><p>2D: First dimension edge stagger location.</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.StaggerLoc.EDGE2">
<code class="sig-name descname">EDGE2</code><em class="property"> = &lt;StaggerLoc.EDGE2: 2&gt;</em><a class="headerlink" href="#ESMF.api.constants.StaggerLoc.EDGE2" title="Permalink to this definition">¶</a></dt>
<dd><p>2D: Second dimension edge stagger location.</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.StaggerLoc.CORNER">
<code class="sig-name descname">CORNER</code><em class="property"> = &lt;StaggerLoc.CORNER: 3&gt;</em><a class="headerlink" href="#ESMF.api.constants.StaggerLoc.CORNER" title="Permalink to this definition">¶</a></dt>
<dd><p>2D: Cell corner stagger location.</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.StaggerLoc.CENTER_VCENTER">
<code class="sig-name descname">CENTER_VCENTER</code><em class="property"> = None</em><a class="headerlink" href="#ESMF.api.constants.StaggerLoc.CENTER_VCENTER" title="Permalink to this definition">¶</a></dt>
<dd><p>3D: Vertically centered stagger location.</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.StaggerLoc.EDGE1_VCENTER">
<code class="sig-name descname">EDGE1_VCENTER</code><em class="property"> = None</em><a class="headerlink" href="#ESMF.api.constants.StaggerLoc.EDGE1_VCENTER" title="Permalink to this definition">¶</a></dt>
<dd><p>3D: Vertically centered first dimension edge stagger location.</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.StaggerLoc.EDGE2_VCENTER">
<code class="sig-name descname">EDGE2_VCENTER</code><em class="property"> = None</em><a class="headerlink" href="#ESMF.api.constants.StaggerLoc.EDGE2_VCENTER" title="Permalink to this definition">¶</a></dt>
<dd><p>3D: Vertically centered second dimension edge stagger location.</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.StaggerLoc.CORNER_VCENTER">
<code class="sig-name descname">CORNER_VCENTER</code><em class="property"> = None</em><a class="headerlink" href="#ESMF.api.constants.StaggerLoc.CORNER_VCENTER" title="Permalink to this definition">¶</a></dt>
<dd><p>3D: Vertically centered corner stagger location.</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.StaggerLoc.CENTER_VFACE">
<code class="sig-name descname">CENTER_VFACE</code><em class="property"> = &lt;StaggerLoc.CENTER_VFACE: 4&gt;</em><a class="headerlink" href="#ESMF.api.constants.StaggerLoc.CENTER_VFACE" title="Permalink to this definition">¶</a></dt>
<dd><p>3D: Centered stagger location of the top and bottom cell faces.</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.StaggerLoc.EDGE1_VFACE">
<code class="sig-name descname">EDGE1_VFACE</code><em class="property"> = &lt;StaggerLoc.EDGE1_VFACE: 5&gt;</em><a class="headerlink" href="#ESMF.api.constants.StaggerLoc.EDGE1_VFACE" title="Permalink to this definition">¶</a></dt>
<dd><p>3D: First dimension edge stagger location of the top and bottom cell faces.</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.StaggerLoc.EDGE2_VFACE">
<code class="sig-name descname">EDGE2_VFACE</code><em class="property"> = &lt;StaggerLoc.EDGE2_VFACE: 6&gt;</em><a class="headerlink" href="#ESMF.api.constants.StaggerLoc.EDGE2_VFACE" title="Permalink to this definition">¶</a></dt>
<dd><p>3D: Second dimension edge stagger location of the top and bottom cell faces.</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.StaggerLoc.CORNER_VFACE">
<code class="sig-name descname">CORNER_VFACE</code><em class="property"> = &lt;StaggerLoc.CORNER_VFACE: 7&gt;</em><a class="headerlink" href="#ESMF.api.constants.StaggerLoc.CORNER_VFACE" title="Permalink to this definition">¶</a></dt>
<dd><p>3D: Corner stagger location of the top and bottom cell faces.</p>
</dd></dl>

</dd></dl>

</div>
<span id="document-TypeKind"></span><div class="section" id="typekind">
<h4>TypeKind<a class="headerlink" href="#typekind" title="Permalink to this headline">¶</a></h4>
<dl class="py class">
<dt id="ESMF.api.constants.TypeKind">
<em class="property">class </em><code class="sig-prename descclassname">ESMF.api.constants.</code><code class="sig-name descname">TypeKind</code><a class="headerlink" href="#ESMF.api.constants.TypeKind" title="Permalink to this definition">¶</a></dt>
<dd><p>This is used to indicate the type and kind of ESMPy types to the
underlying ESMF library routines.</p>
<dl class="py attribute">
<dt id="ESMF.api.constants.TypeKind.I4">
<code class="sig-name descname">I4</code><em class="property"> = &lt;TypeKind.I4: 3&gt;</em><a class="headerlink" href="#ESMF.api.constants.TypeKind.I4" title="Permalink to this definition">¶</a></dt>
<dd><p>A four byte integer, equivalent to numpy.int32.</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.TypeKind.I8">
<code class="sig-name descname">I8</code><em class="property"> = &lt;TypeKind.I8: 4&gt;</em><a class="headerlink" href="#ESMF.api.constants.TypeKind.I8" title="Permalink to this definition">¶</a></dt>
<dd><p>An eight byte integer, equivalent to numpy.int64.</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.TypeKind.R4">
<code class="sig-name descname">R4</code><em class="property"> = &lt;TypeKind.R4: 5&gt;</em><a class="headerlink" href="#ESMF.api.constants.TypeKind.R4" title="Permalink to this definition">¶</a></dt>
<dd><p>A four byte real, equivalent to numpy.float32.</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.TypeKind.R8">
<code class="sig-name descname">R8</code><em class="property"> = &lt;TypeKind.R8: 6&gt;</em><a class="headerlink" href="#ESMF.api.constants.TypeKind.R8" title="Permalink to this definition">¶</a></dt>
<dd><p>An eight byte real, equivalent to numpy.float64.</p>
</dd></dl>

</dd></dl>

</div>
<span id="document-UnmappedAction"></span><div class="section" id="unmappedaction">
<h4>UnmappedAction<a class="headerlink" href="#unmappedaction" title="Permalink to this headline">¶</a></h4>
<dl class="py class">
<dt id="ESMF.api.constants.UnmappedAction">
<em class="property">class </em><code class="sig-prename descclassname">ESMF.api.constants.</code><code class="sig-name descname">UnmappedAction</code><a class="headerlink" href="#ESMF.api.constants.UnmappedAction" title="Permalink to this definition">¶</a></dt>
<dd><p>This is used to indicate what action to take with respect to unmapped destination
points and the entries of the sparse matrix that correspond to
these points.</p>
<dl class="py attribute">
<dt id="ESMF.api.constants.UnmappedAction.ERROR">
<code class="sig-name descname">ERROR</code><em class="property"> = &lt;UnmappedAction.ERROR: 0&gt;</em><a class="headerlink" href="#ESMF.api.constants.UnmappedAction.ERROR" title="Permalink to this definition">¶</a></dt>
<dd><p>Unmapped points result in an error code return.</p>
</dd></dl>

<dl class="py attribute">
<dt id="ESMF.api.constants.UnmappedAction.IGNORE">
<code class="sig-name descname">IGNORE</code><em class="property"> = &lt;UnmappedAction.IGNORE: 1&gt;</em><a class="headerlink" href="#ESMF.api.constants.UnmappedAction.IGNORE" title="Permalink to this definition">¶</a></dt>
<dd><p>Unmapped points are ignored.</p>
</dd></dl>

</dd></dl>

</div>
</div>
</div>
<div class="section" id="references">
<h3>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h3>
<p id="bibtex-bibliography-appendix-0"><dl class="citation">
<dt class="bibtex label" id="ref-scrip"><span class="brackets">1</span></dt>
<dd><p>SCRIP: A Spherical Coordinate Remapping and Interpolation Package. http://oceans11.lanl.gov/trac/SCRIP, last accessed on Dec 4, 2015. Los Alamos Software Release LACC 98-45.</p>
</dd>
</dl>
</p>
</div>
</div>
</div>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table of Contents</a></h3>
  <ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-intro">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#important-links">Important Links</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-install">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#getting-the-code">Getting the code</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#anaconda-packages">Anaconda Packages</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#installing-esmpy-from-source">Installing ESMPy from Source</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#importing-esmpy">Importing ESMPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#validation">Validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#limitations">Limitations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-examples">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#hello-world">Hello World</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#regridding-helper-functions">Regridding Helper Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#locstream-create">LocStream Create</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#locstream-create-parallel">LocStream Create Parallel</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#create-a-2d-grid">Create a 2D Grid</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#create-a-3d-grid">Create a 3D Grid</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#create-a-periodic-grid">Create a Periodic Grid</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#create-a-5-element-mesh">Create a 5 Element Mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#create-a-field">Create a Field</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#initialize-an-analytic-field">Initialize an Analytic Field</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#run-esmpy-regridding">Run ESMPy Regridding</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#compute-field-mass">Compute Field Mass</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#regridding">Regridding</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#grid-mesh-and-field-created-from-file">Grid, Mesh and Field Created from File</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#read-and-write-a-weight-file">Read and Write a Weight File</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#grid-to-locstream">Grid to LocStream</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#mesh-to-locstream">Mesh to LocStream</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#locstream-to-grid">LocStream to Grid</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#using-mpi-spawn-from-a-serial-python-driver">Using MPI.Spawn() from a Serial Python Driver</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-api">API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#classes">Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#named-constants">Named Constants</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#manager">Manager</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#resource-allocation">Resource Allocation</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#logging">Logging</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#garbage-collection">Garbage Collection</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#spatial-discretization-objects">Spatial Discretization Objects</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#grid">Grid</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#mesh">Mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#locstream">LocStream</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#create-a-grid-or-mesh-from-file">Create a Grid or Mesh from File</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#file-formats">File Formats</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#meshes-from-file">Meshes from File</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#grids-from-file">Grids from File</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#regridding">Regridding</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#id7">Masking</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#numpy-slicing-and-indexing">Numpy Slicing and Indexing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#dimension-ordering">Dimension Ordering</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#parallel-execution">Parallel Execution</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#mpirun-vs-mpi-spawn">mpirun vs. MPI.Spawn</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-appendix">Appendices</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#class-apis">Class APIs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-manager">Manager</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-field">Field</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-grid">Grid</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-mesh">Mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-locstream">LocStream</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-regrid">Regrid</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-regridfromfile">RegridFromFile</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#named-constants">Named Constants</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-CoordSys">CoordSys</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-ExtrapMethod">ExtrapMethod</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-FileFormat">FileFormat</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-FileMode">FileMode</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-GridItem">GridItem</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-LineType">LineType</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-LogKind">LogKind</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-MeshElemType">MeshElemType</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-MeshLoc">MeshLoc</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-NormType">NormType</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-PoleKind">PoleKind</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-PoleMethod">PoleMethod</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-Region">Region</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-RegridMethod">RegridMethod</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-StaggerLoc">StaggerLoc</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-TypeKind">TypeKind</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-UnmappedAction">UnmappedAction</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#references">References</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="#">ESMPy 8.1.0 beta snapshot documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2011-2020, University Corporation for Atmospheric Research, Massachusetts Institute of Technology, Geophysical Fluid Dynamics Laboratory, University of Michigan, National Centers for Environmental Prediction, Los Alamos National Laboratory, Argonne National Laboratory, NASA Goddard Space Flight Center.  Licensed under the University of Illinois-NCSA License.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.0.3.
    </div>
  </body>
</html>