<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Installation &mdash; ESMPy 7.1.0r documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '7.1.0r',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="ESMPy 7.1.0r documentation" href="index.html" />
    <link rel="next" title="Tutorials" href="examples.html" />
    <link rel="prev" title="Overview" href="intro.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="examples.html" title="Tutorials"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="intro.html" title="Overview"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">ESMPy 7.1.0r documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="installation">
<h1>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h2>
<p>The following packages are <em>required</em> to work with ESMPy:</p>
<ul class="simple">
<li><a class="reference external" href="http://www.earthsystemmodeling.org/esmf_releases/public/ESMF_7_1_0r/ESMF_usrdoc/node9.html">ESMF installation</a></li>
<li><a class="reference external" href="http://python.org/">python</a></li>
<li><a class="reference external" href="http://www.numpy.org/">numpy</a></li>
</ul>
<p>The following packages are <em>optional</em>:</p>
<ul>
<li><dl class="first docutils">
<dt>ESMF installation with NetCDF - required to create <a class="reference internal" href="grid.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal"><span class="pre">Grids</span></code></a> and <a class="reference internal" href="mesh.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal"><span class="pre">Meshes</span></code></a> from file</dt>
<dd><ul class="first last simple">
<li>NetCDF must be built as a shared library for ESMPy installation to succeed</li>
</ul>
</dd>
</dl>
</li>
<li><p class="first"><a class="reference external" href="http://mpi4py.scipy.org/">mpi4py</a>- python bindings to MPI, needed to run some of the parallel regridding examples</p>
</li>
<li><p class="first"><a class="reference external" href="https://nose.readthedocs.org/en/latest/">nose</a> - for nose testing</p>
</li>
</ul>
</div>
<div class="section" id="getting-the-code">
<h2>Getting the code<a class="headerlink" href="#getting-the-code" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="http://www.earthsystemmodeling.org/esmf_releases/public/ESMF_7_1_0r/ESMF_usrdoc/">ESMF User&#8217;s Guide</a>
contains information on building and installing ESMF.
The <a class="reference external" href="http://www.earthsystemmodeling.org/esmf_releases/public/ESMF_7_1_0r/ESMF_refdoc/">ESMF Reference Manual</a>
contains information on the architecture of ESMF, example code, and details of the API (Application Programming
Interface).</p>
<p>Instructions on how to download the ESMPy code can be found at the <a class="reference external" href="http://www.earthsystemcog.org/projects/esmpy/releases">ESMPy Download page</a>.</p>
</div>
<div class="section" id="installing-esmpy">
<h2>Installing ESMPy<a class="headerlink" href="#installing-esmpy" title="Permalink to this headline">¶</a></h2>
<p>Installation of ESMPy requires a pointer to a file named esmf.mk inside of an
ESMF installation.  This file resides in a directory which looks like:</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">ESMF_INSTALL_DIR</span><span class="o">&gt;/</span><span class="n">lib</span><span class="o">/</span><span class="n">lib</span><span class="o">&lt;</span><span class="n">g</span><span class="o">&lt;</span><span class="ow">or</span><span class="o">&gt;</span><span class="n">O</span><span class="o">&gt;/&lt;</span><span class="n">platform</span><span class="o">&gt;/</span><span class="n">esmf</span><span class="o">.</span><span class="n">mk</span>
</pre></div>
</div>
<p>If the <code class="docutils literal"><span class="pre">ESMFMKFILE</span></code> flag is set when building ESMPy then it will not need to be
referenced again.  If not, an environment variable of the same name must be set
with the path to the esmf.mk file <em>every</em> time that a new shell is initiated.</p>
<p>The ESMPy build can be installed in a custom location using the
<code class="docutils literal"><span class="pre">--prefix</span></code>, <code class="docutils literal"><span class="pre">--home</span></code>, or <code class="docutils literal"><span class="pre">--install-base</span></code> flags to the install command.  If this
is done, then this location needs to be added to the <code class="docutils literal"><span class="pre">PYTHONPATH</span></code> environment
variable in the user&#8217;s shell <em>every</em> time that a new shell is initiated.  If a
customized install location is not specified, ESMPy will be installed in the
standard Python package installation directory on that particular machine.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The ESMPy build does not have to be installed to be used.  The
<code class="docutils literal"><span class="pre">PYTHONPATH</span></code> environment variable can simply be pointed to the directory
containing the ESMF module (esmf/src/addon/ESMPy/src from a default git clone)
after the build command.</p>
</div>
<p>As usual, any command followed by <code class="docutils literal"><span class="pre">--help</span></code> should print out some information
on what options are available.</p>
<p>An installation of ESMPy in the default location for Python packages can be done
with the following command issued from the top level ESMPy directory:</p>
<ul class="simple">
<li>default Python package installation:</li>
</ul>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">build</span> <span class="o">--</span><span class="n">ESMFMKFILE</span><span class="o">=&lt;</span><span class="n">DIR_TO_esmf</span><span class="o">.</span><span class="n">mk</span><span class="o">&gt;</span> <span class="n">install</span>
</pre></div>
</div>
<ul class="simple">
<li>custom install location:</li>
</ul>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">build</span> <span class="o">--</span><span class="n">ESMFMKFILE</span><span class="o">=&lt;</span><span class="n">DIR_TO_esmf</span><span class="o">.</span><span class="n">mk</span><span class="o">&gt;</span>

<span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">install</span> <span class="o">--</span><span class="n">prefix</span><span class="o">=&lt;</span><span class="n">custom_install_location</span><span class="o">&gt;</span>

<span class="n">setenv</span> <span class="n">PYTHONPATH</span> <span class="o">&lt;</span><span class="n">custom_install_location</span><span class="o">&gt;/</span><span class="n">lib</span><span class="o">/</span>\<span class="o">*/</span><span class="n">site_packages</span>
</pre></div>
</div>
<p>Please contact <a class="reference external" href="mailto:esmf_support&#37;&#52;&#48;list&#46;woc&#46;noaa&#46;gov">esmf_support<span>&#64;</span>list<span>&#46;</span>woc<span>&#46;</span>noaa<span>&#46;</span>gov</a> with any questions or problems.</p>
<div class="section" id="anaconda-packages">
<h3>Anaconda Packages<a class="headerlink" href="#anaconda-packages" title="Permalink to this headline">¶</a></h3>
<p>ESMPy conda packages are available through the NESII channel:</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">install</span> <span class="o">-</span><span class="n">c</span> <span class="n">nesii</span> <span class="n">esmpy</span>
</pre></div>
</div>
<p>There are Python3 compatible development versions available through the
conda-forge channel:</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">install</span> <span class="o">-</span><span class="n">c</span> <span class="n">nesii</span><span class="o">/</span><span class="n">label</span><span class="o">/</span><span class="n">dev</span><span class="o">-</span><span class="n">esmf</span> <span class="o">-</span><span class="n">c</span> <span class="n">conda</span><span class="o">-</span><span class="n">forge</span> <span class="n">esmpy</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="importing-esmpy">
<h2>Importing ESMPy<a class="headerlink" href="#importing-esmpy" title="Permalink to this headline">¶</a></h2>
<p>To use ESMPy in an external program, import it with:</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ESMF</span>
</pre></div>
</div>
</div>
<div class="section" id="validation">
<h2>Validation<a class="headerlink" href="#validation" title="Permalink to this headline">¶</a></h2>
<p>The ESMPy testing is done with the nose package, both in serial and
parallel.  The nose commands are wrapped in the following ESMPy targets:</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">test</span>

<span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">test_examples</span>

<span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">test_regrid_from_file</span>

<span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">test_parallel</span>

<span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">test_examples_parallel</span>

<span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">test_regrid_from_file_parallel</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <code class="docutils literal"><span class="pre">regrid_from_file</span></code> tests can take up a lot of memory and bandwidth.
The <code class="docutils literal"><span class="pre">test_regrid_from_file_dryrun</span></code> command will simply download the test
files without actually running them (allowing the stress on the machine to
be applied to bandwidth first, and then memory).</p>
</div>
<p>Alternatively, individual tests can be run with nose using the following format:</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">nosetests</span> <span class="o">&lt;</span><span class="n">file</span><span class="o">&gt;</span><span class="p">:</span><span class="o">&lt;</span><span class="n">test</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>e.g.</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">nosetests</span> <span class="n">src</span><span class="o">/</span><span class="n">ESMF</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">test_api</span><span class="o">/</span><span class="n">test_regrid</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="n">TestRegrid</span><span class="o">.</span><span class="n">test_field_regrid</span>
</pre></div>
</div>
</div>
<div class="section" id="limitations">
<h2>Limitations<a class="headerlink" href="#limitations" title="Permalink to this headline">¶</a></h2>
<p>ESMPy doesn&#8217;t include many aspects of ESMF, including components, field bundles,
time management, etc.  The limitations listed here are relative
to ESMF offline and integrated regridding capabilities.</p>
<ul class="simple">
<li>ESMPy cannot use an ESMF installation that is built with external LAPACK
support.</li>
<li>Coordinates cannot be retrieved from the elements of a
<a class="reference internal" href="mesh.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal"><span class="pre">Mesh</span></code></a>. This can affect the ability to set
<a class="reference internal" href="field.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal"><span class="pre">Field</span></code></a> values on a source <a class="reference internal" href="mesh.html#ESMF.api.mesh.Mesh" title="ESMF.api.mesh.Mesh"><code class="xref py py-class docutils literal"><span class="pre">Mesh</span></code></a>
created from file when using conservative regridding.</li>
<li>Multi-tile <a class="reference internal" href="grid.html#ESMF.api.grid.Grid" title="ESMF.api.grid.Grid"><code class="xref py py-class docutils literal"><span class="pre">Grid</span></code></a> support is limited to cubed-sphere
grids created on 6 processors. A cubed-sphere grid can be created on any
number of processors, but only when it is created on 6 processors will the
coordinates be retrievable for the entire object.</li>
<li>There is no <code class="docutils literal"><span class="pre">FieldBundle</span></code> class, only single <a class="reference internal" href="field.html#ESMF.api.field.Field" title="ESMF.api.field.Field"><code class="xref py py-class docutils literal"><span class="pre">Fields</span></code></a>.</li>
</ul>
<p>Testing related:</p>
<ul class="simple">
<li>Nightly regression testing is limited to a small subset of the ESMF test platforms,
including Darwin and Linux running gfortran with openMPI.</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Installation</a><ul>
<li><a class="reference internal" href="#requirements">Requirements</a></li>
<li><a class="reference internal" href="#getting-the-code">Getting the code</a></li>
<li><a class="reference internal" href="#installing-esmpy">Installing ESMPy</a><ul>
<li><a class="reference internal" href="#anaconda-packages">Anaconda Packages</a></li>
</ul>
</li>
<li><a class="reference internal" href="#importing-esmpy">Importing ESMPy</a></li>
<li><a class="reference internal" href="#validation">Validation</a></li>
<li><a class="reference internal" href="#limitations">Limitations</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="intro.html"
                        title="previous chapter">Overview</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="examples.html"
                        title="next chapter">Tutorials</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/install.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="examples.html" title="Tutorials"
             >next</a> |</li>
        <li class="right" >
          <a href="intro.html" title="Overview"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">ESMPy 7.1.0r documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2011-2016, University Corporation for Atmospheric Research, Massachusetts Institute of Technology, Geophysical Fluid Dynamics Laboratory, University of Michigan, National Centers for Environmental Prediction, Los Alamos National Laboratory, Argonne National Laboratory, NASA Goddard Space Flight Center.  Licensed under the University of Illinois-NCSA License.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.5.
    </div>
  </body>
</html>